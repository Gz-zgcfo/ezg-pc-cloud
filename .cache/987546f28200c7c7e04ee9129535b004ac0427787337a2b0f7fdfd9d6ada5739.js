{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{474:function(e,t,a){\"use strict\";a.r(t);var s={name:\"serviceTemplate_index\",data:function(){var e=this;return{search_model:\"\",serviceitemname:\"\",isCheek:!0,typename:\"\",loading:!0,serviceitemid:\"\",currentPage:1,page:1,pageSize:10,page2:1,pageSize2:10,pageTotal:\"\",pageTotal2:\"\",add:!1,xuanz:!1,title:\"\",task_message:{id:\"\",serviceContractItemId:\"\",remark:\"\",workreport:\"\"},ruleValidate:{serviceContractItemId:[{required:!0,message:\"请选择服务项\"}],workreport:[{required:!0,message:\"请选择工作汇报\"}]},data:[],data2:[],header:[{title:\"服务项\",key:\"serviceitemname\",width:250},{title:\"工作汇报\",key:\"workreport\",ellipsis:!0,width:300},{title:\"创建人\",key:\"createbyrealname\",width:120},{title:\"创建时间\",key:\"createdate\",width:120},{title:\"修改人\",key:\"updatebyrealname\",width:120},{title:\"修改时间\",key:\"updatedate\",width:120},{title:\"操作\",key:\"action\",fixed:\"right\",width:100,align:\"center\",render:function(t,a){return t(\"div\",[t(\"Button\",{props:{type:\"text\",size:\"small\"},on:{click:function(){e.delete(a.row.id)}}},\"[删除]\")])}}],header2:[{title:\"服务项名称\",key:\"serviceitemname\"},{title:\"创建人\",key:\"updateby\"},{title:\"创建时间\",key:\"updatedate\"}]}},methods:{show:function(e){\"Enter\"==e.key&&this.search()},search:function(){this.getData()},reset:function(){this.serviceitemname=\"\",this.getData()},getData:function(){var e=this,t=\"/order/cycle/service/kjdj/summary/template/list?page=\"+e.page+\"&pageSize=\"+e.pageSize+\"&serviceitemname=\"+e.serviceitemname;this.GetData(t,function(t){var a=t.data.data;e.pageTotal=a.total,e.data=[];for(var s=0;s<a.rows.length;s++)e.data.push({id:a.rows[s].id,createbyrealname:a.rows[s].createbyrealname,updatebyrealname:a.rows[s].updatebyrealname,createdate:null!=a.rows[s].createdate?a.rows[s].createdate.substr(0,10):\"\",serviceitemname:a.rows[s].serviceitemname,updatedate:null!=a.rows[s].updatedate?a.rows[s].updatedate.substr(0,10):\"\",workreport:a.rows[s].workreport})})},getData2:function(){var e=this,t=\"/system/serviceContract/item/list?page=\"+e.page2+\"&pageSize=\"+e.pageSize2+\"&templatecode=kjdafwxy\";this.GetData(t,function(t){var a=t.data.data;e.pageTotal2=a.total,e.data2=[];for(var s=0;s<a.rows.length;s++)e.data2.push({updateby:a.rows[s].updateby,id:a.rows[s].id,updatedate:a.rows[s].updatedate,serviceitemname:a.rows[s].serviceitemname})})},pageChange:function(e){this.page=e,this.getData()},pageChange2:function(e){this.page2=e,this.getData2()},pageSizeChange:function(e){this.pageSize=e,this.getData()},pageSizeChange2:function(e){this.pageSize2=e,this.getData2()},luru:function(){this.add=!0,this.title=\"录入\",this.typename=\"add\"},bianji:function(){var e=this,t=\"/order/cycle/service/kjdj/summary/template/detail?id=\"+e.serviceitemid;if(\"\"==e.serviceitemid)this.$Message.warning(\"请选择查看的模板\");else{e.add=!0,e.title=\"编辑\",e.typename=\"edit\",e.GetData(t,function(t){var a=t.data.data;e.task_message.remark=a.remark,e.task_message.id=a.serviceContractItemId,e.task_message.workreport=a.workreport}),e.GetData(\"/system/serviceContract/item/list?page=1&pageSize=10000&templatecode=kjdafwxy\",function(t){for(var a=t.data.data.rows,s=0;s<a.length;s++)e.task_message.id==a[s].id&&(e.task_message.serviceContractItemId=a[s].serviceitemname)})}},chakan:function(){var e=this,t=\"/order/cycle/service/kjdj/summary/template/detail?id=\"+e.serviceitemid;if(e.isCheek=!1,\"\"==e.serviceitemid)this.$Message.warning(\"请选择查看的模板\");else{e.add=!0,e.title=\"查看\",e.typename=\"check\",e.GetData(t,function(t){var a=t.data.data;e.task_message.remark=a.remark,e.task_message.id=a.serviceContractItemId,e.task_message.workreport=a.workreport}),e.GetData(\"/system/serviceContract/item/list?page=1&pageSize=10000&templatecode=kjdafwxy\",function(t){for(var a=t.data.data.rows,s=0;s<a.length;s++)e.task_message.id==a[s].id&&(e.task_message.serviceContractItemId=a[s].serviceitemname)})}},cancel:function(e){this.add=!1,this.isCheek=!0,this.$refs[e].resetFields()},selectRow:function(e){this.serviceitemid=e.id},selectRow2:function(e){this.task_message.id=e.id,this.task_message.serviceContractItemId=e.serviceitemname,this.xuanz=!1},submit:function(e){var t=this,a=this;setTimeout(function(){t.loading=!1,t.$refs[e].validate(function(e){if(e){var s=\"\",i=\"\",r={workreport:a.task_message.workreport,servicecontractitemid:a.task_message.id,remark:a.task_message.remark};\"add\"==a.typename?(s=\"/order/cycle/service/kjdj/summary/template/create\",i=\"录入成功\"):\"edit\"==a.typename&&(s=\"/order/cycle/service/kjdj/summary/template/update\",i=\"编辑成功\",r.id=a.serviceitemid),a.PostData(s,r,function(e){a.cancel(\"task_message\"),a.$Message.success(i),a.currentPage=1,a.page=1,a.getData()},function(e){a.$nextTick(function(){a.loading=!0}),a.$Message.error(e.data.msg)})}else t.$nextTick(function(){t.loading=!0})})},2e3)},delete:function(e){var t=this;this.$Modal.confirm({title:\"删除确认\",content:\"<p>确认删除该记录吗</p>\",onOk:function(){var a={id:e};t.PostData(\"/order/cycle/service/kjdj/summary/template/del\",a,function(){t.currentPage=1,t.page=1,t.getData()})}})}},mounted:function(){this.getData()}},i=a(2),r=Object(i.a)(s,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"20px\"}},[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:e.show},slot:\"content\"},[a(\"Form\",{ref:\"formInline\",attrs:{model:e.formInline,\"label-width\":100}},[a(\"Row\",{attrs:{gutter:12}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"serviceitemname\",label:\"服务项名称：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:e.serviceitemname,callback:function(t){e.serviceitemname=t},expression:\"serviceitemname\"}})],1)],1)],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:e.reset}},[e._v(\"重置\")])],1)],1)],1)],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.luru}},[e._v(\"录入\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.bianji}},[e._v(\"编辑\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.chakan}},[e._v(\"查看\")])],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",columns:e.header,data:e.data},on:{\"on-row-click\":e.selectRow}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotal,current:e.currentPage,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(t){e.currentPage=t},\"on-change\":e.pageChange,\"on-page-size-change\":e.pageSizeChange}})],1)],1),e._v(\" \"),a(\"Modal\",{attrs:{title:e.title,loading:e.loading,width:\"800\"},on:{\"on-ok\":function(t){e.submit(\"task_message\")},\"on-cancel\":function(t){e.cancel(\"task_message\")}},model:{value:e.add,callback:function(t){e.add=t},expression:\"add\"}},[a(\"Form\",{ref:\"task_message\",attrs:{rules:e.ruleValidate,model:e.task_message,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"FormItem\",{attrs:{prop:\"serviceContractItemId\",label:\"服务项：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\",disabled:!e.isCheek},model:{value:e.task_message.serviceContractItemId,callback:function(t){e.$set(e.task_message,\"serviceContractItemId\",t)},expression:\"task_message.serviceContractItemId\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"2\"}},[a(\"Button\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isCheek,expression:\"isCheek\"}],attrs:{type:\"primary\"},on:{click:function(t){e.getData2(),e.xuanz=!0}}},[e._v(\"选择\")])],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:24}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{prop:\"workreport\",label:\"工作汇报：\"}},[a(\"Input\",{attrs:{type:\"textarea\",rows:4,disabled:!e.isCheek},model:{value:e.task_message.workreport,callback:function(t){e.$set(e.task_message,\"workreport\",t)},expression:\"task_message.workreport\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:24}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{prop:\"remark\",label:\"备注：\"}},[a(\"Input\",{attrs:{type:\"textarea\",rows:4,disabled:!e.isCheek},model:{value:e.task_message.remark,callback:function(t){e.$set(e.task_message,\"remark\",t)},expression:\"task_message.remark\"}})],1)],1)],1)],1),e._v(\" \"),e.isCheek?e._e():a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1),e._v(\" \"),a(\"Modal\",{attrs:{title:\"服务项列表\",width:\"800\"},model:{value:e.xuanz,callback:function(t){e.xuanz=t},expression:\"xuanz\"}},[a(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",columns:e.header2,data:e.data2},on:{\"on-row-dblclick\":e.selectRow2}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotal2,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":e.pageChange2,\"on-page-size-change\":e.pageSizeChange2}})],1)],1)},[],!1,null,null,null);r.options.__file=\"serviceTemplate.vue\";t.default=r.exports}}]);"}