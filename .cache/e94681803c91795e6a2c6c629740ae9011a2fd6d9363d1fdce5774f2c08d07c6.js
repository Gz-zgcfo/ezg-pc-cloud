{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{861:function(e,a,t){\"use strict\";t.r(a);var n={name:\"channelType_index\",data:function(){var t=this;return{searchLabel:\"\",isSearch:!1,UsersearchformInline:{realname:\"\",mobilephone:\"\"},user_search:!1,loading:!0,isAdd:!1,isQd:!1,isEdit:!1,addType:!1,addCannelUser:!1,page:1,pageSize:10,pageTotal:new Number,pageq:1,pageSizeq:10,pageTotalq:new Number,pagea:1,pageSizea:10,pageTotala:new Number,pagex:1,pageSizex:10,pageTotalx:new Number,title:\"\",channelId:\"\",channelName:\"\",channelCode:\"\",qudao:\"\",single:!1,data:[],data2:[],data3:[],data4:[],formValidate:{channelTypeName:\"\",channelTypeCode:\"\"},ruleValidate:{channelTypeName:[{required:!0,message:\"请填写渠道名称\",trigger:\"blur\"}],channelTypeCode:[{required:!0,message:\"请填写渠道编码\",trigger:\"blur\"}]},columns:[{title:\"渠道编码\",key:\"channel_type_code\",width:160},{title:\"渠道名称\",key:\"channel_type_name\",width:160},{title:\"操作\",key:\"action\",fixed:\"right\",width:70,align:\"center\",render:function(e,a){return e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){t.getUser(a.row.id)}}},\"用户\")])}}],columns2:[{title:\"用户id\",key:\"user_id\",width:160},{title:\"真实姓名\",key:\"userRealName\",width:160},{title:\"操作\",key:\"action\",fixed:\"right\",width:70,align:\"center\",render:function(e,a){return e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){t.deleteUser(a)}}},\"删除\")])}}],columns3:[{title:\"用户名\",key:\"username\"},{title:\"真实姓名\",key:\"realname\"},{title:\"电话\",key:\"mobilephone\"}],columns4:[{title:\"用户id\",key:\"user_id\"},{title:\"真实姓名\",key:\"userRealName\"},{title:\"操作\",key:\"action\",fixed:\"right\",width:70,align:\"center\",render:function(e,a){return e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){t.deleteUser(a)}}},\"删除\")])}}],searchformInline:{channelTypeName:\"\"}}},methods:{searchLabelData:function(){\"\"==this.searchLabel?this.isSearch=!1:this.isSearch=!0,this.getTableData()},search_channel:function(){this.page=1,this.getTableData()},reset_channel:function(){this.searchformInline.channelTypeName=\"\",this.page=1,this.getTableData()},getTableData:function(){var n=this;if(\"\"==n.searchLabel)var e=\"/channel/type/list?page=\"+n.page+\"&pageSize=\"+n.pageSize;else e=\"/channel/type/list?page=\"+n.page+\"&pageSize=\"+n.pageSize+\"&channelTypeName=\"+n.searchLabel;this.GetData(e,function(e){var a=e.data.data;n.pageTotal=a.total,n.data=[];for(var t=0;t<a.rows.length;t++)n.data.push({id:a.rows[t].id,channel_type_code:a.rows[t].channel_type_code,channel_type_name:a.rows[t].channel_type_name})})},postAdd:function(e){var t=this,n=this;setTimeout(function(){n.loading=!1,n.$refs[e].validate(function(e){if(e){var a=void 0;1==n.isAdd?a=\"/channel/type/create\":1==n.isEdit&&(a=\"/channel/type/update\",n.formValidate.id=n.channelId),t.PostData(a,n.formValidate,function(e){n.loading=!0,n.$Message.success(\"提交成功\"),n.addType=!1,n.channelId=\"\",n.cancel(\"formValidate\"),n.getTableData()},function(e){n.$nextTick(function(){n.loading=!0}),n.$Message.error(\"提交失败!\")})}})},2e3)},cancel:function(e){this.isAdd=!1,this.isEdit=!1,this.$refs[e].resetFields()},selectRow:function(e){this.channelId=e.id,this.channelName=e.channel_type_name,this.channelCode=e.channel_type_code},addT:function(){this.title=\"新增\",this.isAdd=!0,this.addType=!0},TypeEdit:function(){var e=this;\"\"==e.channelId?e.$Message.warning(\"请选择要编辑的渠道类型\"):(e.title=\"编辑\",e.isEdit=!0,e.formValidate.channelTypeCode=e.channelCode,e.formValidate.channelTypeName=e.channelName,e.addType=!0)},deleteType:function(){var a=this,t=this;\"\"==t.channelId?t.$Message.warning(\"请选择要删除的渠道类型\"):t.$Modal.confirm({title:\"删除\",content:\"<p>是否删除该渠道类型</p>\",onOk:function(){var e={id:t.channelId};a.PostData(\"/channel/type/del\",e,function(){t.getTableData(),t.$Message.success(\"删除成功\")})}})},pageChange:function(e){this.page=e,this.getTableData()},pageSizeChange:function(e){this.pageSize=e,this.getTableData()},getUser:function(e){var n=this,a=\"/channel/user/list?page=\"+n.pageq+\"&pageSize=\"+n.pageSizeq+\"&channelTypeId=\"+e+\"&type=qdyh\",t=\"/channel/user/list?page=\"+n.pageq+\"&pageSize=\"+n.pageSizeq+\"&channelTypeId=\"+e+\"&type=xs\";this.GetData(a,function(e){var a=e.data.data;n.data2=[],n.pageTotalq=a.total;for(var t=0;t<a.rows.length;t++)n.data2.push({id:a.rows[t].id,channel_type_id:a.rows[t].channel_type_id,user_id:a.rows[t].user_id,userRealName:a.rows[t].userRealName})}),this.GetData(t,function(e){var a=e.data.data;n.data4=[],n.pageTotalx=a.total;for(var t=0;t<a.rows.length;t++)n.data4.push({id:a.rows[t].id,channel_type_id:a.rows[t].channel_type_id,user_id:a.rows[t].user_id,userRealName:a.rows[t].userRealName})})},pageChangeq:function(e){this.pageq=e,this.getUser(this.channelId)},pageSizeChangeq:function(e){this.pageSizeq=e,this.getUser(this.channelId)},pageChangex:function(e){this.pagex=e,this.getUser(this.channelId)},pageSizeChangex:function(e){this.pageSizex=e,this.getUser(this.channelId)},addq:function(e){this.qudao=e,\"qd\"==this.qudao?this.isQd=!0:this.isQd=!1,this.getuserlist()},usersearch:function(){0==this.user_search&&(this.pagea=1),this.user_search=!0,this.getuserlist()},userreset:function(){var e=this;e.UsersearchformInline.realname=\"\",e.UsersearchformInline.mobilephone=\"\",e.pagea=1,e.getuserlist(),e.user_search=!1},clean:function(){this.UsersearchformInline.realname=\"\",this.UsersearchformInline.mobilephone=\"\"},pageChangea:function(e){this.pagea=e,this.addq(this.qudao)},pageSizeChangea:function(e){this.pageSizea=e,this.addq(this.qudao)},getuserlist:function(){var n=this,e={params:{rolecode:1==n.isQd?\"jianzhi\":\"salers\",page:n.pagea,pageSize:n.pageSizea,realname:n.UsersearchformInline.realname,mobilephone:n.UsersearchformInline.mobilephone}};for(var a in n.UsersearchformInline)\"\"!=n.UsersearchformInline[a]&&null!=n.UsersearchformInline[a]||delete e.params[a];this.$http.get(\"api/user/list\",e).then(function(e){!function(e){var a=e.data.data;n.addCannelUser=!0,n.pageTotala=a.total,n.data3=[];for(var t=0;t<a.rows.length;t++)n.data3.push({id:a.rows[t].id,mobilephone:a.rows[t].mobilephone,realname:a.rows[t].realname,username:a.rows[t].username})}(e)})},deleteUser:function(e){var a=this,t={id:e.row.id};this.PostData(\"/channel/user/del\",t,function(){a.pageq=1,a.getUser(e.row.channel_type_id),a.$Message.success(\"删除成功\")})},addUserClick:function(e){var a=this,t=\"/channel/user/create\",n={},i={};if(1==a.isQd)n={channelTypeId:a.channelId,userId:e.id,type:\"qdyh\"};else{var s=void 0;s=1==a.single?\"Y\":\"N\",i={channelTypeId:a.channelId,userId:e.id,type:\"xs\",manager:s}}function l(e){a.getUser(a.channelId),a.addCannelUser=!1,a.single=!1,a.$Message.success(\"添加成功\")}function r(e){a.$Message.warning(e.data.msg),a.single=!1}1==a.isQd?this.PostData(t,n,l,r):this.PostData(t,i,l,r)}},mounted:function(){this.getTableData()}},i=t(4),s=Object(i.a)(n,function(){var a=this,e=a.$createElement,t=a._self._c||e;return t(\"div\",[t(\"Row\",[t(\"Col\",{attrs:{span:\"11\"}},[t(\"Card\",[t(\"Row\",[t(\"ButtonGroup\",[t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.add\"],expression:\"['channelT.add']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:a.addT}},[a._v(\"新增\")]),a._v(\" \"),t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.edit\"],expression:\"['channelT.edit']\"}],attrs:{type:\"primary\",icon:\"edit\"},on:{click:a.TypeEdit}},[a._v(\"编辑\")]),a._v(\" \"),t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.delete\"],expression:\"['channelT.delete']\"}],attrs:{type:\"primary\",icon:\"edit\"},on:{click:a.deleteType}},[a._v(\"删除\")])],1),a._v(\" \"),t(\"Col\",{staticStyle:{float:\"right\"},attrs:{span:\"6\"}},[t(\"Input\",{attrs:{placeholder:\"输入标签名称搜索\"},on:{\"on-keydown\":function(e){return\"button\"in e||!a._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?a.searchLabelData(e):null}},model:{value:a.searchLabel,callback:function(e){a.searchLabel=e},expression:\"searchLabel\"}},[t(\"Button\",{attrs:{slot:\"append\",icon:\"ios-search\"},on:{click:a.searchLabelData},slot:\"append\"})],1)],1)],1),a._v(\" \"),t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:a.columns,data:a.data},on:{\"on-current-change\":a.selectRow,\"on-row-dblclick\":a.TypeEdit}}),a._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:a.pageTotal,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":a.pageChange,\"on-page-size-change\":a.pageSizeChange}})],1)],1)],1),a._v(\" \"),\"\"!=a.channelId?t(\"Col\",{attrs:{span:\"11\"}},[t(\"Card\",[t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Tabs\",{attrs:{value:\"name1\"}},[t(\"TabPane\",{attrs:{label:\"渠道用户\",name:\"name1\"}},[t(\"Row\",[t(\"ButtonGroup\",[t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.cannel.add\"],expression:\"['channelT.cannel.add']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:function(e){a.addq(\"qd\")}}},[a._v(\"新增\")])],1)],1),a._v(\" \"),t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",border:\"\",columns:a.columns2,data:a.data2,size:\"small\"}}),a._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:a.pageTotalq,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":a.pageChangeq,\"on-page-size-change\":a.pageSizeChangeq}})],1)],1),a._v(\" \"),t(\"TabPane\",{attrs:{label:\"销售\",name:\"name2\"}},[t(\"Row\",[t(\"ButtonGroup\",[t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.sales.add\"],expression:\"['channelT.sales.add']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:function(e){a.addq(\"xs\")}}},[a._v(\"新增\")])],1)],1),a._v(\" \"),t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",border:\"\",columns:a.columns4,data:a.data4,size:\"small\"}}),a._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:a.pageTotalx,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":a.pageChangex,\"on-page-size-change\":a.pageSizeChangex}})],1)],1)],1)],1)],1)],1):a._e()],1),a._v(\" \"),t(\"Modal\",{attrs:{title:a.title,loading:a.loading,width:\"40%\"},on:{\"on-ok\":function(e){a.postAdd(\"formValidate\")},\"on-cancel\":function(e){a.cancel(\"formValidate\")}},model:{value:a.addType,callback:function(e){a.addType=e},expression:\"addType\"}},[t(\"Form\",{ref:\"formValidate\",attrs:{rules:a.ruleValidate,model:a.formValidate,\"label-width\":90}},[t(\"FormItem\",{attrs:{label:\"渠道名称\",prop:\"channelTypeName\"}},[t(\"Input\",{attrs:{size:\"small\"},model:{value:a.formValidate.channelTypeName,callback:function(e){a.$set(a.formValidate,\"channelTypeName\",e)},expression:\"formValidate.channelTypeName\"}})],1),a._v(\" \"),t(\"FormItem\",{attrs:{label:\"渠道编码\",prop:\"channelTypeCode\"}},[t(\"Input\",{attrs:{size:\"small\"},model:{value:a.formValidate.channelTypeCode,callback:function(e){a.$set(a.formValidate,\"channelTypeCode\",e)},expression:\"formValidate.channelTypeCode\"}})],1)],1)],1),a._v(\" \"),t(\"Modal\",{attrs:{title:\"新增\",width:\"40%\"},on:{\"on-cancel\":a.clean},model:{value:a.addCannelUser,callback:function(e){a.addCannelUser=e},expression:\"addCannelUser\"}},[t(\"Row\",[t(\"Col\",{attrs:{span:\"12\"}},[a.isQd?a._e():t(\"Checkbox\",{model:{value:a.single,callback:function(e){a.single=e},expression:\"single\"}},[t(\"Icon\",{attrs:{type:\"information-circled\"}}),a._v(\" \"),t(\"span\",[a._v(\"是否设置该销售为主要负责人\")])],1),a._v(\" \"),t(\"div\",{staticStyle:{visibility:\"hidden\"}},[a._v(\"..\")])],1),a._v(\" \"),t(\"Col\",{attrs:{span:\"12\"}},[t(\"Poptip\",{staticStyle:{float:\"right\"},attrs:{trigger:\"click\",title:\"筛选\",placement:\"bottom-end\"}},[t(\"Button\",{attrs:{type:\"text\",icon:\"funnel\"}},[a._v(\"筛选\")]),a._v(\" \"),t(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(e){return\"button\"in e||!a._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?a.usersearch(e):null}},slot:\"content\"},[t(\"Form\",{ref:\"UsersearchformInline\",attrs:{model:a.UsersearchformInline,\"label-width\":60}},[t(\"Row\",[t(\"FormItem\",{attrs:{prop:\"realname\",label:\"真实姓名：\"}},[t(\"Input\",{staticStyle:{width:\"180px\"},attrs:{type:\"text\",placeholder:\"\"},model:{value:a.UsersearchformInline.realname,callback:function(e){a.$set(a.UsersearchformInline,\"realname\",e)},expression:\"UsersearchformInline.realname\"}})],1)],1),a._v(\" \"),t(\"Row\",[t(\"FormItem\",{attrs:{prop:\"mobilephone\",label:\"电话：\"}},[t(\"Input\",{staticStyle:{width:\"180px\"},attrs:{type:\"text\",placeholder:\"\"},model:{value:a.UsersearchformInline.mobilephone,callback:function(e){a.$set(a.UsersearchformInline,\"mobilephone\",e)},expression:\"UsersearchformInline.mobilephone\"}})],1)],1),a._v(\" \"),t(\"FormItem\",[t(\"Button\",{attrs:{type:\"primary\"},on:{click:a.usersearch}},[a._v(\"搜索\")]),a._v(\" \"),t(\"Button\",{staticStyle:{\"margin-left\":\"20px\",\"margin-bottom\":\"0\"},attrs:{type:\"ghost\"},on:{click:a.userreset}},[a._v(\"重置\")])],1)],1)],1)],1)],1)],1),a._v(\" \"),t(\"Table\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"highlight-row\":\"\",columns:a.columns3,data:a.data3,size:\"small\"},on:{\"on-row-dblclick\":a.addUserClick}}),a._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:a.pageTotala,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\",current:a.pagea},on:{\"on-change\":a.pageChangea,\"on-page-size-change\":a.pageSizeChangea,\"update:current\":function(e){a.pagea=e}}}),a._v(\" \"),t(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);s.options.__file=\"channelType_index.vue\";a.default=s.exports}}]);"}