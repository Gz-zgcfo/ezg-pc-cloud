{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{466:function(t,e,a){\"use strict\";a.r(e);var n={name:\"customerLog_index\",data:function(){return{search_model:\"\",customerDynamicType:[],customerDynamicType_Map:new Map,formValidate:{realname:\"\",type:\"\",name:\"\",tel:\"\",companyname:\"\"},loading:!1,page:1,pageSize:10,columns:[{title:\"客户名称\",key:\"name\",minWidth:120},{title:\"公司名称\",key:\"companyname\",minWidth:180},{title:\"联系方式\",key:\"tel\",minWidth:120},{title:\"类型\",key:\"typename\",align:\"center\",minWidth:200},{title:\"动态\",key:\"content\",minWidth:360,render:function(t,e){return\"\"==e.row.content||null==e.row.content?\"\":e.row.content.length>25?t(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[t(\"span\",e.row.content.slice(0,25)+\"...\"),t(\"Icon\",{props:{type:\"arrow-down-b\"}}),t(\"div\",{slot:\"content\",style:{width:\"200px\",whiteSpace:\"normal\"}},[t(\"span\",e.row.content)])]):t(\"span\",e.row.content)}},{title:\"变更时间\",key:\"createdate\",minWidth:150},{title:\"操作人\",key:\"realname\",minWidth:150}],data:[],pageTotal:new Number}},methods:{Search:function(){this.page=1,this.get_data()},handleReset:function(){this.$refs.formValidate.resetFields(),this.get_data()},pageChange:function(t){this.page=t,this.get_data()},pageSizeChange:function(t){this.pageSize=t,this.get_data()},get_data:function(){var t=this;t.loading=!0;\"all\"==t.formValidate.type&&(t.formValidate.type=\"\");var e={params:{page:t.page,pageSize:t.pageSize,realname:t.formValidate.realname,type:t.formValidate.type,name:t.formValidate.name,tel:t.formValidate.tel,companyname:t.formValidate.companyname,sortField:\"createdate\"}};this.$Get(\"api/customer/dynamic/record/list\",e,function(e){t.loading=!1,t.data=e.data.data.rows,t.pageTotal=e.data.data.total;for(var a=0;a<t.data.length;a++)t.data[a].type&&(t.data[a].typename=t.find_customer_dynamic_type(t.data[a].type))})},find_customer_dynamic_type:function(t){for(var e=t.split(\"-\"),a=0;a<this.customerDynamicType.length;a++)if(this.customerDynamicType[a].typecode==e[0]&&e.length>1)for(var n=0;n<this.customerDynamicType[a].children.length;n++)if(this.customerDynamicType[a].children[n].typecode==e[1])return this.customerDynamicType[a].typename+\" - \"+this.customerDynamicType[a].children[n].typename},get_data_center:function(){var t=this;return new Promise(function(e,a){var n=t;t.$GetDataCenter(\"customer_dynamic_type\",function(t){n.customerDynamicType=t.data.data.customer_dynamic_type,e()})})}},created:function(){var t=this;this.get_data_center().then(function(){return t.get_data()})}},i=a(2),o=Object(i.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"Card\",{staticStyle:{\"min-width\":\"800px\"}},[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:t.search_model,callback:function(e){t.search_model=e},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),t._v(\"\\n                    筛选\\n                    \\n                        \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.Search(e):null}},slot:\"content\"},[a(\"Form\",{ref:\"formValidate\",staticStyle:{\"margin-top\":\"15px\"},attrs:{model:t.formValidate,\"label-width\":120}},[a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"客户名称：\",prop:\"name\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,\"name\",e)},expression:\"formValidate.name\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"电话：\",prop:\"tel\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:t.formValidate.tel,callback:function(e){t.$set(t.formValidate,\"tel\",e)},expression:\"formValidate.tel\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"公司名称：\",prop:\"companyname\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:t.formValidate.companyname,callback:function(e){t.$set(t.formValidate,\"companyname\",e)},expression:\"formValidate.companyname\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"类型：\",prop:\"type\"}},[a(\"Select\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",size:\"small\"},on:{\"on-change\":t.Search},model:{value:t.formValidate.type,callback:function(e){t.$set(t.formValidate,\"type\",e)},expression:\"formValidate.type\"}},t._l(t.customerDynamicType,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(\"\\n                                                \"+t._s(e.typename)+\"\\n                                            \")])}),1)],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"跟进人：\",prop:\"realname\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:t.formValidate.realname,callback:function(e){t.$set(t.formValidate,\"realname\",e)},expression:\"formValidate.realname\"}})],1)],1)],1),t._v(\" \"),a(\"center\",[a(\"FormItem\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:t.Search}},[t._v(\"搜索\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:t.handleReset}},[t._v(\"\\n                                        重置\\n                                    \")])],1)],1)],1)],1)],1)],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:t.columns,data:t.data,loading:t.loading}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:t.pageTotal,current:t.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(e){t.page=e},\"on-change\":t.pageChange,\"on-page-size-change\":t.pageSizeChange}})],1)],1)},[],!1,null,null,null);o.options.__file=\"index.vue\";e.default=o.exports}}]);"}