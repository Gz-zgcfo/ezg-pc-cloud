{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{492:function(e,t,a){\"use strict\";a(53);var o={data:function(){return{upload_open:!1,upload:{fileMemo:\"\",resourceType:\"\",entityType:\"\",isvideo:\"N\"},sourceurl:\"\",filename:\"\",selectType:[],upload_rule:{fileMemo:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],resourceType:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}]},upload_loading:!1,file:[]}},computed:{isshow:function(){return\"N\"==this.upload.isvideo?1:0}},methods:{submit:function(){var t=this,a=this;this.$refs.upload.validate(function(e){e&&\"\"!=a.file?a.uploadok():t.$Message.error(\"请填写必选项！\")})},handleUpload:function(e){return this.file.push(e),!1},fileRemove:function(e){this.file.splice(this.file.indexOf(e),1)},cancel:function(){this.file=[],this.upload.fileMemo=\"\",this.upload.resourceType=\"\",this.upload.entityType=\"\",this.upload_open=!1,this.$refs.upload.resetFields()},uploadok:function(){var t=this;t.upload_loading=!0;var e=new FormData;e.append(\"resourceType\",t.upload.resourceType),e.append(\"fileMemo\",t.upload.fileMemo),e.append(\"entityType\",t.entityType),e.append(\"isvideo\",t.upload.isvideo),\"N\"==t.upload.isvideo?e.append(\"file\",t.file[0]):(e.append(\"sourceurl\",t.sourceurl),e.append(\"filename\",t.filename)),this.$http.post(\"api/zuul/system/resource/createSource\",e).then(function(e){\"40000\"==e.data.msgCode?(t.$Message.success(e.data.msg),t.cancel(),t.upload_loading=!1,t.$emit(\"update\",!0)):(t.$Message.error(e.data.msg),t.upload_loading=!1)}).catch(function(e){t.$Message.error(e),t.upload_loading=!1})}},created:function(){var t=this;t.$bus.off(\"upload_material_company\"),t.$bus.on(\"upload_material_company\",function(e){t.entityType=e[1],t.selectType=e[0],t.upload_open=!0})}},r=a(4),i=Object(r.a)(o,function(){var a=this,e=a.$createElement,o=a._self._c||e;return o(\"Modal\",{attrs:{title:\"上传资料\",width:\"600\",\"mask-closable\":!1},model:{value:a.upload_open,callback:function(e){a.upload_open=e},expression:\"upload_open\"}},[o(\"Form\",{ref:\"upload\",attrs:{model:a.upload,rules:a.upload_rule,\"label-width\":120}},[o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),o(\"Col\",{attrs:{span:\"20\"}},[o(\"FormItem\",{attrs:{prop:\"resourceType\",label:\"资料类型：\"}},[o(\"Select\",{attrs:{transfer:\"\",placeholder:\"\",size:\"small\"},model:{value:a.upload.resourceType,callback:function(e){a.$set(a.upload,\"resourceType\",e)},expression:\"upload.resourceType\"}},a._l(a.selectType,function(e,t){return o(\"Option\",{key:t,attrs:{value:e.typecode}},[a._v(a._s(e.typename))])}),1)],1)],1)],1),a._v(\" \"),o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),o(\"Col\",{attrs:{span:\"20\"}},[o(\"FormItem\",{attrs:{prop:\"fileMemo\",label:\"资料说明：\"}},[o(\"Input\",{attrs:{size:\"small\"},model:{value:a.upload.fileMemo,callback:function(e){a.$set(a.upload,\"fileMemo\",e)},expression:\"upload.fileMemo\"}})],1)],1)],1),a._v(\" \"),o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),o(\"Col\",{attrs:{span:\"20\"}},[o(\"FormItem\",{attrs:{prop:\"isvideo\",label:\"是否为视频资料：\"}},[o(\"RadioGroup\",{model:{value:a.upload.isvideo,callback:function(e){a.$set(a.upload,\"isvideo\",e)},expression:\"upload.isvideo\"}},[o(\"Radio\",{attrs:{label:\"N\"}},[a._v(\"否\")]),a._v(\" \"),o(\"Radio\",{attrs:{label:\"Y\"}},[a._v(\"是\")])],1)],1)],1)],1),a._v(\" \"),a.isshow?a._e():o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),o(\"Col\",{attrs:{span:\"20\"}},[o(\"FormItem\",{attrs:{label:\"资料名称：\"}},[o(\"Input\",{attrs:{size:\"small\"},model:{value:a.filename,callback:function(e){a.filename=e},expression:\"filename\"}})],1)],1)],1),a._v(\" \"),a.isshow?a._e():o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),o(\"Col\",{attrs:{span:\"20\"}},[o(\"FormItem\",{attrs:{label:\"视频地址：\"}},[o(\"Input\",{attrs:{size:\"small\"},model:{value:a.sourceurl,callback:function(e){a.sourceurl=e},expression:\"sourceurl\"}})],1)],1)],1),a._v(\" \"),o(\"Row\",[a.isshow?o(\"center\",[o(\"Upload\",{ref:\"upload\",attrs:{\"before-upload\":a.handleUpload,action:\"\"}},[o(\"Button\",{attrs:{type:\"ghost\",icon:\"ios-cloud-upload-outline\"}},[a._v(\"选择文件\")])],1),a._v(\" \"),a._l(a.file,function(t,e){return o(\"div\",{key:e},[a._v(a._s(t.name)+\"\\n                    \"),o(\"Button\",{attrs:{type:\"text\"},on:{click:function(e){a.fileRemove(t)}}},[a._v(\"移除\")])],1)})],2):a._e()],1)],1),a._v(\" \"),o(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"Button\",{attrs:{type:\"primary\",loading:a.upload_loading},on:{click:a.uploadok}},[a._v(\"上传\")]),a._v(\" \"),o(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:a.cancel}},[a._v(\"取消\")])],1)],1)},[],!1,null,null,null);i.options.__file=\"upload.vue\";t.a=i.exports},493:function(e,t,a){\"use strict\";var o=a(53),r={data:function(){return{selectType:[],row:{fileName:\"\",fileMemo:\"\",id:\"\",Type:\"\",sourceurl:\"\"},row_rule:{fileName:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],fileMemo:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],Type:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}]},key:\"\",isEdit:!1}},methods:{submit_index:function(){var t=this,a=this;this.$refs.row.validate(function(e){e?a.submit():t.$Message.error(\"请填写必选项！\")})},submit:function(){var t=this,e={id:t.row.id.toString(),sourcetype:t.row.Type,filename:t.row.fileName,sourcememo:t.row.fileMemo,sourceurl:t.row.sourceurl,classify:t.key};this.$http.post(\"api/system/resource/updateSource\",e).then(function(e){\"40000\"==e.data.msgCode?(t.$Message.success(e.data.msg),t.isEdit=!1,t.$emit(\"update\",!0)):t.$Message.error(e.data.msg)})},close:function(){this.row.fileName=\"\",this.row.fileMemo=\"\",this.row.id=\"\",this.row.contractType=\"\",this.row.sourceurl=\"\",this.isEdit=!1}},created:function(){var t=this;o.a.$off(\"Open_material_house_edit\"),o.a.$on(\"Open_material_house_edit\",function(e){t.selectType=e[1],t.key=e[2],\"depart\"==e[2]&&(t.row.id=e[0].id,t.row.fileName=e[0].filename,t.row.fileMemo=e[0].sourcememo,t.row.Type=e[0].sourcetype,t.row.sourceurl=e[0].sourceurl),\"company\"==e[2]&&(t.row.id=e[0].id,t.row.fileName=e[0].filename,t.row.fileMemo=e[0].sourcememo,t.row.Type=e[0].sourcetype,t.row.sourceurl=e[0].sourceurl),t.isEdit=!0})}},i=a(4),s=Object(i.a)(r,function(){var a=this,e=a.$createElement,o=a._self._c||e;return o(\"div\",[o(\"Modal\",{attrs:{title:\"编辑\",width:\"400\",\"mask-closable\":!1},model:{value:a.isEdit,callback:function(e){a.isEdit=e},expression:\"isEdit\"}},[o(\"Form\",{ref:\"row\",staticStyle:{margin:\"auto\"},attrs:{model:a.row,rules:a.row_rule,\"label-width\":140}},[o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{attrs:{span:\"22\"}},[o(\"FormItem\",{attrs:{prop:\"Type\",label:\"文件类别：\"}},[o(\"Select\",{attrs:{transfer:\"\",placeholder:\"\",size:\"small\"},model:{value:a.row.Type,callback:function(e){a.$set(a.row,\"Type\",e)},expression:\"row.Type\"}},a._l(a.selectType,function(e,t){return o(\"Option\",{key:t,attrs:{value:e.typecode}},[a._v(a._s(e.typename))])}),1)],1)],1)],1),a._v(\" \"),o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{attrs:{span:\"22\"}},[o(\"FormItem\",{attrs:{prop:\"fileName\",label:\"文件名称：\"}},[o(\"Input\",{attrs:{type:\"text\",size:\"small\"},model:{value:a.row.fileName,callback:function(e){a.$set(a.row,\"fileName\",e)},expression:\"row.fileName\"}})],1)],1)],1),a._v(\" \"),o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{attrs:{span:\"22\"}},[o(\"FormItem\",{attrs:{prop:\"fileMemo\",label:\"文件说明：\"}},[o(\"Input\",{attrs:{type:\"text\",size:\"small\"},model:{value:a.row.fileMemo,callback:function(e){a.$set(a.row,\"fileMemo\",e)},expression:\"row.fileMemo\"}})],1)],1)],1),a._v(\" \"),o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{attrs:{span:\"22\"}},[o(\"FormItem\",{attrs:{prop:\"sourceurl\",label:\"视频地址：\"}},[o(\"Input\",{attrs:{type:\"text\",size:\"small\"},model:{value:a.row.sourceurl,callback:function(e){a.$set(a.row,\"sourceurl\",e)},expression:\"row.sourceurl\"}})],1)],1)],1)],1),a._v(\" \"),o(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[o(\"Button\",{attrs:{type:\"primary\"},on:{click:a.submit_index}},[a._v(\"修改\")]),a._v(\" \"),o(\"Button\",{attrs:{type:\"ghost\"},on:{click:a.close}},[a._v(\"关闭\")])],1)],1)],1)},[],!1,null,null,null);s.options.__file=\"edit_file.vue\";t.a=s.exports},859:function(e,t,a){\"use strict\";a.r(t);var o=a(53),r=a(114),i=a(493),s=a(492),l={name:\"DepartmentInformation_index\",components:{Edit:i.a,Upload:s.a},data:function(){var o=this;return{resourceType:[],resourceType_Map:new Map,company:{fileName:\"\",fileMemo:\"\",realname:\"\",resourceType:\"\",createdate:[]},local_rows:[],search_model:\"\",page:1,pageSize:10,pageTotal:new Number,loading:!1,header:[{type:\"index\",title:\"序号\",minWidth:60,align:\"center\"},{title:\"文件名称\",key:\"filename\",minWidth:280},{title:\"文件类型\",key:\"resourceTypeName\",minWidth:120},{title:\"文件说明\",key:\"sourcememo\",minWidth:120},{title:\"视频文件\",key:\"isvideo\",minWidth:120,render:function(e,t){return\"N\"==t.row.isvideo?e(\"div\",\"否\"):e(\"div\",\"是\")}},{title:\"创建人\",key:\"realname\",minWidth:120},{title:\"创建部门\",key:\"departname\",minWidth:150},{title:\"创建时间\",key:\"createdate\",minWidth:120},{title:\"操作\",key:\"action\",width:180,fixed:\"right\",align:\"center\",render:function(e,t){var a=t.row.filename.split(\".\");return o.$indexOfArray(a[a.length-1],[\"xlsx\",\"xls\",\"doc\",\"docx\",\"ppt\",\"pptx\",\"pdf\"])?e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){var e=o.$router.resolve({name:\"previewFile\",params:{id:t.row.id}});window.open(e.href,\"_blank\")}}},\"预览\"),e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){if(\"N\"==t.row.isvideo){var e=\"api/system/resource/download?id=\"+t.row.id;window.open(e)}else window.open(t.row.sourceurl)}}},\"下载\"),e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\",display:\"管理员\"==localStorage.getItem(\"realname\")?\"inline\":\"none\"},on:{click:function(){o.delete_file(t.row)}}},\"删除\")]):e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){o.$Message.error(\"该文件暂不支持预览！\")}}},\"预览\"),e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){if(\"N\"==t.row.isvideo){var e=\"api/system/resource/download?id=\"+t.row.id;window.open(e)}else window.open(t.row.sourceurl)}}},\"下载\"),e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\",display:\"管理员\"==localStorage.getItem(\"realname\")?\"inline\":\"none\"},on:{click:function(){o.delete_file(t.row)}}},\"删除\")])}}],data:[]}},methods:{search:function(){this.page=1,this.getData()},reset:function(){this.company.fileName=\"\",this.company.fileMemo=\"\",this.company.realname=\"\",this.company.resourceType=\"\",this.company.createdate=[],this.getData()},pageChange:function(e){this.page=e,this.getData()},upload:function(){this.$bus.emit(\"upload_material_company\",[this.resourceType,\"depart\"])},edit:function(){\"\"!=this.local_rows?o.a.$emit(\"Open_material_house_edit\",[this.local_rows,this.resourceType,\"depart\"]):this.$Message.warning(\"请选择一行进行编辑！\")},save_rows:function(e){this.local_rows=[],this.local_rows=e},getData:function(){this.local_rows=[];var a=this;a.loading=!0;var e={params:{page:a.page,pageSize:10,resourceType:a.company.resourceType,fileName:a.company.fileName,resourceMemo:a.company.fileMemo,realname:a.company.realname,bcreatedate:Object(r.a)(a.company.createdate[0]),ecreatedate:Object(r.a)(a.company.createdate[1]),sortField:\"createdate\",order:\"desc\",classify:\"depart\"}};this.$Get(\"api/system/resource/showResourceInfo\",e,function(e){a.data=e.data.data.rows;for(var t=0;t<a.data.length;t++)\"\"==a.data[t].createdate||null==a.data[t].createdate?a.data[t].createdate=\"\":a.data[t].createdate=a.data[t].createdate.slice(0,10),a.data[t].sourcetype&&(a.data[t].resourceTypeName=a.resourceType_Map.get(a.data[t].sourcetype));a.pageTotal=e.data.data.total,a.loading=!1})},getDataCenter:function(){var a=this;return new Promise(function(t,e){a.$GetDataCenter(\"departResourceType\",function(e){a.resourceType=e.data.data.departResourceType,a.resourceType_Map=a.$array2map(a.resourceType),t()})})},delete_file:function(e){var t=this,a={id:e.id,deleteflag:\"1\"};this.$Post(\"api/system/resource/updateSource\",a,function(e){t.getData()},function(e){})}},created:function(){var e=this;this.getDataCenter().then(function(){e.getData()}).catch(function(e){})}},n=a(4),p=Object(n.a)(l,function(){var a=this,e=a.$createElement,o=a._self._c||e;return o(\"Card\",[o(\"Row\",{staticStyle:{\"margin-bottom\":\"20px\"}},[o(\"Collapse\",{model:{value:a.search_model,callback:function(e){a.search_model=e},expression:\"search_model\"}},[o(\"Panel\",{attrs:{name:\"1\"}},[o(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),a._v(\"\\n                    筛选\\n                    \"),o(\"p\",{attrs:{slot:\"content\"},slot:\"content\"}),o(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(e){return\"button\"in e||!a._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?a.search(e):null}},slot:\"content\"},[o(\"Form\",{ref:\"company\",attrs:{model:a.company,\"label-width\":100}},[o(\"Row\",{attrs:{gutter:16}},[o(\"Col\",{attrs:{span:\"8\"}},[o(\"FormItem\",{attrs:{prop:\"fileName\",label:\"文件名称：\"}},[o(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:a.company.fileName,callback:function(e){a.$set(a.company,\"fileName\",e)},expression:\"company.fileName\"}})],1)],1),a._v(\" \"),o(\"Col\",{attrs:{span:\"8\"}},[o(\"FormItem\",{attrs:{prop:\"fileMemo\",label:\"文件说明：\"}},[o(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:a.company.fileMemo,callback:function(e){a.$set(a.company,\"fileMemo\",e)},expression:\"company.fileMemo\"}})],1)],1),a._v(\" \"),o(\"Col\",{attrs:{span:\"8\"}},[o(\"FormItem\",{attrs:{prop:\"resourceType\",label:\"文件类型：\"}},[o(\"Select\",{attrs:{type:\"text\",transfer:\"\",placeholder:\"\",size:\"small\"},model:{value:a.company.resourceType,callback:function(e){a.$set(a.company,\"resourceType\",e)},expression:\"company.resourceType\"}},a._l(a.resourceType,function(e,t){return o(\"Option\",{key:t,attrs:{value:e.typecode}},[a._v(a._s(e.typename))])}),1)],1)],1)],1),a._v(\" \"),o(\"FormItem\",[o(\"Button\",{attrs:{type:\"primary\"},on:{click:a.search}},[a._v(\"搜索\")]),a._v(\" \"),o(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:a.reset}},[a._v(\"重置\")])],1)],1)],1),a._v(\" \"),o(\"p\")],1)],1)],1),a._v(\" \"),o(\"Row\",[o(\"ButtonGroup\",[o(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:a.upload}},[a._v(\"上传资料\")]),a._v(\" \"),o(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:a.edit}},[a._v(\"编辑\")])],1)],1),a._v(\" \"),o(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[o(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",columns:a.header,loading:a.loading,data:a.data},on:{\"on-current-change\":a.save_rows}}),a._v(\" \"),o(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:a.pageTotal,current:a.page,\"show-total\":\"\",\"show-elevator\":\"\",placement:\"top\"},on:{\"update:current\":function(e){a.page=e},\"on-change\":a.pageChange}})],1),a._v(\" \"),o(\"edit\",{on:{update:a.getData}}),a._v(\" \"),o(\"upload\",{on:{update:a.getData}})],1)},[],!1,null,null,null);p.options.__file=\"index.vue\";t.default=p.exports}}]);"}