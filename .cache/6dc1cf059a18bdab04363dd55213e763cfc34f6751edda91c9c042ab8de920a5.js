{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{866:function(a,e,t){\"use strict\";t.r(e);var r={data:function(){return{title:\"dealCycle\"==this.$route.query.type?\"客户成交周期详情\":\"二次成交比例详情\",header:[{title:\"姓名\",key:\"NAME\",minWidth:120},{title:\"归属公司\",key:\"companynames\",minWidth:210,render:function(e,a){if(\"\"==a.row.companynames||null==a.row.companynames)return\"\";var t=a.row.companynames.split(\",\");return 13<t[0].length?e(\"Poptip\",{props:{trigger:\"hover\",title:\"归属公司\",placement:\"bottom\"}},[e(\"span\",t[0].slice(0,13)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"ul\",t.map(function(a){return[e(\"li\",{style:{padding:\"4px\"}},\"公司名：\"+a)]}))])]):e(\"Poptip\",{props:{trigger:\"hover\",title:\"归属公司\",placement:\"bottom\"}},[e(\"span\",t[0]),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"ul\",t.map(function(a){return[e(\"li\",{style:{padding:\"4px\"}},\"公司名：\"+a)]}))])])}},{title:\"电话\",key:\"TEL\",minWidth:120},{title:\"客户状态\",key:\"customerType\",minWidth:140},{title:\"客户来源\",key:\"customersource\",minWidth:120},{title:\"客户等级\",key:\"importlevel\",minWidth:120},{title:\"区域\",key:\"AREA\",minWidth:80},{title:\"渠道名称\",key:\"channelTypeName\",minWidth:140},{title:\"跟进人\",key:\"followbyname\",minWidth:120},{title:\"创建时间\",key:\"CREATEDATE\",minWidth:120},{title:\"更新时间\",key:\"updatedate\",minWidth:120}],data:[],page:1,pageSize:10,total:0,tableLoading:!0,customerTypes:[],cluesources:[],customerrating:[],area:[],sf_yn:[],importance:[],cluesources_map:new Map,customerrating_map:new Map,area_map:new Map,sf_yn_map:new Map,importance_map:new Map,customerTypes_Casr:[],customerTypes_array:[]}},watch:{$route:function(a,e){this.get_data(a.query)}},methods:{get_data:function(a){this.tableLoading=!0,\"dealCycle\"==a.type?this.get_deal_cycle(a):this.get_second_deal(a)},get_deal_cycle:function(a){var e={params:{}};\"depart\"==a.idType?e.params.departId=a.id:e.params.userId=a.id,\"c1\"==a.dealType?e.params.c1=1:\"c2\"==a.dealType?e.params.c2=1:\"c3\"==a.dealType?e.params.c3=1:e.params.c4=1,this.get_all_data(\"api/crm/sale/index/customer/deal/cycle/list\",e)},get_second_deal:function(a){var e={params:{}};\"depart\"==a.idType?e.params.departId=a.id:e.params.userId=a.id,\"second\"==a.type&&(e.params.renew_order_count=1),this.get_all_data(\"api/crm/sale/index/customer/second/deal/list\",e)},get_all_data:function(a,e){var t={page:this.page,pageSize:this.pageSize,bcreatedate:\"\",ecreatedate:\"\"};Object.assign(e.params,t);var r=this;this.$Get(a,e,function(a){r.data=a.data.data.rows,r.total=a.data.data.total;for(var e=0;e<r.data.length;e++)r.data[e].customerType=r.findCustomerType(r.data[e].customerType),r.data[e].importlevel&&(r.data[e].importlevel=r.customerrating_map.get(r.data[e].importlevel.toString())),r.data[e].AREA=r.area_map.get(r.data[e].AREA),r.data[e].customersourceCode=r.data[e].customersource,r.data[e].customersource=r.cluesources_map.get(r.data[e].customersource),r.data[e].importance=r.importance_map.get(r.data[e].importance),r.data[e].isbound=r.sf_yn_map.get(r.data[e].isbound),r.data[e].CREATEDATE&&(r.data[e].CREATEDATE=r.data[e].CREATEDATE.slice(0,10)),r.data[e].updatedate&&(r.data[e].updatedate=r.data[e].updatedate.slice(0,10));r.tableLoading=!1})},findCustomerType:function(a){if(\"\"==a||null==a)return\"\";for(var e=a.split(\"-\"),t=this,r=0;r<t.customerTypes_array.length;r++)if(t.customerTypes_array[r].id==e[1]&&\"\"!=e[1])return t.customerTypes_array[r].ptypename+\" - \"+t.customerTypes_array[r].typename},page_change:function(a){this.page=a,this.get_data(this.$route.query)},page_size_change:function(a){this.pageSize=a,this.page=1,this.get_data(this.$route.query)},open_show:function(a){this.$store.commit(\"open_gobal_customer_detail_modal\",{ID:a.ID})},get_data_center:function(){var r=this;return new Promise(function(e,a){var t=r;r.$GetDataCenter(\"customerTypes,cluesources,customerrating,area,sf_yn,importance\",function(a){t.customerTypes=a.data.data.customerTypes,t.cluesources=a.data.data.cluesources,t.customerrating=a.data.data.customerrating,t.area=a.data.data.area,t.sf_yn=a.data.data.sf_yn,t.importance=a.data.data.importance,t.cluesources_map=t.$array2map(t.cluesources),t.customerrating_map=t.$array2map(t.customerrating),t.area_map=t.$array2map(t.area),t.sf_yn_map=t.$array2map(t.sf_yn),t.importance_map=t.$array2map(t.importance),t.customerTypes_Casr=t.$changeCars(t.customerTypes),t.customerTypes_array=t.$Data2Casr(t.customerTypes),e()})})}},created:function(){var a=this;this.get_data_center().then(function(){a.get_data(a.$route.query)})}},n=t(4),s=Object(n.a)(r,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t(\"div\",[t(\"Card\",{attrs:{title:e.title}},[t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:e.header,data:e.data,loading:e.tableLoading},on:{\"on-row-dblclick\":e.open_show}}),e._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.total,current:e.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(a){e.page=a},\"on-change\":e.page_change,\"on-page-size-change\":e.page_size_change}})],1)],1)],1)},[],!1,null,null,null);s.options.__file=\"index.vue\";e.default=s.exports}}]);"}