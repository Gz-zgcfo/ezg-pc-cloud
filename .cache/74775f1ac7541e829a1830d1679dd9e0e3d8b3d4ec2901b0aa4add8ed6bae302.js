{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{168:function(t,e,a){},169:function(t,e,a){},170:function(t,e,a){},171:function(t,e,a){},172:function(t,e,a){},173:function(t,e,a){},174:function(t,e,a){},350:function(t,e,a){\"use strict\";var r=a(168);a.n(r).a},352:function(t,e,a){\"use strict\";var r=a(169);a.n(r).a},354:function(t,e,a){\"use strict\";var r=a(170);a.n(r).a},356:function(t,e,a){\"use strict\";var r=a(171);a.n(r).a},358:function(t,e,a){\"use strict\";var r=a(172);a.n(r).a},360:function(t,e,a){\"use strict\";var r=a(173);a.n(r).a},362:function(t,e,a){\"use strict\";var r=a(174);a.n(r).a},384:function(t,e,a){\"use strict\";a.r(e);var r={data:function(){return{selectRow:\"\",customerId:\"\",customerTypes:[],cluesources:[],customerrating:[],area:[],sf_yn:[],importance:[],cluesources_map:new Map,customerrating_map:new Map,area_map:new Map,sf_yn_map:new Map,importance_map:new Map,customerTypes_Casr:[],customerTypes_array:[]}},methods:{get_data_center:function(){var t=this;return new Promise(function(e,a){var r=t;t.$GetDataCenter(\"customerTypes,cluesources,customerrating,area,sf_yn,importance\",function(t){r.customerTypes=t.data.data.customerTypes,r.cluesources=t.data.data.cluesources,r.customerrating=t.data.data.customerrating,r.area=t.data.data.area,r.sf_yn=t.data.data.sf_yn,r.importance=t.data.data.importance,r.cluesources_map=r.$array2map(r.cluesources),r.customerrating_map=r.$array2map(r.customerrating),r.area_map=r.$array2map(r.area),r.sf_yn_map=r.$array2map(r.sf_yn),r.importance_map=r.$array2map(r.importance),r.customerTypes_Casr=r.$changeCars(r.customerTypes),r.customerTypes_array=r.$Data2Casr(r.customerTypes),e()})})},check_select:function(t){this.selectRow?this.$bus.emit(t,this.selectRow):this.$Message.warning(\"请选择需要操作的客户！\")}},created:function(){}},o=a(25),l={props:{cluesources:{type:Array},customerrating:{type:Array},area:{type:Array},sf_yn:{type:Array},importance:{type:Array},customerTypes_Casr:{type:Array},customer:{type:[Array,Object,String]}},data:function(){return{loading:!1,LabelArray:[],allLabel:[],ChannelType:[],isOpenEdit:!1,formValidate:{id:\"\",NAME:\"\",TEL:\"\",fixedPhone:\"\",qq:\"\",weixin:\"\",ADDRESS:\"\",customerType:[],customersource:\"\",importlevel:\"\",AREA:\"\",issends:\"   \",customerlabel:[],createdate:\"\",updatedate:\"\",gxr:\"\",backup:\"\",sourcesubdivision:\"\",isbound:\"\",email:\"\",channelsource:\"\",channel_type_id:\"\",recCustomer:\"\",importance:\"\",labels:[]},ruleValidate:{}}},methods:{get_data:function(t){var e=this,a={params:{id:t}};this.$Get(\"/api/customer/detail\",a,function(t){if(e.formValidate=t.data.data,e.formValidate.customerType&&(e.formValidate.customerType=e.formValidate.customerType.split(\"-\"),e.formValidate.customerType[0]=parseInt(e.formValidate.customerType[0]),e.formValidate.customerType[1]=parseInt(e.formValidate.customerType[1])),e.formValidate.importlevel&&(e.formValidate.importlevel=\"\"+e.formValidate.importlevel),e.formValidate.labels){e.formValidate.labels=e.formValidate.labels.split(\",\");for(var a=0;a<e.formValidate.labels.length;a++)e.formValidate.labels[a]=parseInt(e.formValidate.labels[a])}e.$emit(\"cancel-loading\",!0)})},get_channel_type:function(){var t=this,e=this,a={};return new Promise(function(r,o){t.$Get(\"api/channel/type/queryUserChannel?type=xs\",a,function(t){e.ChannelType=t.data.data,r()})})},get_all_label:function(){var t=this,e=this,a={};return new Promise(function(r,o){t.$Get(\"api/system/label/list?page=1&pageSize=100\",a,function(t){e.allLabel=t.data.data.rows,r()})})}},created:function(){var t=this;Promise.all([this.get_channel_type(),this.get_all_label()]).then(function(){t.get_data(t.customer.ID)})},watch:{}},s=a(2),n=Object(s.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Form\",{ref:\"formValidate\",attrs:{rules:t.ruleValidate,model:t.formValidate,\"label-width\":80}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"姓名\",prop:\"NAME\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.NAME,callback:function(e){t.$set(t.formValidate,\"NAME\",e)},expression:\"formValidate.NAME\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"电话\",prop:\"TEL\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.TEL,callback:function(e){t.$set(t.formValidate,\"TEL\",e)},expression:\"formValidate.TEL\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"固话\",prop:\"fixedPhone\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.fixedPhone,callback:function(e){t.$set(t.formValidate,\"fixedPhone\",e)},expression:\"formValidate.fixedPhone\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"QQ\",prop:\"qq\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.qq,callback:function(e){t.$set(t.formValidate,\"qq\",e)},expression:\"formValidate.qq\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"微信\",prop:\"weixin\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.weixin,callback:function(e){t.$set(t.formValidate,\"weixin\",e)},expression:\"formValidate.weixin\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"邮箱\",prop:\"email\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.email,callback:function(e){t.$set(t.formValidate,\"email\",e)},expression:\"formValidate.email\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"服务地址\",prop:\"ADDRESS\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidate.ADDRESS,callback:function(e){t.$set(t.formValidate,\"ADDRESS\",e)},expression:\"formValidate.ADDRESS\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"客户状态\",prop:\"customerType\"}},[a(\"Cascader\",{attrs:{trigger:\"hover\",data:t.customerTypes_Casr,disabled:\"\"},model:{value:t.formValidate.customerType,callback:function(e){t.$set(t.formValidate,\"customerType\",e)},expression:\"formValidate.customerType\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"客户来源\",prop:\"customersource\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\",disabled:\"\"},model:{value:t.formValidate.customersource,callback:function(e){t.$set(t.formValidate,\"customersource\",e)},expression:\"formValidate.customersource\"}},t._l(t.cluesources,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),\"xzqd\"==t.formValidate.customersource?a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"渠道名称\",prop:\"channel_type_id\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\",disabled:\"\"},model:{value:t.formValidate.channel_type_id,callback:function(e){t.$set(t.formValidate,\"channel_type_id\",e)},expression:\"formValidate.channel_type_id\"}},t._l(t.ChannelType,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.channel_type_name))])}),1)],1):t._e(),t._v(\" \"),\"khtj\"==t.formValidate.customersource?a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"推荐客户\",prop:\"rec_customer\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},on:{\"on-focus\":t.getCustomer},model:{value:t.formValidate.rec_customer,callback:function(e){t.$set(t.formValidate,\"rec_customer\",e)},expression:\"formValidate.rec_customer\"}})],1):t._e(),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"客户等级\",prop:\"importlevel\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\",disabled:\"\"},model:{value:t.formValidate.importlevel,callback:function(e){t.$set(t.formValidate,\"importlevel\",e)},expression:\"formValidate.importlevel\"}},t._l(t.customerrating,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"重要性\",prop:\"importance\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\",disabled:\"\"},model:{value:t.formValidate.importance,callback:function(e){t.$set(t.formValidate,\"importance\",e)},expression:\"formValidate.importance\"}},t._l(t.importance,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"区域\",prop:\"AREA\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\",disabled:\"\"},model:{value:t.formValidate.AREA,callback:function(e){t.$set(t.formValidate,\"AREA\",e)},expression:\"formValidate.AREA\"}},t._l(t.area,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"发送短信\",prop:\"issends\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\",disabled:\"\"},model:{value:t.formValidate.issends,callback:function(e){t.$set(t.formValidate,\"issends\",e)},expression:\"formValidate.issends\"}},t._l(t.sf_yn,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"标签\",prop:\"customerlabelTags\"}},t._l(t.LabelArray,function(e,r){return a(\"Tag\",{key:r,attrs:{name:r}},[t._v(t._s(e.labelName))])}),1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"创建时间\",prop:\"CREATEDATE\"}},[a(\"Input\",{attrs:{readonly:\"\",size:\"small\"},model:{value:t.formValidate.CREATEDATE,callback:function(e){t.$set(t.formValidate,\"CREATEDATE\",e)},expression:\"formValidate.CREATEDATE\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"},attrs:{label:\"更新时间\",prop:\"updatedate\"}},[a(\"Input\",{attrs:{readonly:\"\",size:\"small\"},model:{value:t.formValidate.updatedate,callback:function(e){t.$set(t.formValidate,\"updatedate\",e)},expression:\"formValidate.updatedate\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{label:\"备注\",prop:\"backup\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"textarea\",readonly:\"\"},model:{value:t.formValidate.backup,callback:function(e){t.$set(t.formValidate,\"backup\",e)},expression:\"formValidate.backup\"}})],1),t._v(\" \"),a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"0px\"}})],1)],1)},[],!1,null,null,null);n.options.__file=\"edit.vue\";var i=n.exports,c={data:function(){return{data:[],header:[{title:\"变更前公司名称\",key:\"oldValue\",minWidth:160},{title:\"变更后公司名称\",key:\"newValue\",minWidth:160},{title:\"修改时间\",key:\"updateDate\",minWidth:160},{title:\"操作人员\",key:\"realname\",minWidth:160}],loading:!1,openComNameLog:!1}},methods:{get_data:function(t){var e=this;e.$ButtonCollect(\"marketingManagement_index_company_businessinfo_namelog\"),e.loading=!0;var a={params:{companyid:t,page:1,pageSize:100,sortField:\"updateDate\"}};this.$Get(\"api/customer/company/companyNameChangeLogList\",a,function(t){e.data=t.data.data.rows,e.loading=!1})}},created:function(){var t=this;this.$bus.off(\"SHOW_OPEN_COMPANY_LOG\",!0),this.$bus.on(\"SHOW_OPEN_COMPANY_LOG\",function(e){t.get_data(e),t.openComNameLog=!0})}},d=Object(s.a)(c,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{width:\"680\",title:\"公司名称变更日志\"},model:{value:t.openComNameLog,callback:function(e){t.openComNameLog=e},expression:\"openComNameLog\"}},[a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",columns:t.header,loading:t.loading,data:t.data}})],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);d.options.__file=\"changeLog.vue\";var m={components:{changeLog:d.exports},props:{customer:{type:[Array,Object,String]},importance:{type:Array},cluesources:{type:Array}},data:function(){var t=this;return{loading:!1,close:!1,header:[{title:\"序号\",type:\"index\",width:60,align:\"center\"},{title:\"公司名称\",minWidth:250,render:function(t,e){return\"\"==e.row.companyname||null==e.row.companyname?\"\":e.row.companyname.length>15?t(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[t(\"span\",e.row.companyname.slice(0,15)+\"...\"),t(\"Icon\",{props:{type:\"arrow-down-b\"}}),t(\"div\",{slot:\"content\"},[t(\"span\",e.row.companyname)])]):t(\"span\",e.row.companyname)}},{title:\"跟进销售\",key:\"followby\",minWidth:100},{title:\"交易状态\",key:\"enterprisestatusText\",minWidth:100},{title:\"法人\",key:\"legalrepresentative\",minWidth:100},{title:\"重要等级\",key:\"importlevelText\",minWidth:100},{title:\"创建人\",key:\"createby\",minWidth:100},{title:\"企业来源\",key:\"cluesourceText\",minWidth:150},{title:\"操作\",key:\"action\",minWidth:250,align:\"center\",render:function(e,a){return e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\",disabled:\"readonly\"==a.row.status},style:{marginRight:\"5px\"},on:{click:function(){t.$bus.emit(\"OPEN_COMPANY_UPDATE\",a.row)}}},\"编辑\"),e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){t.edit(a)}}},\"工商信息\"),e(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){t.get_company_name_change_log(a.row.id)}}},\"名称变更日志\")])}}],data:[],companyarea_Casr:[],taxtype:[]}},methods:{get_data:function(t){var e=this;e.loading=!0;var a=\"api/customer/findCompanysByCustomerId/\"+t;this.$Get(a,{},function(t){e.data=t.data.data,e.loading=!1})},get_data_center:function(){var t=this;this.$GetDataCenter(\"companyarea,taxtype\",function(e){t.companyarea_Casr=t.$changeCars(e.data.data.companyarea),t.taxtype=e.data.data.taxtype,t.close=!0})},get_company_name_change_log:function(t){this.$bus.emit(\"SHOW_OPEN_COMPANY_LOG\",t)}},created:function(){this.get_data_center(),this.get_data(this.customer.ID)}},p=Object(s.a)(m,function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",[e(\"Table\",{staticStyle:{\"margin-top\":\"15px\"},attrs:{loading:this.loading,border:\"\",size:\"small\",columns:this.header,data:this.data}}),this._v(\" \"),e(\"change-log\")],1)},[],!1,null,null,null);p.options.__file=\"index.vue\";var u=p.exports,f={props:{row:Object},filters:{DateFormat:function(t){if(t)return t.slice(0,10)}}},_=(a(350),Object(s.a)(f,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Row\",[a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"订单号: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.ordercode))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"开始时间: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t._f(\"DateFormat\")(t.row.ServiceStart)))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"服务部门: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.departname))])])],1)],1),t._v(\" \"),a(\"Row\",[a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"服务人: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.servername))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"状态: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.workOrderStatus))])])],1)],1),t._v(\" \"),a(\"Row\",[a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"创建时间: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t._f(\"DateFormat\")(t.row.CreateDate)))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"更新时间: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"14\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t._f(\"DateFormat\")(t.row.UpdateDate)))])])],1)],1)],1)},[],!1,null,\"8e02b446\",null));_.options.__file=\"oneExpandRow.vue\";var y=_.exports,v={props:{workOrderStatus:{type:Map},departname:{type:String},customer:{type:[String,Object,Array]}},data:function(){return{loading:!1,header:[{type:\"expand\",width:50,render:function(t,e){return t(y,{props:{row:e.row}})}},{title:\"公司\",key:\"companyname\"},{title:\"产品名称\",key:\"product\"},{title:\"当前进度\",key:\"CurrentProcess\"}],data:[]}},methods:{open_expand:function(t,e){1==this.data[e]._expanded?this.$set(this.data[e],\"_expanded\",!1):this.$set(this.data[e],\"_expanded\",!0)},get_data:function(t,e){var a=this;a.loading=!0;var r={params:{page:1,pageSize:1e3,sortField:\"UpdateDate\",nonWorkOrderStatus:60,customerId:t,serviceDept:e,iscycle:\"N\"}};this.$Get(\"api/order/workOrderList\",r,function(t){var e=t.data.data.rows;a.data=[];for(var r=0;r<e.length;r++){var o={};o.CreateDate=e[r].CreateDate,o.CurrentProcess=e[r].CurrentProcess,o.IsOver=e[r].IsOver,o.IsShared=e[r].IsShared,o.IsWork=e[r].IsWork,o.ServiceDeptID=e[r].ServiceDeptID,o.ServiceEnd=e[r].ServiceEnd,o.ServiceStart=e[r].ServiceStart,o.UpdateDate=e[r].UpdateDate,o.companyname=e[r].companyname,o.followname=e[r].followname,o.id=e[r].id,o.name=e[r].name,o.ordercode=e[r].ordercode,o.product=e[r].product,o.resumeFlag=e[r].resumeFlag,o.resumeMsg=e[r].resumeMsg,o.servername=e[r].servername,o.tel=e[r].tel,o.departname=e[r].departname,o.workOrderStatus=a.workOrderStatus.get(e[r].workOrderStatus),o._expanded=!1,a.data.push(o)}a.loading=!1})}},mounted:function(){this.get_data(this.customer.ID,this.departname)}},h=Object(s.a)(v,function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",[e(\"Table\",{staticStyle:{\"margin-top\":\"15px\"},attrs:{size:\"small\",border:\"\",loading:this.loading,columns:this.header,data:this.data,\"no-data-text\":\"该客户暂无服务中的工单！\"},on:{\"on-row-click\":this.open_expand}})],1)},[],!1,null,null,null);h.options.__file=\"oneOffService.vue\";var g=h.exports,b={props:{row:Object},filters:{DateFormat:function(t){if(t)return t.slice(0,10)}}},w=(a(352),Object(s.a)(b,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Row\",[a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"订单号: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.ordercode))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"开始时间: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t._f(\"DateFormat\")(t.row.account_begin_time)))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"服务部门: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.departname))])])],1)],1),t._v(\" \"),a(\"Row\",[a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"服务会计: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.server_realname))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"累计外勤数量: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t.row.legwork_valid_num))])])],1)],1),t._v(\" \"),a(\"Row\",[a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"创建时间: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t._f(\"DateFormat\")(t.row.createdate)))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-key\"},[t._v(\"更新时间: \")])]),t._v(\" \"),a(\"Col\",{attrs:{span:\"10\"}},[a(\"span\",{staticClass:\"expand-value\"},[t._v(t._s(t._f(\"DateFormat\")(t.row.updatedate)))])])],1)],1)],1)},[],!1,null,\"0aaea1cb\",null));w.options.__file=\"cycleExpandRow.vue\";var x=w.exports,k={props:{customer:{type:[String,Object,Array]}},data:function(){return{loading:!1,header:[{type:\"expand\",width:50,render:function(t,e){return t(x,{props:{row:e.row}})}},{title:\"公司\",key:\"CompanyName\"},{title:\"产品名称\",key:\"product\"},{title:\"截止税期\",key:\"end_period\"}],data:[]}},methods:{open_expand:function(t,e){1==this.data[e]._expanded?this.$set(this.data[e],\"_expanded\",!1):this.$set(this.data[e],\"_expanded\",!0)},get_data:function(t){var e=this;e.loading=!0;var a={params:{page:1,pageSize:100,un_service_status:\"stop\",customerid:t}};this.$Get(\"api/order/cycle/service/record/list\",a,function(t){var a=t.data.data.rows;e.data=[];for(var r=0;r<a.length;r++){var o={};o.id=a[r].id,o.CompanyName=a[r].CompanyName,o.product=a[r].product,o.end_period=a[r].end_period,o.ordercode=a[r].ordercode,o.account_begin_time=a[r].account_begin_time,o.departname=a[r].departname,o.server_realname=a[r].server_realname,o.accmanager_realname=a[r].accmanager_realname,o.balance_count=a[r].balance_count,o.createdate=a[r].createdate,o.updatedate=a[r].updatedate,o.service_time=a[r].service_time,o.legwork_valid_num=a[r].legwork_valid_num,o._expanded=!1,e.data.push(o)}e.loading=!1})}},mounted:function(){this.get_data(this.customer.ID)}},C=Object(s.a)(k,function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",[e(\"Table\",{staticStyle:{\"margin-top\":\"15px\"},attrs:{size:\"small\",border:\"\",loading:this.loading,columns:this.header,data:this.data,\"no-data-text\":\"该客户未开通记账服务！\"},on:{\"on-row-click\":this.open_expand}})],1)},[],!1,null,null,null);C.options.__file=\"cycleService.vue\";var S=C.exports,D={props:{customer:{type:[String,Object,Array]}},components:{oneOffService:g,cycleService:S},data:function(){return{loading:!0,openTabPane:\"account\",workOrderStatus_map:new Map}},methods:{getDataCenter:function(){var t=this;this.$GetDataCenter(\"workOrderStatus\",function(e){t.workOrderStatus_map=t.$array2map(e.data.data.workOrderStatus),t.loading=!1})}},created:function(){this.getDataCenter()}},V=Object(s.a)(D,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[t.loading?t._e():a(\"Tabs\",{model:{value:t.openTabPane,callback:function(e){t.openTabPane=e},expression:\"openTabPane\"}},[a(\"TabPane\",{attrs:{label:\"会计服务进度\",name:\"account\"}},[a(\"cycle-service\",{staticStyle:{\"margin-bottom\":\"20px\"},attrs:{customer:t.customer}}),t._v(\" \"),a(\"one-off-service\",{attrs:{workOrderStatus:t.workOrderStatus_map,departname:\"'ACCOUNT'\",customer:t.customer}})],1),t._v(\" \"),a(\"TabPane\",{attrs:{label:\"商事服务进度\",name:\"commercial\"}},[a(\"one-off-service\",{attrs:{workOrderStatus:t.workOrderStatus_map,departname:\"'BUSSINESS'\",customer:t.customer}})],1),t._v(\" \"),a(\"TabPane\",{attrs:{label:\"企划服务进度\",name:\"plan\"}},[a(\"one-off-service\",{attrs:{workOrderStatus:t.workOrderStatus_map,departname:\"'PLAN'\",customer:t.customer}})],1),t._v(\" \"),a(\"TabPane\",{attrs:{label:\"审计服务进度\",name:\"aduit\"}},[a(\"one-off-service\",{attrs:{workOrderStatus:t.workOrderStatus_map,departname:\"'ADUIT'\",customer:t.customer}})],1),t._v(\" \"),a(\"TabPane\",{attrs:{label:\"行政服务进度\",name:\"administration\"}},[a(\"one-off-service\",{attrs:{workOrderStatus:t.workOrderStatus_map,departname:\"'EXECUTIVE'\",customer:t.customer}})],1)],1)],1)},[],!1,null,null,null);V.options.__file=\"index.vue\";var T=V.exports,I={data:function(){return{openAllDetail:!1,fiedDetail:{clocktime:\"\",endtime:\"\",fieldlength:\"\",assiststatus:\"\",clockshows:\"\",address1:\"\",address2:\"\",remark:\"\",imgs:[]}}},methods:{get_data:function(t){var e=this,a={params:{followRecordId:t}};this.$Get(\"api/customer/follow/record/detail\",a,function(t){if(t.data.data,null!=t.data.data){if(e.openAllDetail=!0,e.fiedDetail=t.data.data,t.data.data.realpaths){var a;e.fiedDetail.imgs=[],a=e.fiedDetail.realpaths.split(\",\");for(var r=0;r<a.length;r++)e.fiedDetail.imgs.push(a[r])}}else e.$Message.warning(\"暂无数据！\")})}},created:function(){var t=this;this.$bus.on(\"SHOW_OPEN_CUSTOMER_FOLLOW_FIELD\",function(e){t.openAllDetail=!0,t.get_data(e)})}},O=Object(s.a)(I,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"查看外勤详情\",width:\"600\"},model:{value:t.openAllDetail,callback:function(e){t.openAllDetail=e},expression:\"openAllDetail\"}},[a(\"Form\",{ref:\"fiedDetail\",attrs:{model:t.fiedDetail,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"clocktime\",label:\"上门时间：\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},model:{value:t.fiedDetail.clocktime,callback:function(e){t.$set(t.fiedDetail,\"clocktime\",e)},expression:\"fiedDetail.clocktime\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"endtime\",label:\"离开时间：\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},model:{value:t.fiedDetail.endtime,callback:function(e){t.$set(t.fiedDetail,\"endtime\",e)},expression:\"fiedDetail.endtime\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"fieldlength\",label:\"外勤时长：\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},model:{value:t.fiedDetail.fieldlength,callback:function(e){t.$set(t.fiedDetail,\"fieldlength\",e)},expression:\"fiedDetail.fieldlength\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"assiststatus\",label:\"外勤类型：\"}},[a(\"Select\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.assiststatus,callback:function(e){t.$set(t.fiedDetail,\"assiststatus\",e)},expression:\"fiedDetail.assiststatus\"}},[a(\"Option\",{attrs:{value:\"N\"}},[t._v(\"非协助外勤\")]),t._v(\" \"),a(\"Option\",{attrs:{value:\"Y\"}},[t._v(\"协助外勤\")])],1)],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"clockshows\",label:\"打卡说明：\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},model:{value:t.fiedDetail.clockshows,callback:function(e){t.$set(t.fiedDetail,\"clockshows\",e)},expression:\"fiedDetail.clockshows\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"address1\",label:\"第一次打卡地址：\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},model:{value:t.fiedDetail.address1,callback:function(e){t.$set(t.fiedDetail,\"address1\",e)},expression:\"fiedDetail.address1\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"address2\",label:\"第二次打卡地址：\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},model:{value:t.fiedDetail.address2,callback:function(e){t.$set(t.fiedDetail,\"address2\",e)},expression:\"fiedDetail.address2\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"remark\",label:\"备注总结：\"}},[a(\"Input\",{attrs:{type:\"textarea\",readonly:\"\"},model:{value:t.fiedDetail.remark,callback:function(e){t.$set(t.fiedDetail,\"remark\",e)},expression:\"fiedDetail.remark\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{margin:\"5px\"},attrs:{prop:\"Providentfund\",label:\"附件：\",readonly:\"\"}},t._l(t.fiedDetail.imgs,function(t,e){return a(\"Row\",{key:e},[a(\"a\",{attrs:{target:\"_blank\",href:\"/api/assets/\"+t}},[a(\"img\",{attrs:{src:\"/api/assets/\"+t,alt:\"\",width:\"100\",height:\"100\"}})])])}),1)],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);O.options.__file=\"fieldDetail.vue\";var $=O.exports,E={props:{customer:{type:[Object,Array,String]}},components:{followField:$},data:function(){return{currentIndex:-1,pinglun:[],markert_follow_up_type:[],market_status:[],footer:!1,followList:[],spinShow:!1,currentName:\"\",onlyMarket:\"\",single:!1}},methods:{get_data_center:function(){var t=this,e=this;return new Promise(function(a,r){t.$GetDataCenter(\"markert_follow_up_type,market_status\",function(t){e.markert_follow_up_type=t.data.data.markert_follow_up_type,e.market_status=t.data.data.market_status,a()})})},get_data:function(t){var e=this,a={};a=e.single?{params:{customerId:t,followUpType:\"11,12,13,14,15\"}}:{params:{customerId:t}},e.spinShow=!0,this.$Get(\"api/customer/findCustomerContentById\",a,function(t){e.followList=t.data.data;for(var a=0;a<e.followList.length;a++){if(null!=e.followList[a].imgurls){for(var r=[],o=e.followList[a].imgurls.split(\",\"),l=void 0,s=0;s<o.length;s++)l=\"api/assets/\"+o[s].split(\"``\")[1],r.push(l);e.followList[a].imgs=r}if(e.followList[a].buttons){var n=e.followList[a].buttons.split(\",\");e.followList[a].buttonDetail=[];for(var i=0;i<n.length;i++){var c={};c.buttonsZt=n[i].split(\"``\")[3],c.buttonsdetail=n[i].split(\"``\")[2],c.buttonText=n[i].split(\"``\")[1],e.followList[a].buttonDetail.push(c)}}if(e.followList[a].evaluatecontents){var d=e.followList[a].evaluatecontents.split(\",\");e.followList[a].evaluateNum=d.length,e.followList[a].chat=[];for(var m=0;m<d.length;m++){var p={};p.content=d[m].split(\"``\")[3],p.date=d[m].split(\"``\")[2],p.name=d[m].split(\"``\")[1],e.followList[a].chat.push(p)}}else e.followList[a].evaluateNum=0,e.followList[a].chat=[]}e.spinShow=!1,e.footer=!0})},open_evaluate:function(t,e){this.currentIndex==e?this.currentIndex=-1:this.currentIndex=e},send:function(t,e,a){var r=this,l={bussinessid:t,evaluatecontent:r.pinglun[e],serviceranks:a};this.$Post(\"api/customer/addErevaluate\",l,function(t){var a={content:r.pinglun[e],date:Object(o.d)(new Date),name:localStorage.getItem(\"realname\")},l=r.followList[e].chat,s=l.unshift(a);r.$set(r.followList[e],\"evaluateNum\",s),r.$set(r.followList[e],\"chat\",l),r.currentIndex=-1,r.currentIndex=e,r.pinglun[e]=\"\"},function(t){})},open_detail:function(t){this.$bus.emit(\"SHOW_OPEN_CUSTOMER_FOLLOW_FIELD\",t)}},created:function(){var t=this;this.currentName=localStorage.getItem(\"realname\"),this.get_data_center().then(function(){t.get_data(t.customer.ID)})}},R=(a(354),Object(s.a)(E,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Row\",{staticStyle:{height:\"56px\"}},[a(\"Row\",[a(\"Checkbox\",{staticStyle:{float:\"right\"},on:{\"on-change\":function(e){t.get_data(t.customer.ID)}},model:{value:t.single,callback:function(e){t.single=e},expression:\"single\"}},[t._v(\"只看市场跟进\")])],1)],1),t._v(\" \"),a(\"Scroll\",{attrs:{height:\"500\"}},[t.spinShow?a(\"Spin\",{attrs:{fix:\"\"}},[a(\"Icon\",{staticClass:\"demo-spin-icon-load\",attrs:{type:\"load-c\",size:\"18\"}}),t._v(\" \"),a(\"div\",[t._v(\"加载跟进记录中...\")])],1):t._e(),t._v(\" \"),a(\"Timeline\",{staticStyle:{\"margin-top\":\"5px\",\"margin-right\":\"10px\"}},[a(\"div\",{staticClass:\"content\"},[t._l(t.followList,function(e,r){return a(\"TimelineItem\",{key:r,attrs:{color:\"blue\"}},[\"11\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"ios-telephone\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"12\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"ios-chatbubble\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"13\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"chatbubbles\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"14\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"android-contacts\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"15\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"gear-b\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"16\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"android-hangout\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"17\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"social-buffer\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"18\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"social-bitcoin\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"19\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"ios-lightbulb\"},slot:\"dot\"}):t._e(),t._v(\" \"),\"20\"==e.followType?a(\"Icon\",{attrs:{slot:\"dot\",type:\"android-wifi\"},slot:\"dot\"}):t._e(),t._v(\" \"),a(\"Card\",[a(\"Row\",[a(\"Col\",{attrs:{span:\"2\"}},[a(\"Avatar\",{attrs:{icon:\"person\"}})],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"2\"}},[a(\"B\",{staticStyle:{\"line-height\":\"32px\"}},[t._v(t._s(e.userName))])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"5\"}},[a(\"P\",{staticStyle:{\"line-height\":\"32px\"}},[t._v(\"跟进类型： \"),a(\"span\",[t._v(t._s(e.followTypeName))])])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"15\"}},[a(\"P\",{staticStyle:{\"line-height\":\"32px\",\"text-align\":\"right\"}},[t._v(t._s(e.createDate))])],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"5px\",\"margin-bottom\":\"5px\"}},[a(\"Col\",{attrs:{span:\"20\"}},[a(\"P\",[t._v(t._s(e.serviceContent))])],1),t._v(\" \"),\"22\"==e.followType?a(\"Col\",{attrs:{span:\"4\"}},[a(\"Button\",{staticStyle:{float:\"right\"},attrs:{type:\"primary\"},on:{click:function(a){t.open_detail(e.id)}}},[t._v(\"查看详情\")])],1):t._e()],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:12}},t._l(e.imgs,function(r,o){return e.imgs?a(\"Col\",{key:o,staticStyle:{\"max-width\":\"200px\"},attrs:{span:\"8\"}},[a(\"a\",{attrs:{target:\"_blank\",href:r}},[a(\"img\",{attrs:{src:r,alt:\"图片丢失\",width:\"95%\"}})])]):t._e()}),1),t._v(\" \"),\"11\"==e.followType||\"12\"==e.followType||\"13\"==e.followType?a(\"Div\",[a(\"Row\",[a(\"Col\",{attrs:{span:\"18\"}},[a(\"Button\",{attrs:{type:\"ghost\"},on:{click:function(a){t.open_evaluate(e.serviceId,r)}}},[t._v(\"评价（\"+t._s(e.evaluateNum)+\"）\")])],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"6\"}},[a(\"Rate\",{staticStyle:{float:\"right\"},attrs:{\"allow-half\":\"\"},model:{value:e.ranks,callback:function(a){t.$set(e,\"ranks\",a)},expression:\"item.ranks\"}})],1)],1),t._v(\" \"),t.currentIndex==r?a(\"Div\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Row\",[a(\"Col\",{attrs:{span:\"22\"}},[a(\"Input\",{key:r,staticStyle:{width:\"99%\"},attrs:{type:\"textarea\",autosize:!0,placeholder:\"请输入您要评价的内容\",disabled:\"\"},model:{value:t.pinglun[r],callback:function(e){t.$set(t.pinglun,r,e)},expression:\"pinglun[index]\"}})],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"2\"}},[a(\"Button\",{staticStyle:{float:\"right\"},attrs:{type:\"primary\"},on:{click:function(a){t.send(e.bussinessId,r,e.ranks)}}},[t._v(\"评价\")])],1)],1),t._v(\" \"),a(\"Div\",[a(\"Row\",{staticStyle:{\"margin-top\":\"5px\"}},t._l(e.chat,function(e,o){return t.currentIndex==r?a(\"Div\",{key:o,staticClass:\"bubbleItem\",staticStyle:{\"font-size\":\"10px\"}},[a(\"Span\",{staticClass:\"bubble\",class:[e.name==t.currentName?\"leftBubble\":\"rightBubble\"]},[a(\"span\",[t._v(t._s(e.name))]),t._v(\" \"),a(\"span\",{staticStyle:{float:\"right\"}},[t._v(t._s(e.date))]),a(\"br\"),t._v(\" \"),a(\"span\",[t._v(t._s(e.content))]),t._v(\" \"),a(\"span\",{staticClass:\"bottomLevel\"}),t._v(\" \"),a(\"span\",{staticClass:\"topLevel\"})])],1):t._e()}),1)],1)],1):t._e()],1):t._e(),t._v(\" \"),e.buttonDetail?a(\"Row\",[a(\"div\",{staticStyle:{float:\"right\"}},t._l(e.buttonDetail,function(e,r){return a(\"Button\",{key:r,staticStyle:{\"margin-left\":\"5px\"},attrs:{type:\"primary\",shape:\"circle\",disabled:\"\"}},[t._v(\"\\n                                    \"+t._s(e.buttonText)+\"\\n                                \")])}),1)]):t._e()],1)],1)}),t._v(\" \"),a(\"div\",[t.footer?a(\"center\",{staticStyle:{\"padding-bottom\":\"30px\"}},[t._v(\"没有更多数据了！\")]):t._e()],1)],2)])],1),t._v(\" \"),a(\"follow-field\")],1)},[],!1,null,null,null));R.options.__file=\"index.vue\";var N=R.exports,A={props:{payDirs:{type:Array}},data:function(){return{openOrderDetail:!1,formValidateDetail:{CompanyName:\"\",name:\"\",payTime:\"\",paynumber:\"\",realnumber:\"\",paydir:\"\",gdsreport:\"\"},orderItem:[],orderItemHeader:[{title:\"序号\",type:\"index\",minWidth:60,align:\"center\"},{title:\"产品名\",key:\"product\",minWidth:150},{title:\"产品属性\",key:\"propertys\",minWidth:250,render:function(t,e){return t(\"div\",{domProps:{innerHTML:e.row.propertys}})}},{title:\"产品价格\",key:\"oaprice\",minWidth:100},{title:\"产品数量（个/月）\",key:\"productnumber\",minWidth:150},{title:\"销售价格\",key:\"paynumber\",minWidth:100},{title:\"赠送数量\",key:\"givethenumber\",minWidth:100},{title:\"服务开始税期\",key:\"servicestartdate\",minWidth:120},{title:\"服务部门\",key:\"departname\",minWidth:140},{title:\"单价/月\",key:\"unitprice\",minWidth:90},{title:\"备注\",key:\"memo\",minWidth:300,render:function(t,e){var a=new RegExp(\"</br>\",\"g\");return t(\"div\",[t(\"Input\",{props:{value:e.row.memo.replace(a,\"\\n\"),autosize:!0,type:\"textarea\",size:\"small\",readonly:!0},style:{width:\"100%\"}})])}}]}},methods:{get_data:function(t){var e=this,a=\"api/order/detail/\"+t;this.$Get(a,{},function(t){e.formValidateDetail=t.data.data,e.orderItem=e.formValidateDetail.items;for(var a=0;a<e.orderItem.length;a++)if(\"会计到家\"==e.orderItem[a].product){e.kjdj=!0;break}})}},created:function(){var t=this;this.$bus.on(\"SHOW_CUSTOMER_ORDER_DETAIL\",function(e){t.get_data(e.id),t.openOrderDetail=!0})}},z=(a(356),Object(s.a)(A,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"查看\",width:\"100%\"},model:{value:t.openOrderDetail,callback:function(e){t.openOrderDetail=e},expression:\"openOrderDetail\"}},[a(\"Form\",{ref:\"formValidateDetail\",attrs:{model:t.formValidateDetail,\"label-width\":100}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属公司\",prop:\"CompanyName\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidateDetail.CompanyName,callback:function(e){t.$set(t.formValidateDetail,\"CompanyName\",e)},expression:\"formValidateDetail.CompanyName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属客户\",prop:\"name\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidateDetail.name,callback:function(e){t.$set(t.formValidateDetail,\"name\",e)},expression:\"formValidateDetail.name\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"缴费时间\",prop:\"payTime\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidateDetail.payTime,callback:function(e){t.$set(t.formValidateDetail,\"payTime\",e)},expression:\"formValidateDetail.payTime\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"订单总价\",prop:\"paynumber\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidateDetail.paynumber,callback:function(e){t.$set(t.formValidateDetail,\"paynumber\",e)},expression:\"formValidateDetail.paynumber\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"已付款\",prop:\"realnumber\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},model:{value:t.formValidateDetail.realnumber,callback:function(e){t.$set(t.formValidateDetail,\"realnumber\",e)},expression:\"formValidateDetail.realnumber\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"缴费渠道\",prop:\"payDir\"}},[a(\"Select\",{attrs:{transfer:\"\",disabled:\"\",size:\"small\"},model:{value:t.formValidateDetail.paydir,callback:function(e){t.$set(t.formValidateDetail,\"paydir\",e)},expression:\"formValidateDetail.paydir\"}},t._l(t.payDirs,function(e,r){return a(\"Option\",{key:r,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"国地税报道\",prop:\"GDSreport\"}},[a(\"Select\",{attrs:{transfer:\"\",disabled:\"\",size:\"small\"},model:{value:t.formValidateDetail.gdsreport,callback:function(e){t.$set(t.formValidateDetail,\"gdsreport\",e)},expression:\"formValidateDetail.gdsreport\"}},[a(\"Option\",{attrs:{value:\"ybd\"}},[t._v(\"已报道\")]),t._v(\" \"),a(\"Option\",{attrs:{value:\"wbd\"}},[t._v(\"未报道\")]),t._v(\" \"),a(\"Option\",{attrs:{value:\"bybd\"}},[t._v(\"不用报道\")])],1)],1)],1)],1),t._v(\" \"),a(\"Table\",{attrs:{id:\"show-order-item\",border:\"\",columns:t.orderItemHeader,data:t.orderItem,size:\"small\"}})],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null));function P(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}z.options.__file=\"orderDetail.vue\";var F={components:{orderDetail:z.exports},props:{customer:{type:[Array,Object,String]},cluesources:{type:Array}},data:function(){var t=this;return{loading:!1,header:[{title:\"订单号码\",key:\"ordercode\",minWidth:140},{title:\"公司名称\",key:\"companyname\",minWidth:300},{title:\"产品名称\",key:\"productname\",minWidth:180,render:function(t,e){return\"\"==e.row.productname||null==e.row.productname?\"\":e.row.productname.length>10?t(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[t(\"span\",e.row.productname.slice(0,10)+\"...\"),t(\"Icon\",{props:{type:\"arrow-down-b\"}}),t(\"div\",{slot:\"content\"},[t(\"span\",e.row.productname)])]):t(\"span\",e.row.productname)}},{title:\"流程状态\",key:\"ProcessType\",minWidth:120},{title:\"缴费渠道\",key:\"base_paydir\",minWidth:140},{title:\"订单价格\",key:\"paynumber\",minWidth:120},{title:\"已付款\",key:\"realnumber\",minWidth:100},{title:\"创建时间\",key:\"base_createdate\",minWidth:120},{title:\"缴费日期\",key:\"payTime\",minWidth:120},{title:\"上传合同\",key:\"contract_flag\",minWidth:120},{title:\"操作\",key:\"action\",fixed:\"right\",minWidth:120,render:function(e,a){var r=t;if(a.index!=t.pageSize)return e(\"div\",[e(\"Button\",{props:{type:\"warning\",size:\"small\"},directives:[{name:\"permission\",value:\"orderL.record\"}],on:{click:function(){r.$bus.emit(\"ORDER_APPROVELIST_LOG\",a.row.id)}}},\"审批记录\")])}}],data:[],total:0,page:1,pageSize:10,payDirs:[],payDirs_map:new Map,order_contract_flag:[],order_contract_flag_map:new Map,selectRow:\"\"}},methods:{get_data:function(t){var e,a=this;a.loading=!0;var r={params:(e={sortField:a.sortField,order:a.order,page:a.page,pageSize:a.pageSize,customerId:a.customer.ID},P(e,\"sortField\",\"id\"),P(e,\"order\",\"desc\"),e)};this.$Get(\"api/order/list\",r,function(t){a.data=t.data.data.rows,a.total=t.data.data.total;for(var e=0;e<a.data.length;e++)a.data[e].base_paydir=a.payDirs_map.get(a.data[e].base_paydir),a.data[e].contract_flag=a.order_contract_flag_map.get(a.data[e].contract_flag),a.data[e].base_createdate&&(a.data[e].base_createdate=a.data[e].base_createdate.slice(0,10));a.loading=!1})},pageChange:function(t){this.page=t,this.get_data()},rowClassName:function(t,e){if(\"调整订单\"==t.ProcessType&&t.id!=this.selectRow.id)return\"demo-table-error-row\"},get_data_center:function(){var t=this,e=this;return new Promise(function(a,r){t.$GetDataCenter(\"payDirs,order_contract_flag\",function(t){e.payDirs=t.data.data.payDirs,e.order_contract_flag=t.data.data.order_contract_flag,e.payDirs_map=e.$array2map(e.payDirs),e.order_contract_flag_map=e.$array2map(e.order_contract_flag),a()})})},select_row:function(t){t.id?this.selectRow=t:this.selectRow=\"\"},open_show_order:function(){this.selectRow?this.$bus.emit(\"SHOW_CUSTOMER_ORDER_DETAIL\",this.selectRow):this.$Message.warning(\"请选择需要查看的订单！\")},db_click:function(t){this.$bus.emit(\"SHOW_CUSTOMER_ORDER_DETAIL\",t)}},created:function(){var t=this;this.get_data_center().then(function(){t.get_data(t.customer.ID)})}},L=(a(358),Object(s.a)(F,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Button\",{attrs:{name:\"marketingManagement_index_orderlist_check\",type:\"primary\",shape:\"circle\",icon:\"ios-search-strong\"},on:{click:t.open_show_order}},[t._v(\"查看\")]),t._v(\" \"),a(\"Table\",{staticStyle:{\"margin-top\":\"15px\"},attrs:{border:\"\",\"highlight-row\":\"\",size:\"small\",loading:t.loading,\"row-class-name\":t.rowClassName,columns:t.header,data:t.data},on:{\"on-row-dblclick\":t.db_click,\"on-row-click\":t.select_row}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{current:t.page,size:\"small\",total:t.total,\"show-total\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(e){t.page=e},\"on-change\":t.pageChange}}),t._v(\" \"),a(\"order-detail\",{attrs:{payDirs:t.payDirs}})],1)},[],!1,null,null,null));L.options.__file=\"index.vue\";var W=L.exports,M={props:{customer:{type:[Array,Object,String]}},components:{},data:function(){return{header:[{type:\"index\",minWidth:60,align:\"center\"},{title:\"姓名\",key:\"name\",minWidth:100},{title:\"电话\",key:\"tel\",minWidth:150},{title:\"QQ\",key:\"qq\",minWidth:150},{title:\"微信\",key:\"wechat\",minWidth:150},{title:\"邮箱\",key:\"email\",minWidth:150},{title:\"职位\",key:\"jobplace\",minWidth:100},{title:\"发送信息\",key:\"isSend\",minWidth:100},{title:\"备注\",key:\"memo\",minWidth:100}],data:[],loading:!1}},methods:{get_data:function(t){var e=this,a=\"api/customer/findCustomerRelationById/\"+t.ID;e.loading=!0;this.$Get(a,{},function(t){e.data=t.data.data;for(var a=0;a<e.data.length;a++)1==e.data[a].sendmsgflag?e.data[a].isSend=\"是\":e.data[a].isSend=\"否\";e.loading=!1})}},created:function(){this.get_data(this.customer)}},j=Object(s.a)(M,function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",[e(\"Table\",{staticStyle:{\"margin-top\":\"15px\"},attrs:{size:\"small\",loading:this.loading,border:\"\",columns:this.header,data:this.data}})],1)},[],!1,null,null,null);j.options.__file=\"index.vue\";var G={components:{editForm:i,company:u,dymaic:T,follow:N,order:W,relation:j.exports},props:{cluesources:{type:Array},customerrating:{type:Array},area:{type:Array},sf_yn:{type:Array},importance:{type:Array},customerTypes_Casr:{type:Array},customer:{type:[Array,Object,String]}},data:function(){return{loading:!0,openPanel:[],openEdit:!0}},methods:{close:function(){this.$emit(\"close-edit\",!0)},open:function(){}}},Y=Object(s.a)(G,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"客户详情\",width:\"100\",styles:{height:\"100%\",top:\"0px\",minWidth:\"900px\"}},on:{\"on-cancel\":t.close},model:{value:t.openEdit,callback:function(e){t.openEdit=e},expression:\"openEdit\"}},[a(\"div\",{attrs:{slot:\"close\"},slot:\"close\"},[a(\"Icon\",{staticStyle:{\"font-size\":\"20px\",\"padding-top\":\"10px\"},attrs:{type:\"close\"},on:{click:t.close}})],1),t._v(\" \"),t.loading?a(\"Spin\",{attrs:{fix:\"\"}}):t._e(),t._v(\" \"),a(\"Row\",{staticStyle:{overflow:\"hidden\",\"*zoom\":\"1\"}},[a(\"Card\",{staticStyle:{width:\"300px\",float:\"left\"},attrs:{title:\"信息编辑\"}},[a(\"edit-form\",{attrs:{customer:t.customer,cluesources:t.cluesources,customerrating:t.customerrating,area:t.area,sf_yn:t.sf_yn,importance:t.importance,customerTypes_Casr:t.customerTypes_Casr},on:{\"cancel-loading\":function(e){t.loading=!1}}})],1),t._v(\" \"),a(\"Card\",{staticStyle:{\"margin-left\":\"310px\",\"min-width\":\"590px\"}},[a(\"Collapse\",{attrs:{accordion:\"\"},model:{value:t.openPanel,callback:function(e){t.openPanel=e},expression:\"openPanel\"}},[a(\"Panel\",{attrs:{name:\"company\"}},[t._v(\"\\n                        企业信息\\n                        \"),a(\"p\",{attrs:{slot:\"content\"},slot:\"content\"},[\"company\"==t.openPanel[0]?a(\"company\",{attrs:{customer:t.customer,importance:t.importance,cluesources:t.cluesources}}):t._e()],1)]),t._v(\" \"),a(\"Panel\",{attrs:{name:\"followUp\"}},[t._v(\"\\n                        客户跟进记录\\n                        \"),a(\"p\",{attrs:{slot:\"content\"},slot:\"content\"},[\"followUp\"==t.openPanel[0]?a(\"follow\",{attrs:{customer:t.customer}}):t._e()],1)]),t._v(\" \"),a(\"Panel\",{attrs:{name:\"order\"}},[t._v(\"\\n                        订单详情\\n                        \"),a(\"p\",{attrs:{slot:\"content\"},slot:\"content\"},[\"order\"==t.openPanel[0]?a(\"order\",{attrs:{customer:t.customer,cluesources:t.cluesources}}):t._e()],1)]),t._v(\" \"),a(\"Panel\",{attrs:{name:\"relation\"}},[t._v(\"\\n                        客户关系人\\n                        \"),a(\"p\",{attrs:{slot:\"content\"},slot:\"content\"},[\"relation\"==t.openPanel[0]?a(\"relation\",{attrs:{customer:t.customer}}):t._e()],1)]),t._v(\" \"),a(\"Panel\",{attrs:{name:\"dymaic\"}},[t._v(\"\\n                        服务动态\\n                        \"),a(\"p\",{attrs:{slot:\"content\"},slot:\"content\"},[\"dymaic\"==t.openPanel[0]?a(\"dymaic\",{attrs:{customer:t.customer}}):t._e()],1)])],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);Y.options.__file=\"index.vue\";var B=Y.exports,U={name:\"cluesLibrary_index\",data:function(){var t=this;return{openClueModal:!1,tableColumnsN:[{title:\"客户名称\",key:\"customer_name\",minWidth:130},{title:\"客户电话\",key:\"customer_tel\",minWidth:130},{title:\"线索详情\",key:\"clue_memo\",minWidth:300,render:function(t,e){return t(\"div\",{domProps:{innerHTML:e.row.clue_memo}})}},{title:\"线索创建时间\",key:\"createdate\",minWidth:160},{title:\"操作\",align:\"center\",key:\"action\",fixed:\"right\",minWidth:90,render:function(e,a){return e(\"div\",[e(\"Button\",{props:{type:\"warning\",size:\"small\",permission:\"['cluesLibraryM.y.cheek']\"},style:{marginRight:\"2px\"},on:{click:function(){t.lingq(a)}}},\"领取\")])}}],tableColumnsY:[{title:\"客户名称\",key:\"customer_name\",minWidth:130},{title:\"客户电话\",key:\"customer_tel\",minWidth:130},{title:\"线索详情\",key:\"clue_memo\",minWidth:300,render:function(t,e){return t(\"div\",{domProps:{innerHTML:e.row.clue_memo}})}},{title:\"线索创建时间\",key:\"createdate\",minWidth:160},{title:\"领取人\",key:\"rrealname\",minWidth:100}],tableDataN:[],pageTotalN:0,tableDataY:[],pageTotalY:0,pageN:1,pageY:1,cluetype:[],clue_level:[],clue_level_map:new Map,cluetype_map:new Map,customerId:\"\"}},methods:{get_data_center:function(){this.$GetDataCenter(\"cluetype,clue_level\",function(t){var e=t.data.data;_self.cluetype=e.cluetype,_self.clue_level=e.clue_level,_self.clue_level_map=_self.$array2map(_self.clue_level),_self.cluetype_map=_self.$array2map(_self.cluetype)})},getTableDataN:function(){var t=this,e={params:{receipt:\"N\",sortField:\"clue_level\",order:\"asc\",page:t.pageN,pageSize:10,customerId:t.customerId}};this.$Get(\"api/clue/list\",e,function(e){t.pageTotalN=e.data.data.total,t.tableDataN=e.data.data.rows;for(var a=0;a<t.tableDataN.length;a++)t.tableDataN[a].clue_level=t.clue_level_map.get(t.tableDataN[a].clue_level)})},getTableDataY:function(){var t=this,e={params:{receipt:\"Y\",sortField:\"clue_level\",order:\"asc\",page:t.pageY,pageSize:10,customerId:t.customerId}};this.$Get(\"api/clue/list\",e,function(e){t.pageTotalY=e.data.data.total,t.tableDataY=e.data.data.rows;for(var a=0;a<t.tableDataY.length;a++)t.tableDataY[a].clue_level=t.clue_level_map.get(t.tableDataY[a].clue_level)})},pageChangeN:function(t){this.pageN=t,this.getTableDataN()},pageChangeY:function(t){this.pageY=t,this.getTableDataY()},lingq:function(t){var e=this,a={id:t.row.id};this.$Post(\"api/clue/receiptClue\",a,function(t){e.getTableDataN(),e.getTableDataY()},function(t){})}},created:function(){var t=this;t.$bus.off(\"SHOW_OPEN_CUSTOMER_CLUE_LOG\",!0),t.$bus.on(\"SHOW_OPEN_CUSTOMER_CLUE_LOG\",function(e){t.customerId=e.ID,t.getTableDataN(),t.getTableDataY(),t.openClueModal=!0})}},H=(a(360),Object(s.a)(U,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"Modal\",{attrs:{width:\"1000\",title:\"线索\"},model:{value:t.openClueModal,callback:function(e){t.openClueModal=e},expression:\"openClueModal\"}},[a(\"Tabs\",{attrs:{value:\"name1\"}},[a(\"TabPane\",{attrs:{label:\"未领取\",name:\"name1\"}},[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}}),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:t.tableColumnsN,data:t.tableDataN}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:t.pageTotalN,\"show-total\":\"\",\"show-elevator\":\"\",current:t.pageN},on:{\"update:current\":function(e){t.pageN=e},\"on-change\":t.pageChangeN}})],1)],1)],1),t._v(\" \"),a(\"TabPane\",{attrs:{label:\"已领取\",name:\"name2\"}},[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}}),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:t.tableColumnsY,data:t.tableDataY}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:t.pageTotalY,current:t.pageY,\"show-total\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(e){t.pageY=e},\"on-change\":t.pageChangeY}})],1)],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)},[],!1,null,null,null));H.options.__file=\"clue.vue\";var q={name:\"publicPool_index\",mixins:[r],components:{clueLog:H.exports,editCustomer:B},data:function(){var t=this;return{openImportCustomer:!1,openEdit:!1,search_model:\"\",header:[{title:\"姓名\",key:\"NAME\",sortable:\"custom\",width:120},{title:\"归属公司\",key:\"companynames\",width:210,render:function(t,e){if(\"\"==e.row.companynames||null==e.row.companynames)return\"\";var a=e.row.companynames.split(\",\");return a[0].length>13?t(\"Poptip\",{props:{trigger:\"hover\",title:\"归属公司\",placement:\"bottom\"}},[t(\"span\",a[0].slice(0,13)+\"...\"),t(\"Icon\",{props:{type:\"arrow-down-b\"}}),t(\"div\",{slot:\"content\"},[t(\"ul\",a.map(function(e){return[t(\"li\",{style:{padding:\"4px\"}},\"公司名：\"+e)]}))])]):t(\"Poptip\",{props:{trigger:\"hover\",title:\"归属公司\",placement:\"bottom\"}},[t(\"span\",a[0]),t(\"Icon\",{props:{type:\"arrow-down-b\"}}),t(\"div\",{slot:\"content\"},[t(\"ul\",a.map(function(e){return[t(\"li\",{style:{padding:\"4px\"}},\"公司名：\"+e)]}))])])}},{title:\"电话\",key:\"TEL\",width:120},{title:\"客户状态\",key:\"customerType\",width:140,sortable:\"custom\"},{title:\"客户来源\",key:\"customersource\",width:120,sortable:\"custom\"},{title:\"客户等级\",key:\"importlevel\",width:120,sortable:\"custom\"},{title:\"客户重要性\",key:\"importance\",width:120},{title:\"区域\",key:\"AREA\",width:80,sortable:\"custom\"},{title:\"渠道名称\",key:\"channelTypeName\",width:140,sortable:\"custom\"},{title:\"跟进人\",key:\"followbyname\",width:120,sortable:\"custom\"},{title:\"创建时间\",key:\"CREATEDATE\",width:120,sortable:\"custom\"},{title:\"线索权重\",key:\"clue_ranks\",minWidth:120,sortable:\"custom\"},{title:\"回滚时间\",key:\"updatedate\",width:120,sortable:\"custom\"},{title:\"成交总额\",key:\"total_money\",width:120,sortable:\"custom\"},{title:\"最后成交时间\",key:\"lately_order_time\",width:150,sortable:\"custom\"},{title:\"操作\",key:\"action\",fixed:\"right\",width:90,align:\"center\",render:function(e,a){return e(\"Button\",{props:{type:\"primary\",size:\"small\"},on:{click:function(){t.receipt(a.row.ID)}}},\"[ 领取 ]\")}}],data:[],page:1,pageSize:10,total:0,tableLoading:!0,formValidate:{name:\"\",tel:\"\",companyname:\"\",followbyname:\"\",customerType:[],area:\"\",customersource:\"\",channelTypeName:\"\",isbound:\"\",credate:[],upddate:[],labelName:\"\",importlevel:\"\",begin_residue_time:\"\",end_residue_time:\"\",importance:\"\",order:\"desc\",sortField:\"clue_ranks\"},createCustomerStatus:!1,sortName:\"clue_ranks\",order:\"desc\"}},methods:{open:function(){window.open(\"/api/assets/upload/commonImg/public_pool_template.xlsx\")},download_excel:function(){this.$ButtonCollect(\"marketingManagement_index_edit_excel\");var t={deleteflag:\"3\",page:\"1\",pageSize:\"1000000\",name:this.formValidate.name,tel:this.formValidate.tel,customerType:this.formValidate.customerType.join(\"-\"),channelTypeName:this.formValidate.channelTypeName,followbyname:this.formValidate.followbyname,isbound:this.formValidate.isbound,customersource:this.formValidate.customersource,area:this.formValidate.area,companyname:this.formValidate.companyname,labelName:this.formValidate.labelName,importlevel:this.formValidate.importlevel,importance:this.formValidate.importance,bcreatedate:Object(o.a)(this.formValidate.credate[0]),ecreatedate:Object(o.a)(this.formValidate.credate[1]),bupdatedate:Object(o.a)(this.formValidate.upddate[0]),eupdatedate:Object(o.a)(this.formValidate.upddate[1]),export:\"Y\",exportField:encodeURI(JSON.stringify([{field:\"NAME\",title:\"姓名\"},{field:\"companynames\",title:\"公司\"},{field:\"customerType\",title:\"客户状态\",format:\"customerTypes\"},{field:\"customersource\",title:\"客户来源\",format:\"cluesources\"},{field:\"importlevel\",title:\"客户等级\",format:\"importlevel\"},{field:\"AREA\",title:\"地区\",format:\"area\"},{field:\"channelTypeName\",title:\"渠道名称\"},{field:\"followbyname\",title:\"跟进人\"},{field:\"CREATEDATE\",title:\"创建时间\"},{field:\"updatedate\",title:\"更新时间\"},{field:\"isbound\",title:\"微信绑定\",format:\"sf_yn\"},{field:\"lastfollowdate\",title:\"市场最后跟进时间\"},{field:\"importance\",title:\"客户重要性\",format:\"importance\"}]))},e=this.$MergeURL(\"api/customer/list\",t);window.open(e)},sort:function(t){\"normal\"==t.order?(this.order=\"\",this.sortName=\"updatedate\"):(this.sortName=t.key,this.order=t.order),this.get_data()},search:function(){this.page=1,this.get_data()},handleReset:function(){this.page=1,this.$refs.formValidate.resetFields(),this.formValidate.credate=[],this.formValidate.upddate=[],this.formValidate.end_residue_time=\"\",this.formValidate.customerType=[],this.get_data()},get_data:function(){var t=this;this.selectRow=\"\",t.tableLoading=!0;var e={params:{deleteflag:\"3\",order:t.order,page:t.page,pageSize:t.pageSize,sortField:t.sortName,name:t.formValidate.name,tel:t.formValidate.tel,customerType:t.formValidate.customerType.join(\"-\"),channelTypeName:t.formValidate.channelTypeName,followbyname:t.formValidate.followbyname,isbound:t.formValidate.isbound,customersource:t.formValidate.customersource,area:t.formValidate.area,labelName:t.formValidate.labelName,importlevel:t.formValidate.importlevel,companyName:t.formValidate.companyname,importance:t.formValidate.importance,bcreatedate:Object(o.a)(t.formValidate.credate[0]),ecreatedate:Object(o.a)(t.formValidate.credate[1]),bupdatedate:Object(o.a)(t.formValidate.upddate[0]),eupdatedate:Object(o.a)(t.formValidate.upddate[1]),begin_residue_time:t.formValidate.begin_residue_time,end_residue_time:t.formValidate.end_residue_time}};this.$Get(\"api/customer/list\",e,function(e){t.data=e.data.data.rows,t.total=e.data.data.total;for(var a=0;a<t.data.length;a++)t.data[a].customerType=t.findCustomerType(t.data[a].customerType),t.data[a].importlevel&&(t.data[a].importlevel=t.customerrating_map.get(t.data[a].importlevel.toString())),t.data[a].AREA=t.area_map.get(t.data[a].AREA),t.data[a].customersourceCode=t.data[a].customersource,t.data[a].customersource=t.cluesources_map.get(t.data[a].customersource),t.data[a].importance=t.importance_map.get(t.data[a].importance),t.data[a].isbound=t.sf_yn_map.get(t.data[a].isbound),t.data[a].CREATEDATE&&(t.data[a].CREATEDATE=t.data[a].CREATEDATE.slice(0,10)),t.data[a].updatedate&&(t.data[a].updatedate=t.data[a].updatedate.slice(0,10));t.tableLoading=!1})},page_change:function(t){this.page=t,this.get_data()},page_size_change:function(t){this.pageSize=t,this.page=1,this.get_data()},select_row:function(t){this.selectRow=t},open_edit:function(){this.selectRow?this.$store.commit(\"open_gobal_customer_detail_modal\",this.selectRow):this.$Message.warning(\"请选择一行!\")},findCustomerType:function(t){if(\"\"==t||null==t)return\"\";for(var e=t.split(\"-\"),a=0;a<this.customerTypes_array.length;a++)if(this.customerTypes_array[a].id==e[1]&&\"\"!=e[1])return this.customerTypes_array[a].ptypename+\" - \"+this.customerTypes_array[a].typename},close_edit:function(){this.openEdit=!1},receipt:function(t){var e=this,a={customerId:t};this.$Post(\"api/customer/receipt\",a,function(t){e.get_data()},function(t){})},import_excel:function(){this.openImportCustomer=!0},handleUpload:function(t){var e=this,a=new FormData;return a.append(\"file\",t),this.$Post(\"api/customer/importHighSeasPoolMessage\",a,function(t){return e.get_data(),e.openImportCustomer=!1,!1},function(t){return!1}),!1}},created:function(){var t=this;this.get_data_center().then(function(){t.get_data()}).catch(function(){t.get_data(),t.$Message.error(\"属性转换失败！\")})}},Q=(a(362),Object(s.a)(q,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:t.search_model,callback:function(e){t.search_model=e},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),t._v(\"\\n                    筛选\\n                    \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.search(e):null}},slot:\"content\"},[a(\"Form\",{ref:\"formValidate\",staticStyle:{\"margin-top\":\"15px\"},attrs:{model:t.formValidate,\"label-width\":120}},[a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"客户名称：\",prop:\"name\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:t.formValidate.name,callback:function(e){t.$set(t.formValidate,\"name\",e)},expression:\"formValidate.name\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"电话：\",prop:\"tel\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:t.formValidate.tel,callback:function(e){t.$set(t.formValidate,\"tel\",e)},expression:\"formValidate.tel\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属公司：\",prop:\"companyname\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:t.formValidate.companyname,callback:function(e){t.$set(t.formValidate,\"companyname\",e)},expression:\"formValidate.companyname\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:12}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"跟进人：\",prop:\"followbyname\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:t.formValidate.followbyname,callback:function(e){t.$set(t.formValidate,\"followbyname\",e)},expression:\"formValidate.followbyname\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"客户状态：\",prop:\"customerType\"}},[a(\"Cascader\",{staticStyle:{\"margin-top\":\"5px\",width:\"100%\"},attrs:{trigger:\"hover\",data:t.customerTypes_Casr,size:\"small\"},model:{value:t.formValidate.customerType,callback:function(e){t.$set(t.formValidate,\"customerType\",e)},expression:\"formValidate.customerType\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"区域：\",prop:\"area\"}},[a(\"Select\",{attrs:{transfer:\"\",size:\"small\"},on:{\"on-change\":t.search},model:{value:t.formValidate.area,callback:function(e){t.$set(t.formValidate,\"area\",e)},expression:\"formValidate.area\"}},t._l(t.area,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(\"\\n                                                \"+t._s(e.typename)+\"\\n                                            \")])}),1)],1)],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:12}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"客户来源：\",prop:\"customersource\"}},[a(\"Select\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",size:\"small\"},on:{\"on-change\":t.search},model:{value:t.formValidate.customersource,callback:function(e){t.$set(t.formValidate,\"customersource\",e)},expression:\"formValidate.customersource\"}},t._l(t.cluesources,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(\"\\n                                                \"+t._s(e.typename)+\"\\n                                            \")])}),1)],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"渠道名称：\",prop:\"channelTypeName\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:t.formValidate.channelTypeName,callback:function(e){t.$set(t.formValidate,\"channelTypeName\",e)},expression:\"formValidate.channelTypeName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"微信绑定：\",prop:\"isbound\"}},[a(\"Select\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",size:\"small\"},on:{\"on-change\":t.search},model:{value:t.formValidate.isbound,callback:function(e){t.$set(t.formValidate,\"isbound\",e)},expression:\"formValidate.isbound\"}},[a(\"Option\",{attrs:{value:\"Y\"}},[t._v(\"是\")]),t._v(\" \"),a(\"Option\",{attrs:{value:\"N\"}},[t._v(\"否\")])],1)],1)],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:12}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"创建时间：\",prop:\"credate\"}},[a(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{type:\"daterange\",transfer:\"\",placement:\"bottom-end\",size:\"small\"},model:{value:t.formValidate.credate,callback:function(e){t.$set(t.formValidate,\"credate\",e)},expression:\"formValidate.credate\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"回滚时间：\",prop:\"upddate\"}},[a(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{type:\"daterange\",transfer:\"\",placement:\"bottom-start\",size:\"small\"},model:{value:t.formValidate.upddate,callback:function(e){t.$set(t.formValidate,\"upddate\",e)},expression:\"formValidate.upddate\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"标签：\",prop:\"labelName\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:t.formValidate.labelName,callback:function(e){t.$set(t.formValidate,\"labelName\",e)},expression:\"formValidate.labelName\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:12}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"客户等级：\",prop:\"importlevel\"}},[a(\"Select\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",size:\"small\"},on:{\"on-change\":t.search},model:{value:t.formValidate.importlevel,callback:function(e){t.$set(t.formValidate,\"importlevel\",e)},expression:\"formValidate.importlevel\"}},[a(\"Option\",{attrs:{value:\"\"}}),t._v(\" \"),t._l(t.customerrating,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(\"\\n                                                \"+t._s(e.typename)+\"\\n                                            \")])})],2)],1)],1)],1),t._v(\" \"),a(\"center\",[a(\"FormItem\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Button\",{attrs:{type:\"primary\",name:\"marketingManagement_index_edit_search\"},on:{click:t.search}},[t._v(\"搜索\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\",name:\"marketingManagement_index_edit_reset\"},on:{click:t.handleReset}},[t._v(\"重置\")])],1)],1)],1)],1)],1)],1)],1),t._v(\" \"),a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"pool.import\"],expression:\"['pool.import']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:t.import_excel}},[t._v(\"导入\")]),t._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"marketingM.edit\"],expression:\"['marketingM.edit']\"}],attrs:{type:\"primary\",name:\"marketingManagement_index_edit_edit\",icon:\"edit\"},on:{click:t.open_edit}},[t._v(\"查看\")]),t._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",name:\"marketingManagement_index_edit_excel\",icon:\"ios-download\"},on:{click:t.download_excel}},[t._v(\"导出Excel\")]),t._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",name:\"marketingManagement_index_field_log\",icon:\"android-share-alt\"},on:{click:function(e){t.check_select(\"SHOW_OPEN_CUSTOMER_CLUE_LOG\")}}},[t._v(\"客户线索\")])],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:t.header,data:t.data,loading:t.tableLoading},on:{\"on-current-change\":t.select_row,\"on-row-dblclick\":t.open_edit,\"on-sort-change\":t.sort}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:t.total,current:t.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(e){t.page=e},\"on-change\":t.page_change,\"on-page-size-change\":t.page_size_change}})],1)],1),t._v(\" \"),a(\"clue-log\"),t._v(\" \"),t.openEdit?a(\"edit-customer\",{attrs:{customer:t.selectRow,cluesources:t.cluesources,customerrating:t.customerrating,area:t.area,sf_yn:t.sf_yn,importance:t.importance,customerTypes_Casr:t.customerTypes_Casr},on:{\"close-edit\":t.close_edit}}):t._e(),t._v(\" \"),a(\"Modal\",{attrs:{title:\"导入客户\",width:\"200\"},model:{value:t.openImportCustomer,callback:function(e){t.openImportCustomer=e},expression:\"openImportCustomer\"}},[a(\"Row\",{attrs:{gutter:20}},[a(\"Col\",{attrs:{span:\"24\"}},[a(\"center\",[a(\"Upload\",{ref:\"upload\",attrs:{\"before-upload\":t.handleUpload,action:\"/api/customer/importHighSeasPoolMessage\"}},[a(\"Button\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{type:\"ghost\",icon:\"ios-cloud-upload-outline\"}},[t._v(\"选择文件\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{type:\"info\",icon:\"ios-cloud-download-outline\"},on:{click:t.open}},[t._v(\"导入模板\")])],1)],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null));Q.options.__file=\"customerManagment.vue\";var J=Q.exports;e.default=J}}]);"}