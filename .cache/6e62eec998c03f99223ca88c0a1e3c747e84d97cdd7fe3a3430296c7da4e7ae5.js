{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{438:function(t,e,a){},439:function(t,e,a){},460:function(t,e,a){},461:function(t,e,a){},462:function(t,e,a){},463:function(t,e,a){},464:function(t,e,a){},682:function(t,e,a){\"use strict\";var r=a(438);a.n(r).a},684:function(t,e,a){\"use strict\";var r=a(439);a.n(r).a},734:function(t,e,a){\"use strict\";var r=a(460);a.n(r).a},736:function(t,e,a){\"use strict\";var r=a(461);a.n(r).a},738:function(t,e,a){\"use strict\";var r=a(462);a.n(r).a},740:function(t,e,a){\"use strict\";var r=a(463);a.n(r).a},742:function(t,e,a){\"use strict\";var r=a(464);a.n(r).a},834:function(t,e,a){\"use strict\";a.r(e);a(432),a(404);var r=a(433),o=a.n(r),n=(a(436),a(437)),i=a.n(n),s=a(3),l=a.n(s);function p(t,r){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=[];return Array.from(t).forEach(function(t){void 0===t._expanded&&l.a.set(t,\"_expanded\",r);var e=1;if(null!=n&&(e=n+1),l.a.set(t,\"_level\",e),o&&l.a.set(t,\"parent\",o),i.push(t),t.children&&0<t.children.length){var a=p(t.children,r,t,e);i=i.concat(a)}}),i}var c={components:{elTable:i.a,elTableColumn:o.a},name:\"TreeTable\",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1},selection:{type:Boolean,default:!1}},computed:{formatData:function(){var t=void 0;t=Array.isArray(this.data)?this.data:[this.data];var e=this.evalFunc||p,a=this.evalArgs?Array.concat([t,this.expandAll],this.evalArgs):[t,this.expandAll];return e.apply(null,a)}},methods:{showRow:function(t){var e=!t.row.parent||t.row.parent._expanded&&t.row.parent._show;return(t.row._show=e)?\"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;\":\"display:none;\"},toggleExpanded:function(t){var e=this.formatData[t];e._expanded=!e._expanded},iconShow:function(t,e){return 0===t&&e.children&&0<e.children.length},handleSelectionChange:function(t,e){if(e.children)for(var a=0;a<e.children.length;a++)this.$refs.multipleTable.toggleRowSelection(e.children[a]),this.handleSelectionChange(\"\",e.children[a])},get_current_click:function(t){this.$emit(\"current-change\",t)},get_all_change:function(t){this.$emit(\"get-all-selection\",t)},edit:function(t){this.$emit(\"edit\",t)},del:function(t){this.$emit(\"delete\",t)},create:function(t){this.$emit(\"create\",t)}}},d=(a(736),a(738),a(4)),u=Object(d.a)(c,function(){var r=this,t=r.$createElement,o=r._self._c||t;return o(\"el-table\",r._b({ref:\"multipleTable\",attrs:{data:r.formatData,\"row-style\":r.showRow,size:\"small\"},on:{select:r.handleSelectionChange,\"selection-change\":r.get_all_change,\"current-change\":r.get_current_click}},\"el-table\",r.$attrs,!1),[o(\"el-table-column\",{attrs:{type:\"index\",label:\"序号\",width:\"60\"}}),r._v(\" \"),r.selection?o(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}):r._e(),r._v(\" \"),0===r.columns.length?o(\"el-table-column\",{attrs:{width:\"150\"},scopedSlots:r._u([{key:\"default\",fn:function(e){return[r._l(e.row._level,function(t){return o(\"span\",{key:t,staticClass:\"ms-tree-space\"})}),r._v(\" \"),r.iconShow(0,e.row)?o(\"span\",{staticClass:\"tree-ctrl\",on:{click:function(t){r.toggleExpanded(e.$index)}}},[e.row._expanded?o(\"i\",{staticClass:\"el-icon-minus\"}):o(\"i\",{staticClass:\"el-icon-plus\"})]):r._e(),r._v(\"\\n      \"+r._s(e.$index)+\"\\n    \")]}}])}):r._l(r.columns,function(t,a){return o(\"el-table-column\",{key:t.value,attrs:{label:t.text,width:t.width},scopedSlots:r._u([{key:\"default\",fn:function(e){return[r._l(e.row._level,function(t){return 0===a?o(\"span\",{key:t,staticClass:\"ms-tree-space\"}):r._e()}),r._v(\" \"),r.iconShow(a,e.row)?o(\"span\",{staticClass:\"tree-ctrl\",on:{click:function(t){r.toggleExpanded(e.$index)}}},[e.row._expanded?o(\"i\",{staticClass:\"el-icon-minus\"}):o(\"i\",{staticClass:\"el-icon-plus\"})]):r._e(),r._v(\"\\n      \"+r._s(e.row[t.value])+\"\\n    \")]}}])})}),r._v(\" \"),o(\"el-table-column\",{attrs:{label:\"操作\",width:\"200\"},scopedSlots:r._u([{key:\"default\",fn:function(e){return[o(\"Button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:function(t){r.create(e.row)}}},[r._v(\"新增下级属性\")]),r._v(\" \"),o(\"Button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:function(t){r.edit(e.row)}}},[r._v(\"编辑\")]),r._v(\" \"),o(\"Button\",{attrs:{type:\"error\",size:\"small\"},on:{click:function(t){r.del(e.row)}}},[r._v(\"删除\")])]}}])}),r._v(\" \"),r._t(\"default\")],2)},[],!1,null,\"b7b77026\",null);u.options.__file=\"index.vue\";var y=u.exports,m={props:{pid:{type:[Number,String],default:\"\"},pname:{type:[String],default:\"一级类型\"}},data:function(){return{show:!0,formValidate:{typename:\"\",sortid:\"\",pid:\"\"},ruleValidate:{typename:[{required:!0,message:\"必填项\",trigger:\"blur\"}],sortid:[{required:!0,message:\"必填项，任填一个数字\",trigger:\"blur\"}]},loading:!1}},methods:{close:function(){this.$emit(\"close\")},create_product_type:function(){var e=this;this.$refs.formValidate.validate(function(t){t&&e.submit()})},submit:function(){var e=this;this.loading=!0;var t={typename:e.formValidate.typename,sortid:e.formValidate.sortid,pid:e.pid};this.$Post(\"api/product/type/create\",t,function(t){e.loading=!1,e.close()},function(t){})}}},h=Object(d.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"创建产品类型\",width:\"600\"},on:{\"on-cancel\":e.close},model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[a(\"Form\",{ref:\"formValidate\",attrs:{model:e.formValidate,rules:e.ruleValidate,\"label-width\":80}},[a(\"FormItem\",{attrs:{label:\"类型名\",prop:\"typename\"}},[a(\"Input\",{model:{value:e.formValidate.typename,callback:function(t){e.$set(e.formValidate,\"typename\",t)},expression:\"formValidate.typename\"}})],1),e._v(\" \"),a(\"FormItem\",{attrs:{label:\"排序\",prop:\"sortid\"}},[a(\"Input\",{model:{value:e.formValidate.sortid,callback:function(t){e.$set(e.formValidate,\"sortid\",t)},expression:\"formValidate.sortid\"}})],1),e._v(\" \"),a(\"FormItem\",{attrs:{label:\"父节点名称\",prop:\"pname\"}},[a(\"Input\",{attrs:{value:e.pname,readonly:\"\"}})],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\",loading:e.loading},on:{click:e.create_product_type}},[e._v(\"新增\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"ghost\"},on:{click:e.close}},[e._v(\"关闭\")])],1)],1)],1)},[],!1,null,null,null);h.options.__file=\"create.vue\";var f=h.exports,_={props:{data:{type:[String,Object],default:function(){return{id:\"\",pId:\"\",typeName:\"\",sortId:\"\",parent:{typeName:\"\"}}}}},data:function(){return{show:!0,ruleValidate:{typename:[{required:!0,message:\"必填项\",trigger:\"blur\"}],sortid:[{required:!0,message:\"必填项，任填一个数字\",trigger:\"blur\"}]},loading:!1}},methods:{close:function(){this.$emit(\"close\")},create_product_type:function(){var e=this;this.$refs.data.validate(function(t){t&&e.submit()})},submit:function(){var e=this;this.loading=!0;var t={id:e.data.id,typename:e.data.typeName,sortid:e.data.sortId,pid:e.data.pId};this.$Post(\"api/product/type/update\",t,function(t){e.loading=!1,e.close()},function(t){})}}},v=Object(d.a)(_,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"编辑产品类型\",width:\"600\"},on:{\"on-cancel\":e.close},model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[a(\"Form\",{ref:\"data\",attrs:{model:e.data,rules:e.ruleValidate,\"label-width\":80}},[a(\"FormItem\",{attrs:{label:\"类型名\",prop:\"typeName\"}},[a(\"Input\",{model:{value:e.data.typeName,callback:function(t){e.$set(e.data,\"typeName\",t)},expression:\"data.typeName\"}})],1),e._v(\" \"),a(\"FormItem\",{attrs:{label:\"排序\",prop:\"sortId\"}},[a(\"Input\",{model:{value:e.data.sortId,callback:function(t){e.$set(e.data,\"sortId\",t)},expression:\"data.sortId\"}})],1),e._v(\" \"),e.data.parent?a(\"FormItem\",{attrs:{label:\"父节点名称\",prop:\"parent\"}},[a(\"Input\",{attrs:{value:e.data.parent.typeName,readonly:\"\"}})],1):e._e()],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\",loading:e.loading},on:{click:e.create_product_type}},[e._v(\"修改\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"ghost\"},on:{click:e.close}},[e._v(\"关闭\")])],1)],1)],1)},[],!1,null,null,null);v.options.__file=\"update.vue\";var g={name:\"productType_index\",components:{treeTable:y,createType:f,updateType:v.exports},data:function(){return{columns:[{text:\"类型名称\",value:\"typeName\",width:350},{text:\"类型排序\",value:\"typeLevel\",width:120}],data:[],openCreateType:!1,openUpdateType:!1,pname:\"\",pid:\"\",currentData:\"\",loading:!1}},methods:{get_data:function(){var e=this;e.loading=!0;this.$Get(\"api/product/type/tree\",{},function(t){e.data=t.data.data,e.loading=!1})},edit:function(t){this.currentData=t,this.openUpdateType=!0},delete_type:function(t){var e=this,a={id:t.id};this.$Post(\"api/product/type/del\",a,function(t){e.close()},function(t){e.close()})},create_type:function(t){this.pname=t.typeName,this.pid=t.id,this.openCreateType=!0},close:function(){var t=this;this.openCreateType=!1,this.openUpdateType=!1,setTimeout(function(){t.get_data()},300)}},mounted:function(){this.get_data()},computed:{}},b=Object(d.a)(g,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{gutter:20}},[a(\"Col\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:function(t){e.pid=\"\",e.pname=\"\",e.openCreateType=!0}}},[e._v(\"新增\")])],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:20}},[e.loading?a(\"Spin\",{staticStyle:{\"margin-left\":\"50%\",\"margin-top\":\"5%\"},attrs:{size:\"large\"}}):a(\"tree-table\",{attrs:{data:e.data,columns:e.columns,border:\"\",expandAll:\"\"},on:{edit:e.edit,delete:e.delete_type,create:e.create_type}})],1)],1),e._v(\" \"),e.openCreateType?a(\"create-type\",{attrs:{pname:e.pname,pid:e.pid},on:{close:e.close}}):e._e(),e._v(\" \"),e.openUpdateType?a(\"update-type\",{attrs:{data:e.currentData},on:{close:e.close}}):e._e()],1)},[],!1,null,null,null);b.options.__file=\"index.vue\";e.default=b.exports},842:function(t,e,a){\"use strict\";a.r(e);a(413),a(404);var r=a(414),o={components:{elTree:a.n(r).a},props:{productAttr:{type:[Object,String]}},watch:{productAttr:{handler:function(){this.get_data()},deep:!0}},data:function(){var r=this;return{defaultProps:{children:\"children\",label:\"typeName\"},sideLoading:!1,loading:!1,property:[{id:\"\",typeId:\"\",typeName:\"\",name:\"\"}],propertyV:[],header:[{title:\"序号\",type:\"index\",minWidth:80},{title:\"属性值\",key:\"propertyValue\",minWidth:120,render:function(t,e){var a=r;return t(\"div\",[t(\"Input\",{domProps:{},props:{value:r.propertyV[e.index].propertyValue,autosize:!0,type:\"text\",size:\"small\"},on:{\"on-blur\":function(t){a.propertyV[e.index].propertyValue=t.target.value},\"on-enter\":function(t){a.propertyV[e.index].propertyValue=t.target.value}},style:{width:\"100%\"}})])}},{title:\"属性编码\",key:\"propertyVCode\",minWidth:120,render:function(t,e){var a=r;return t(\"div\",[t(\"Input\",{domProps:{},props:{value:r.propertyV[e.index].propertyVCode,autosize:!0,type:\"text\",size:\"small\"},on:{\"on-blur\":function(t){a.propertyV[e.index].propertyVCode=t.target.value},\"on-enter\":function(t){a.propertyV[e.index].propertyVCode=t.target.value}},style:{width:\"100%\"}})])}},{title:\"操作\",key:\"action\",width:120,render:function(t,e){var a=r;return t(\"div\",[t(\"Button\",{props:{type:\"error\",size:\"small\",icon:\"trash-a\"},style:{marginLeft:\"5px\"},on:{click:function(){a.propertyV.splice(e.index,1)}}},\"移除\")])}}],productType:[],openTypeTree:!1,open:!0,checkedId:[]}},methods:{get_data:function(){var e=this;e.sideLoading=!0,e.loading=!0;var t=\"api/product/property/findPropertyById/\"+e.productAttr.id;this.$Get(t,{},function(t){e.property=t.data.data.property,e.propertyV=t.data.data.propertyV,e.sideLoading=!1,e.loading=!1})},deleted:function(t){},edit_property:function(t){},create_property:function(){this.propertyV.push({id:\"\",propertyId:\"\",propertyVCode:\"\",propertyValue:\"\",sortId:\"\",status:\"\"})},update_attr_type:function(){var e=this,t={id:e.property[0].id,name:e.property[0].name,typeId:e.property[0].typeId,propertyValues:JSON.stringify(e.propertyV)};this.$Post(\"api/product/property/updateProperty\",t,function(t){e.$emit(\"update\")},function(t){e.$emit(\"update\")})},get_product_type_tree:function(){var e=this;this.$Get(\"api/product/type/tree\",{},function(t){e.productType=t.data.data})},create_type:function(){var t=this.$refs.tree.getCheckedNodes();this.property[0].typeId=t[0].id,this.property[0].typeName=t[0].typeName,this.checkedId=[],this.openTypeTree=!1},open_type_tree:function(){this.get_product_type_tree(),this.openTypeTree=!0,this.checkedId=[this.property[0].typeId]}}},n=(a(740),a(4)),i=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[e.sideLoading?a(\"Spin\",{attrs:{size:\"large\",fix:\"\"}}):e._e(),e._v(\" \"),a(\"Card\",{attrs:{\"dis-hover\":\"\"}},[a(\"div\",{attrs:{slot:\"title\"},slot:\"title\"},[a(\"span\",{staticStyle:{\"padding-right\":\"10px\"}},[e._v(\"属性详情\")]),a(\"Tag\",{attrs:{color:\"yellow\",type:\"border\"}},[e._v(\"点击左侧属性即可查看详情！\")])],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{gutter:20}},[a(\"Col\",{attrs:{span:\"12\"}},[a(\"span\",[e._v(\"分类：\")])]),a(\"Col\",{attrs:{span:\"12\"}},[a(\"Input\",{attrs:{size:\"small\",readonly:\"\"},on:{\"on-focus\":e.open_type_tree},model:{value:e.property[0].typeName,callback:function(t){e.$set(e.property[0],\"typeName\",t)},expression:\"property[0].typeName\"}})],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{gutter:20}},[a(\"Col\",{attrs:{span:\"12\"}},[a(\"span\",[e._v(\"属性名称：\")])]),a(\"Col\",{attrs:{span:\"12\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.property[0].name,callback:function(t){e.$set(e.property[0],\"name\",t)},expression:\"property[0].name\"}})],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{gutter:20}},[a(\"Col\",[a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\"},on:{click:e.update_attr_type}},[e._v(\"保存\")])],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{gutter:20}},[a(\"Col\",{attrs:{span:\"24\"}},[a(\"Table\",{attrs:{id:\"orderItem\",loading:e.loading,\"highlight-row\":\"\",border:\"\",size:\"small\",columns:e.header,data:e.propertyV}},[a(\"Button\",{attrs:{slot:\"footer\",type:\"text\",icon:\"plus\",long:\"\"},on:{click:e.create_property},slot:\"footer\"},[e._v(\"新增属性值\")])],1)],1)],1)],1),e._v(\" \"),e.openTypeTree?a(\"div\",[a(\"Modal\",{attrs:{width:\"400\",title:\"产品类型\"},on:{\"on-cancel\":function(t){e.openTypeTree=!1}},model:{value:e.open,callback:function(t){e.open=t},expression:\"open\"}},[a(\"el-tree\",{ref:\"tree\",attrs:{props:e.defaultProps,\"node-key\":\"id\",data:e.productType,\"show-checkbox\":\"\",\"default-checked-keys\":e.checkedId}}),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.create_type}},[e._v(\"确认\")])],1)],1)],1):e._e()],1)},[],!1,null,null,null);i.options.__file=\"editProductAttr.vue\";var s=i.exports,l={data:function(){var r=this;return{openProductAttr:!0,formInline:{name:\"\"},propertyV:[],header:[{title:\"序号\",type:\"index\",minWidth:80},{title:\"属性值\",key:\"propertyValue\",minWidth:120,render:function(t,e){var a=r;return t(\"div\",[t(\"Input\",{domProps:{},props:{value:r.propertyV[e.index].propertyValue,autosize:!0,type:\"text\",size:\"small\"},on:{\"on-blur\":function(t){a.propertyV[e.index].propertyValue=t.target.value},\"on-enter\":function(t){a.propertyV[e.index].propertyValue=t.target.value}},style:{width:\"100%\"}})])}},{title:\"属性编码\",key:\"propertyVCode\",minWidth:120,render:function(t,e){var a=r;return t(\"div\",[t(\"Input\",{domProps:{},props:{value:r.propertyV[e.index].propertyVCode,autosize:!0,type:\"text\",size:\"small\"},on:{\"on-blur\":function(t){a.propertyV[e.index].propertyVCode=t.target.value},\"on-enter\":function(t){a.propertyV[e.index].propertyVCode=t.target.value}},style:{width:\"100%\"}})])}},{title:\"操作\",key:\"action\",width:120,render:function(t,e){var a=r;return t(\"div\",[t(\"Button\",{props:{type:\"error\",size:\"small\",icon:\"trash-a\"},style:{marginLeft:\"5px\"},on:{click:function(){a.propertyV.splice(e.index,1)}}},\"移除\")])}}],productType:[],openTypeTree:!1,currentType:\"\",currentTypeName:\"\"}},methods:{close:function(){this.$emit(\"close\",!1)},create_attr:function(){var e=this,t={name:e.formInline.name,typeId:e.currentType,propertyValues:JSON.stringify(e.propertyV)};this.$Post(\"api/product/property/createProperty\",t,function(t){e.$emit(\"close\",!0)},function(t){})},create_property:function(){this.propertyV.push({propertyVCode:\"\",propertyValue:\"\"})},open_type_tree:function(){this.openTypeTree=!0},get_product_type_tree:function(){var e=this;this.$Get(\"api/product/type/tree\",{},function(t){e.productType=t.data.data,function t(e){for(var a=0;a<e.length;a++)e[a].title=e[a].text,e[a].children&&t(e[a].children)}(e.productType)})},create_type:function(){var t=this.$refs.tree.getCheckedNodes();this.currentType=t[t.length-1].id,this.currentTypeName=t[t.length-1].title,this.openTypeTree=!1}},created:function(){this.get_product_type_tree()}},p=(a(742),Object(n.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"创建属性\",width:\"500\"},on:{\"on-cancel\":e.close},model:{value:e.openProductAttr,callback:function(t){e.openProductAttr=t},expression:\"openProductAttr\"}},[a(\"Form\",{ref:\"formInline\",attrs:{model:e.formInline,\"label-width\":80}},[a(\"Row\",[a(\"Col\",{attrs:{span:\"24\"}},[a(\"FormItem\",{attrs:{prop:\"name\",label:\"属性名：\"}},[a(\"Input\",{attrs:{type:\"text\"},model:{value:e.formInline.name,callback:function(t){e.$set(e.formInline,\"name\",t)},expression:\"formInline.name\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"FormItem\",{attrs:{prop:\"typeId\",label:\"产品类型:\"}},[a(\"Input\",{attrs:{type:\"text\",readonly:\"\"},on:{\"on-focus\":e.open_type_tree},model:{value:e.currentTypeName,callback:function(t){e.currentTypeName=t},expression:\"currentTypeName\"}})],1)],1)],1),e._v(\" \"),a(\"Table\",{attrs:{id:\"orderItem\",\"highlight-row\":\"\",border:\"\",size:\"small\",columns:e.header,data:e.propertyV}},[a(\"Button\",{attrs:{slot:\"footer\",type:\"text\",icon:\"plus\",long:\"\"},on:{click:e.create_property},slot:\"footer\"},[e._v(\"新增属性值\")])],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.create_attr}},[e._v(\"创建\")])],1)],1),e._v(\" \"),a(\"Modal\",{attrs:{width:\"400\",title:\"产品类型\"},model:{value:e.openTypeTree,callback:function(t){e.openTypeTree=t},expression:\"openTypeTree\"}},[a(\"Tree\",{ref:\"tree\",attrs:{data:e.productType,\"show-checkbox\":\"\"}}),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.create_type}},[e._v(\"确认\")])],1)],1)],1)},[],!1,null,null,null));p.options.__file=\"createAttr.vue\";var c={name:\"productAttrList_index\",components:{productAttrList:s,createAttr:p.exports},data:function(){var a=this;return{openCreateAttr:!1,search_model:\"\",loading:!1,header:[{title:\"分类\",key:\"typeName\",minWidth:150},{title:\"属性名称\",key:\"name\",minWidth:150},{title:\"操作\",key:\"action\",width:90,render:function(t,e){return t(\"div\",[t(\"Button\",{props:{type:\"warning\",size:\"small\"},style:{marginLeft:\"5px\"}},[t(\"Poptip\",{props:{transfer:!0,confirm:!0,title:\"您确定要删除此属性吗！\"},on:{\"on-ok\":function(){a.deleteProductAttr(e.row.id)}}},\"删除\")])])}}],data:[],page:1,pageSize:10,total:0,selectRow:\"\",formValidate:{typeName:\"\",name:\"\"}}},methods:{get_data:function(){var e=this;e.loading=!0;var t={params:{page:e.page,pageSize:e.pageSize,typeName:e.formValidate.typeName,name:e.formValidate.name}};this.$Get(\"api/product/property/list\",t,function(t){e.data=t.data.data.rows,e.total=t.data.data.total,e.loading=!1})},page_change:function(t){this.page=t,this.get_data()},page_size_change:function(t){this.page=1,this.pageSize=t,this.get_data()},search:function(){this.page=1,this.get_data()},handleReset:function(){this.page=1,this.$refs.formValidate.resetFields(),this.get_data()},select_row:function(t){this.selectRow=t},deleteProductAttr:function(t){var e=this,a={id:t};this.$Post(\"api/product/property/delProperty\",a,function(t){e.$Message.success(\"删除成功！\"),e.get_data()},function(t){e.$Message.error(\"删除失败！\")})},close_create_attr:function(t){this.openCreateAttr=!1,t&&this.get_data()}},watch:{},created:function(){this.get_data()}},d=Object(n.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.search(t):null}},slot:\"content\"},[a(\"Form\",{ref:\"formValidate\",staticStyle:{\"margin-top\":\"15px\"},attrs:{model:e.formValidate,\"label-width\":120}},[a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"分类名称：\",prop:\"typeName\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.formValidate.typeName,callback:function(t){e.$set(e.formValidate,\"typeName\",t)},expression:\"formValidate.typeName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"属性名称：\",prop:\"name\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,\"name\",t)},expression:\"formValidate.name\"}})],1)],1)],1),e._v(\" \"),a(\"center\",[a(\"FormItem\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Button\",{attrs:{type:\"primary\",name:\"marketingManagement_index_edit_search\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\",name:\"marketingManagement_index_edit_reset\"},on:{click:e.handleReset}},[e._v(\"重置\")])],1)],1)],1)],1)],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{gutter:20}},[a(\"Col\",{attrs:{span:\"12\"}},[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"},attrs:{gutter:20}},[a(\"Col\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:function(t){e.openCreateAttr=!0}}},[e._v(\"新增属性\")])],1)],1),e._v(\" \"),a(\"Table\",{attrs:{loading:e.loading,\"highlight-row\":\"\",border:\"\",size:\"small\",columns:e.header,data:e.data},on:{\"on-current-change\":e.select_row}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.total,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\",current:e.page},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.page_change,\"on-page-size-change\":e.page_size_change}})],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"12\"}},[a(\"product-attr-list\",{staticStyle:{\"margin-left\":\"5px\"},attrs:{productAttr:e.selectRow},on:{update:e.get_data}})],1)],1)],1),e._v(\" \"),e.openCreateAttr?a(\"create-attr\",{on:{close:e.close_create_attr}}):e._e()],1)},[],!1,null,null,null);d.options.__file=\"index.vue\";e.default=d.exports},844:function(t,e,a){\"use strict\";a.r(e);a(413),a(404);var r=a(414),o={components:{elTree:a.n(r).a},props:{id:{type:[String,Number],default:0}},computed:{checkedId:function(){return[this.id]}},data:function(){return{open:!0,defaultProps:{label:\"typeName\"},productType:[]}},methods:{create_type:function(){var t=this.$refs.tree.getCheckedNodes();t.length?this.$emit(\"close\",{typeName:t[0].typeName,id:t[0].id}):this.$emit(\"close\",{typeName:\"\",id:\"\"})},close:function(){this.$emit(\"close\")},get_data:function(){var e=this;this.$Get(\"api/product/type/tree\",{},function(t){e.productType=t.data.data})}},created:function(){this.get_data()}},n=a(4),i=Object(n.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{width:\"400\",title:\"产品类型\"},on:{\"on-cancel\":e.close},model:{value:e.open,callback:function(t){e.open=t},expression:\"open\"}},[a(\"el-tree\",{ref:\"tree\",attrs:{props:e.defaultProps,\"node-key\":\"id\",data:e.productType,\"show-checkbox\":\"\",\"default-checked-keys\":e.checkedId}}),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.create_type}},[e._v(\"确认\")])],1)],1)],1)},[],!1,null,null,null);i.options.__file=\"typeTree.vue\";var s=i.exports,l={data:function(){var a=this;return{page:1,pageSize:10,total:0,header:[{title:\"分类\",key:\"typeName\",minWidth:150},{title:\"属性名称\",key:\"name\",minWidth:150},{title:\"操作\",key:\"\",minWidth:120,render:function(t,e){return t(\"Button\",{props:{size:\"small\",type:\"info\"},on:{click:function(){a.$emit(\"add-attr\",e.row.id)}}},\"添加\")}}],data:[],openTypeList:!0,formValidate:{name:\"\",typeName:\"\"}}},methods:{close:function(){this.$emit(\"close\")},page_change:function(t){this.page=t,this.get_data()},get_data:function(){var e=this;e.loading=!0;var t={params:{page:e.page,pageSize:e.pageSize,name:e.formValidate.name,typeName:e.formValidate.typeName}};this.$Get(\"api/product/property/list\",t,function(t){e.data=t.data.data.rows,e.total=t.data.data.total,e.loading=!1})}},created:function(){this.get_data()}},p=Object(n.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"选择产品属性\",width:\"500\"},on:{\"on-cancel\":e.close},model:{value:e.openTypeList,callback:function(t){e.openTypeList=t},expression:\"openTypeList\"}},[a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Form\",{ref:\"formValidate\",attrs:{model:e.formValidate,inline:\"\"}},[a(\"FormItem\",{attrs:{prop:\"typeName\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"属性分类\"},model:{value:e.formValidate.typeName,callback:function(t){e.$set(e.formValidate,\"typeName\",t)},expression:\"formValidate.typeName\"}})],1),e._v(\" \"),a(\"FormItem\",{attrs:{prop:\"name\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"属性名称\"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,\"name\",t)},expression:\"formValidate.name\"}})],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.get_data}},[e._v(\"查询\")])],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"Table\",{attrs:{loading:e.loading,\"highlight-row\":\"\",border:\"\",size:\"small\",columns:e.header,data:e.data}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{simple:\"\",size:\"small\",total:e.total,\"show-total\":\"\",\"show-elevator\":\"\",current:e.page},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.page_change}})],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);p.options.__file=\"typeAttrList.vue\";var c={name:\"productDetail\",components:{typeTree:s,attrList:p.exports},computed:{readonly:function(){return!!this.$route.query.id}},data:function(){return{openAttrList:!1,openTypeTree:!1,data:{iscycle:\"N\"},propertys:[],departAlias:[],ruleValidate:{product:[{required:!0,message:\"产品名称不能为空！\",trigger:\"blur\"}],productTypeName:[{required:!0,message:\"产品类型不能为空！\",trigger:\"change\"}],iscycle:[{required:!0,message:\"周期性属性不能为空！\",trigger:\"blur\"}],defaultdepartalias:[{required:!0,message:\"默认服务部门不能为空！\",trigger:\"blur\"}],departalias:[{required:!0,message:\"服务部门不能为空！\",trigger:\"change\",type:\"array\",min:1}],productCode:[{required:!0,message:\"产品编码不能为空！\",trigger:\"change\"}]},checkTypeArray:[]}},methods:{get_product_detail:function(t){if(t.query.id){var r=this,e={params:{id:r.$route.query.id}};this.$Get(\"api/product/productDetail\",e,function(t){r.data=t.data.data,r.propertys=t.data.data.propertys,r.checkTypeArray=[];for(var e=function(t){for(var e=[],a=0;a<r.propertys[t].children.length;a++)r.propertys[t].children[a].selected&&e.push(r.propertys[t].children[a].pvId);r.$nextTick(function(){r.checkTypeArray.push(e)})},a=0;a<r.propertys.length;a++)e(a);r.data.departalias=r.data.departalias.split(\",\")})}},get_data_center:function(){var e=this;this.$GetDataCenter(\"departAlias\",function(t){e.departAlias=t.data.data.departAlias})},open_type_tree:function(){this.openTypeTree=!0},close_type_tree:function(t){t&&(this.data.productTypeName=t.typeName,this.data.productTypeID=t.id),this.openTypeTree=!1},open_product_attr:function(){this.openAttrList=!0},add_attr:function(t){for(var e=0;e<this.propertys.length;e++)if(this.propertys[e].propertyId==t)return this.$Message.warning(\"此属性已添加！请勿重复添加！\"),!1;var i=this;i.sideLoading=!0,i.loading=!0;var a=\"api/product/property/findPropertyById/\"+t;this.$Get(a,{},function(t){var e=t.data.data,a={};a.name=e.property[0].name,a.propertyId=e.property[0].id,a.children=[];for(var r=[],o=0;o<e.propertyV.length;o++){var n={};n.pvId=e.propertyV[o].id,n.propertyValue=e.propertyV[o].propertyValue,n.selected=1,a.children.push(n),r.push(e.propertyV[o].id)}i.propertys.push(a),i.checkTypeArray.push(r)})},delete_product_type:function(t){var e=this;this.propertys.splice(t,1),this.$nextTick(function(){e.checkTypeArray.splice(t,1)})},before_update_product:function(){var e=this,a=this;this.$refs.data.validate(function(t){t?a.$route.query.id?a.update_product():a.create_product():e.$Message.error(\"请补全信息！\")})},cancel:function(){this.$refs.data.resetFields(),this.data.productTypeID=\"\",this.propertys=[],this.checkTypeArray=[]},create_product:function(){var e=this,t=this.tranform(),a={productcode:e.data.productCode,product:e.data.product,iscycle:e.data.iscycle,defaultdepartalias:e.data.defaultdepartalias,departalias:e.data.departalias.join(\",\"),producttypeid:e.data.productTypeID,propertys:JSON.stringify(t),sortid:e.data.ordernumber,status:e.data.status,ordernumber:e.data.ordernumber};this.$Post(\"api/product/create\",a,function(t){e.$store.commit(\"closePage\",\"productDetail\"),e.$store.commit(\"removeTag\",\"productDetail\"),e.$bus.emit(\"UPDATE_PRODUCT_LIST\"),e.$router.push({name:\"productList_index\"})},function(t){})},update_product:function(){var e=this,t=this.tranform(),a={id:e.$route.query.id,product:e.data.product,iscycle:e.data.iscycle,defaultdepartalias:e.data.defaultdepartalias,departalias:e.data.departalias.join(\",\"),productTypeId:e.data.productTypeID,propertyIds:JSON.stringify(t)};this.$Post(\"api/product/update\",a,function(t){e.$store.commit(\"closePage\",\"productDetail\"),e.$store.commit(\"removeTag\",\"productDetail\"),e.$bus.emit(\"UPDATE_PRODUCT_LIST\"),e.$router.push({name:\"productList_index\"})},function(t){})},tranform:function(){for(var t=[],e=0;e<this.propertys.length;e++){var a={};a.id=this.propertys[e].propertyId,a.cId=this.checkTypeArray[e],t.push(a)}return t}},watch:{$route:function(t,e){t&&this.get_product_detail(t)}},created:function(){this.get_data_center(),this.get_product_detail(this.$route)}},d=Object(n.a)(c,function(){var a=this,t=a.$createElement,r=a._self._c||t;return r(\"div\",[r(\"Card\",{staticStyle:{\"min-width\":\"1000px\"},attrs:{title:\"产品详情\"}},[r(\"Row\",{attrs:{gutter:20}},[r(\"Col\",{attrs:{span:\"12\"}},[r(\"Form\",{ref:\"data\",attrs:{model:a.data,rules:a.ruleValidate,\"label-width\":120}},[r(\"FormItem\",{attrs:{label:\"产品名称：\",prop:\"product\"}},[r(\"Input\",{model:{value:a.data.product,callback:function(t){a.$set(a.data,\"product\",t)},expression:\"data.product\"}})],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"产品类型：\",prop:\"productTypeName\"}},[r(\"Input\",{on:{\"on-focus\":a.open_type_tree},model:{value:a.data.productTypeName,callback:function(t){a.$set(a.data,\"productTypeName\",t)},expression:\"data.productTypeName\"}})],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"周期性产品：\",prop:\"iscycle\"}},[r(\"Select\",{model:{value:a.data.iscycle,callback:function(t){a.$set(a.data,\"iscycle\",t)},expression:\"data.iscycle\"}},[r(\"Option\",{attrs:{value:\"Y\"}},[a._v(\"是\")]),a._v(\" \"),r(\"Option\",{attrs:{value:\"N\"}},[a._v(\"否\")])],1)],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"默认服务部门：\",prop:\"defaultdepartalias\"}},[r(\"Select\",{model:{value:a.data.defaultdepartalias,callback:function(t){a.$set(a.data,\"defaultdepartalias\",t)},expression:\"data.defaultdepartalias\"}},[a._l(a.departAlias,function(t,e){return r(\"Option\",{key:e,attrs:{value:t.typecode}},[a._v(a._s(t.typename))])}),a._v(\" \"),r(\"Option\",{attrs:{value:\"N\"}},[a._v(\"否\")])],2)],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"服务部门：\",prop:\"departalias\"}},[r(\"CheckboxGroup\",{attrs:{size:\"large\"},model:{value:a.data.departalias,callback:function(t){a.$set(a.data,\"departalias\",t)},expression:\"data.departalias\"}},[r(\"Row\",a._l(a.departAlias,function(t,e){return r(\"Col\",{key:e,attrs:{span:8}},[r(\"Checkbox\",{attrs:{label:t.typecode,size:\"large\"}},[a._v(a._s(t.typename))])],1)}),1)],1)],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"产品编码：\",prop:\"productCode\"}},[r(\"Input\",{attrs:{readonly:a.readonly},model:{value:a.data.productCode,callback:function(t){a.$set(a.data,\"productCode\",t)},expression:\"data.productCode\"}})],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"产品状态：\",prop:\"status\"}},[r(\"Select\",{staticStyle:{width:\"100%\"},attrs:{disabled:a.readonly},model:{value:a.data.status,callback:function(t){a.$set(a.data,\"status\",t)},expression:\"data.status\"}},[r(\"Option\",{attrs:{value:0}},[a._v(\"未上架\")]),a._v(\" \"),r(\"Option\",{attrs:{value:1}},[a._v(\"销售中\")])],1)],1),a._v(\" \"),r(\"FormItem\",{attrs:{label:\"产品排序：\",prop:\"ordernumber\"}},[r(\"Input\",{attrs:{readonly:a.readonly},model:{value:a.data.ordernumber,callback:function(t){a.$set(a.data,\"ordernumber\",t)},expression:\"data.ordernumber\"}})],1),a._v(\" \"),a.$route.query.id?r(\"FormItem\",[r(\"Button\",{attrs:{type:\"primary\"},on:{click:a.before_update_product}},[a._v(\"修改\")]),a._v(\" \"),r(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:a.cancel}},[a._v(\"重置\")])],1):r(\"FormItem\",[r(\"Button\",{attrs:{type:\"primary\"},on:{click:a.before_update_product}},[a._v(\"创建\")]),a._v(\" \"),r(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:a.cancel}},[a._v(\"重置\")])],1)],1)],1),a._v(\" \"),r(\"Col\",{attrs:{span:\"12\"}},[r(\"Row\",[r(\"Button\",{attrs:{type:\"primary\"},on:{click:a.open_product_attr}},[a._v(\"添加产品属性\")])],1),a._v(\" \"),a._l(a.propertys,function(t,e){return r(\"Row\",{key:e,staticStyle:{\"margin-top\":\"10px\"}},[r(\"Row\",[r(\"h3\",{staticStyle:{display:\"inline-block\",float:\"left\"}},[a._v(\"属性值 - \"+a._s(e+1)+\"：\"+a._s(t.name))]),r(\"Button\",{staticStyle:{display:\"inline-block\",float:\"right\"},attrs:{type:\"warning\",size:\"small\"},on:{click:function(t){a.delete_product_type(e)}}},[a._v(\"删除\")])],1),a._v(\" \"),r(\"CheckboxGroup\",{attrs:{size:\"large\"},model:{value:a.checkTypeArray[e],callback:function(t){a.$set(a.checkTypeArray,e,t)},expression:\"checkTypeArray[index]\"}},[r(\"Row\",{staticStyle:{\"margin-top\":\"5px\"}},a._l(t.children,function(t,e){return r(\"Col\",{key:e,attrs:{span:\"8\"}},[r(\"Checkbox\",{attrs:{label:t.pvId,size:\"large\"}},[a._v(a._s(t.propertyValue))])],1)}),1)],1)],1)})],2)],1)],1),a._v(\" \"),a.openTypeTree?r(\"type-tree\",{attrs:{id:a.data.productTypeID},on:{close:a.close_type_tree}}):a._e(),a._v(\" \"),a.openAttrList?r(\"attr-list\",{on:{close:function(t){a.openAttrList=!1},\"add-attr\":a.add_attr}}):a._e()],1)},[],!1,null,null,null);d.options.__file=\"index.vue\";e.default=d.exports},847:function(t,e,a){\"use strict\";a.r(e);a(432),a(404);var r=a(433),o=a.n(r),n=(a(436),a(437)),i=a.n(n),s=a(3),l=a.n(s);function p(t,r){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,i=[];return Array.from(t).forEach(function(t){void 0===t._expanded&&l.a.set(t,\"_expanded\",r);var e=1;if(null!=n&&(e=n+1),l.a.set(t,\"_level\",e),o&&l.a.set(t,\"parent\",o),i.push(t),t.children&&0<t.children.length){var a=p(t.children,r,t,e);i=i.concat(a)}}),i}var c={components:{elTable:i.a,elTableColumn:o.a},name:\"TreeTable\",props:{data:{type:[Array,Object],required:!0},columns:{type:Array,default:function(){return[]}},evalFunc:Function,evalArgs:Array,expandAll:{type:Boolean,default:!1},selection:{type:Boolean,default:!1}},computed:{formatData:function(){var t=void 0;t=Array.isArray(this.data)?this.data:[this.data];var e=this.evalFunc||p,a=this.evalArgs?Array.concat([t,this.expandAll],this.evalArgs):[t,this.expandAll];return e.apply(null,a)}},methods:{showRow:function(t){var e=!t.row.parent||t.row.parent._expanded&&t.row.parent._show;return(t.row._show=e)?\"animation:treeTableShow 1s;-webkit-animation:treeTableShow 1s;\":\"display:none;\"},toggleExpanded:function(t){var e=this.formatData[t];e._expanded=!e._expanded},iconShow:function(t,e){return 0===t&&e.children&&0<e.children.length},handleSelectionChange:function(t,e){if(e.children)for(var a=0;a<e.children.length;a++)this.$refs.multipleTable.toggleRowSelection(e.children[a]),this.handleSelectionChange(\"\",e.children[a])},get_current_click:function(t){this.$emit(\"current-change\",t)},get_all_change:function(t){this.$emit(\"get-all-selection\",t)},edit:function(t){this.$emit(\"edit\",t)},del:function(t){this.$emit(\"delete\",t)},create:function(t){this.$emit(\"create\",t)}}},d=(a(682),a(684),a(4)),u=Object(d.a)(c,function(){var r=this,t=r.$createElement,o=r._self._c||t;return o(\"el-table\",r._b({ref:\"multipleTable\",attrs:{data:r.formatData,\"row-style\":r.showRow,size:\"small\"},on:{select:r.handleSelectionChange,\"selection-change\":r.get_all_change,\"current-change\":r.get_current_click}},\"el-table\",r.$attrs,!1),[r.selection?o(\"el-table-column\",{attrs:{type:\"selection\",width:\"55\"}}):r._e(),r._v(\" \"),0===r.columns.length?o(\"el-table-column\",{attrs:{width:\"150\"},scopedSlots:r._u([{key:\"default\",fn:function(e){return[r._l(e.row._level,function(t){return o(\"span\",{key:t,staticClass:\"ms-tree-space\"})}),r._v(\" \"),r.iconShow(0,e.row)?o(\"span\",{staticClass:\"tree-ctrl\",on:{click:function(t){r.toggleExpanded(e.$index)}}},[e.row._expanded?o(\"i\",{staticClass:\"el-icon-minus\"}):o(\"i\",{staticClass:\"el-icon-plus\"})]):r._e(),r._v(\"\\n      \"+r._s(e.$index)+\"\\n    \")]}}])}):r._l(r.columns,function(t,a){return o(\"el-table-column\",{key:t.value,attrs:{label:t.text,minWidth:t.width},scopedSlots:r._u([{key:\"default\",fn:function(e){return[r._l(e.row._level,function(t){return 0===a?o(\"span\",{key:t,staticClass:\"ms-tree-space\"}):r._e()}),r._v(\" \"),r.iconShow(a,e.row)?o(\"span\",{staticClass:\"tree-ctrl\",on:{click:function(t){r.toggleExpanded(e.$index)}}},[e.row._expanded?o(\"i\",{staticClass:\"el-icon-minus\"}):o(\"i\",{staticClass:\"el-icon-plus\"})]):r._e(),r._v(\"\\n      \"+r._s(e.row[t.value])+\"\\n    \")]}}])})}),r._v(\" \"),r._t(\"default\")],2)},[],!1,null,\"895c21b6\",null);u.options.__file=\"index.vue\";var y={name:\"updateProductPrice\",components:{treeTable:u.exports},data:function(){return{showUpdatePrice:!1,loading:!1,queryProperty:[],typeArray:[],title:\"\",columns:[{text:\"地区全称\",value:\"areafullname\",width:200},{text:\"地区名称\",value:\"realname\",width:150},{text:\"地区编码\",value:\"dispid\",width:120},{text:\"基础价格\",value:\"baseprice\",width:120},{text:\"系统价格\",value:\"oaprice\",width:120},{text:\"状态\",value:\"statusName\",width:120}],data:[],selectRow:[],dbaseprice:\"\",doaprice:\"\",status:\"1\",alisname:\"\"}},methods:{get_product_attr:function(t){var e=this,a={params:{productId:t}};this.$Get(\"api/product/queryPropertyByProductId\",a,function(t){e.queryProperty=t.data.data,e.title=t.data.data[0].product})},get_price:function(){var e=this;this.loading=!0;var t={params:{propertys:e.typeArray.join(\",\"),productId:e.$route.params.id}};this.$Get(\"api/product/area/findTreeSkuArea\",t,function(t){e.data=t.data.data,function t(e){for(var a=0;a<e.length;a++)1==e[a].status?e[a].statusName=\"销售中\":e[a].statusName=\"未上架\",e[a].children&&t(e[a].children)}(e.data),e.loading=!1})},get_all_selection:function(t){this.selectRow=t},update_product_price:function(){for(var e=this,t=[],a=0;a<e.selectRow.length;a++){var r={};r.areaid=e.selectRow[a].dispid,r.skuareaid=e.selectRow[a].skuAreaId,r.status=e.status,r.baseprice=e.dbaseprice,r.oaprice=e.doaprice,t.push(r)}var o={productId:e.$route.params.id,propertys:e.typeArray.join(\",\"),doaprice:e.doaprice,dbaseprice:e.dbaseprice,areaPrices:JSON.stringify(t)};this.$Post(\"api/product/area/saveProductSku\",o,function(t){e.get_price()},function(t){})}},watch:{$route:function(t,e){t.params.id&&this.get_product_attr(t.params.id)}},created:function(){this.get_product_attr(this.$route.params.id)}},m=Object(d.a)(y,function(){var a=this,t=a.$createElement,r=a._self._c||t;return r(\"div\",[r(\"Card\",[r(\"span\",{attrs:{slot:\"title\"},slot:\"title\"},[r(\"h3\",[a._v(a._s(a.title))])]),a._v(\" \"),a._l(a.queryProperty,function(t,e){return r(\"div\",{key:e,staticStyle:{\"margin-top\":\"10px\"}},[r(\"Row\",{staticStyle:{display:\"flex\",\"justify-content\":\"flex-start\"}},[r(\"div\",{staticStyle:{\"padding-right\":\"20px\",\"padding-left\":\"10px\",width:\"120px\",display:\"inline-block\",\"text-align\":\"right\",\"line-height\":\"32px\"}},[a._v(a._s(t.name)+\" :\")]),a._v(\" \"),r(\"RadioGroup\",{attrs:{type:\"button\"},model:{value:a.typeArray[e],callback:function(t){a.$set(a.typeArray,e,t)},expression:\"typeArray[index]\"}},a._l(t.children,function(t,e){return r(\"Radio\",{key:e,attrs:{label:t.pvId}},[a._v(a._s(t.propertyValue))])}),1)],1)],1)}),a._v(\" \"),r(\"Row\",{staticStyle:{\"margin-top\":\"10px\",\"margin-left\":\"10px\"}},[r(\"ButtonGroup\",[r(\"Button\",{attrs:{type:\"primary\"},on:{click:a.get_price}},[a._v(\"查询\")]),a._v(\" \"),r(\"Button\",{attrs:{type:\"primary\"},on:{click:function(t){a.showUpdatePrice=!0,a.dbaseprice=\"\",a.doaprice=\"\"}}},[a._v(\"修改价格\")])],1)],1),a._v(\" \"),a.showUpdatePrice?r(\"Row\",{staticStyle:{\"margin-top\":\"10px\",\"margin-left\":\"10px\"}},[r(\"div\",{staticStyle:{display:\"flex\",\"justify-content\":\"flex-start\",\"align-items\":\"center\"}},[r(\"span\",[a._v(\"基础价格：\")]),r(\"Input\",{staticStyle:{width:\"150px\",\"margin-right\":\"40px\"},model:{value:a.dbaseprice,callback:function(t){a.dbaseprice=t},expression:\"dbaseprice\"}}),a._v(\" \"),r(\"span\",[a._v(\"系统价格：\")]),r(\"Input\",{staticStyle:{width:\"150px\",\"margin-right\":\"40px\"},model:{value:a.doaprice,callback:function(t){a.doaprice=t},expression:\"doaprice\"}}),a._v(\" \"),r(\"span\",[a._v(\"状态：\")]),a._v(\" \"),r(\"Select\",{staticStyle:{width:\"150px\",\"margin-right\":\"40px\"},model:{value:a.status,callback:function(t){a.status=t},expression:\"status\"}},[r(\"Option\",{attrs:{value:\"0\"}},[a._v(\"未上架\")]),a._v(\" \"),r(\"Option\",{attrs:{value:\"1\"}},[a._v(\"销售中\")])],1),a._v(\" \"),r(\"span\",[a._v(\"SKU别名：\")]),r(\"Input\",{staticStyle:{width:\"150px\",\"margin-right\":\"40px\"},model:{value:a.alisname,callback:function(t){a.alisname=t},expression:\"alisname\"}}),a._v(\" \"),r(\"ButtonGroup\",[r(\"Button\",{attrs:{type:\"warning\"},on:{click:a.update_product_price}},[a._v(\"确认修改\")]),a._v(\" \"),r(\"Button\",{attrs:{type:\"ghost\"},on:{click:function(t){a.showUpdatePrice=!1}}},[a._v(\"关闭\")])],1)],1)]):a._e(),a._v(\" \"),r(\"Row\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{gutter:20}},[a.loading?r(\"Spin\",{attrs:{size:\"large\",fix:\"\"}}):r(\"Col\",{attrs:{span:\"24\"}},[r(\"tree-table\",{attrs:{selection:\"\",data:a.data,columns:a.columns,border:\"\"},on:{\"get-all-selection\":a.get_all_selection}})],1)],1)],2)],1)},[],!1,null,null,null);m.options.__file=\"index.vue\";e.default=m.exports},853:function(t,e,a){\"use strict\";a.r(e);var r={props:{product:{type:[Object,String]}},data:function(){return{changeArea:!1,sideLoading:!1,productPrice:0,areaCode:[\"440000\",\"440100\",\"440103\"],SKU:\"\",orderAddProduct:!1,selectProduct:\"\",queryProperty:[],producSku:[],selectProperty:[],newPrice:0}},watch:{product:{handler:function(){this.select_product()},deep:!0}},methods:{select_product:function(){if(\"14\"==this.product.id)return this.$Message.error(\"对不起，该产品已经不允许操作！\"),!1;this.SKU=\"\",this.sideLoading=!0,this.selectProduct=this.product,this.productPrice=0,this.queryProperty=[],this.selectProperty=[],this.get_queryProperty(),this.get_product_sku()},get_queryProperty:function(){var r=this,t={params:{productId:this.product.id}};this.$Get(\"api/product/queryPropertyByProductId\",t,function(t){if(r.queryProperty=t.data.data,100==r.product.id){for(var e=[],a=0;a<r.queryProperty.length;a++)95==r.queryProperty[a].propertyId&&(e[0]=r.queryProperty[a]),23==r.queryProperty[a].propertyId&&(e[1]=r.queryProperty[a]),16==r.queryProperty[a].propertyId&&(e[2]=r.queryProperty[a]);r.queryProperty=e,r.changeArea=!0}else r.changeArea=!1})},get_product_sku:function(){var a=this,t={params:{productId:this.product.id}};this.$Get(\"api/product/getSKUListByProductId\",t,function(t){a.producSku=t.data.data;try{var e=a.producSku[0].linkPropertys.split(\",\");1==e.length&&(a.selectProperty.push(parseInt(e[0])),a.property_change()),setTimeout(function(){a.sideLoading=!1},200)}catch(t){setTimeout(function(){a.sideLoading=!1},200)}})},find_sku:function(){var i=this;return new Promise(function(t,e){i.SKU=\"\";var a=i.producSku[0].linkPropertys.split(\",\").length;if(i.selectProperty.length==a)for(var r=[],o=i.selectProperty.join(\",\"),n=0;n<i.producSku.length;n++){r=i.producSku[n].linkPropertys.split(\",\"),i.find_array(r,o)&&(i.SKU=i.producSku[n].id,t())}})},find_array:function(t,e){if(e=e.split(\",\"),t.length!=e.length)return!1;var a=t.length,r=0;t=t.sort(),e=e.sort();for(var o=0;o<a;o++){if(t[o]!=e[o])return!1;r++}return r==a||void 0},get_product_price_by_sku:function(){var e=this,t={params:{skuId:e.SKU,areaId:e.areaCode[2]}};this.$Get(\"api/product/getPriceByAreaAndSKU\",t,function(t){e.productPrice=t.data.data[0].oaprice})},area_change:function(t){this.property_change()},property_change:function(t){var e=this;this.productPrice=0,this.selectProperty.length&&this.find_sku().then(function(){e.get_product_price_by_sku()}).catch(function(t){})},add_product:function(){var a=this,t={params:{productSkuIds:a.SKU,areaId:a.areaCode[2]}};this.$Get(\"/api/order/queryItemDetail\",t,function(t){if(a.detail=t.data.data[0],\"Y\"==t.data.data[0].iscycle){var e={params:{productId:a.selectProduct.id,companyId:a.companyId}};a.$Get(\"api/order/cycle/service/record/budget/period\",e,function(t){a.detail.servicestartdate=t.data.data,a.$bus.emit(\"ADD_PRODUCT\",a.detail),a.productListShow=!1})}else a.$bus.emit(\"ADD_PRODUCT\",a.detail),a.productListShow=!1})},open_flow_img:function(){window.open(\"/api/dataCenter/activiti/getInputStreamBySkuId?skuId=\"+this.SKU)},rowClassName:function(t,e){if(\"14\"==t.id)return\"disabled-row\"},edit_product_price:function(){this.$router.push({name:\"updateProductPrice\",params:{skuId:this.SKU}})}},computed:{isAdmin:function(){return\"10059\"==localStorage.getItem(\"id\")},disabled:function(){return!this.SKU}}},o=(a(734),a(4)),n=Object(o.a)(r,function(){var a=this,t=a.$createElement,r=a._self._c||t;return r(\"div\",[a.sideLoading?r(\"Spin\",{attrs:{size:\"large\",fix:\"\"}}):a._e(),a._v(\" \"),r(\"Card\",{attrs:{\"dis-hover\":\"\"}},[r(\"div\",{attrs:{slot:\"title\"},slot:\"title\"},[r(\"span\",{staticStyle:{\"padding-right\":\"10px\"}},[a._v(\"产品详情\")]),a._v(\" \"),r(\"Tag\",{attrs:{color:\"yellow\",type:\"border\"}},[a._v(\"点击左侧产品即可查看价格！\")])],1),a._v(\" \"),r(\"Row\",{staticClass:\"productDetail-title\",staticStyle:{\"margin-bottom\":\"20px\"}},[r(\"p\",{attrs:{id:\"product_name\"}},[a._v(a._s(a.product.product))]),a._v(\" \"),r(\"p\",{staticClass:\"productDetail-title-price\"},[r(\"span\",[a._v(\"￥\\n          \"),r(\"strong\",{attrs:{id:\"product_price\"}},[a._v(a._s(a.productPrice))])])]),a._v(\" \"),r(\"div\",{staticClass:\"productDetail-title-content\"})]),a._v(\" \"),100==a.selectProduct.id&&a.changeArea?r(\"Row\",{staticClass:\"type-select\"},[r(\"p\",[a._v(a._s(a.queryProperty[0].name))]),a._v(\" \"),r(\"RadioGroup\",{attrs:{type:\"button\",size:\"large\"},on:{\"on-change\":function(t){a.property_change,a.selectProperty[1]=\"\",a.productPrice=0,a.SKU=\"\"}},model:{value:a.selectProperty[0],callback:function(t){a.$set(a.selectProperty,0,t)},expression:\"selectProperty[0]\"}},a._l(a.queryProperty[0].children,function(t,e){return r(\"Radio\",{key:e,attrs:{label:t.pvId}},[a._v(a._s(t.propertyValue))])}),1),a._v(\" \"),310==a.selectProperty[0]?r(\"p\",[a._v(a._s(a.queryProperty[2].name))]):a._e(),a._v(\" \"),310==a.selectProperty[0]?r(\"RadioGroup\",{attrs:{type:\"button\",size:\"large\"},on:{\"on-change\":a.property_change},model:{value:a.selectProperty[1],callback:function(t){a.$set(a.selectProperty,1,t)},expression:\"selectProperty[1]\"}},a._l(a.queryProperty[2].children,function(t,e){return r(\"Radio\",{key:e,attrs:{label:t.pvId}},[a._v(a._s(t.propertyValue))])}),1):a._e(),a._v(\" \"),310!=a.selectProperty[0]?r(\"p\",[a._v(a._s(a.queryProperty[1].name))]):a._e(),a._v(\" \"),310!=a.selectProperty[0]?r(\"RadioGroup\",{attrs:{type:\"button\",size:\"large\"},on:{\"on-change\":a.property_change},model:{value:a.selectProperty[1],callback:function(t){a.$set(a.selectProperty,1,t)},expression:\"selectProperty[1]\"}},a._l(a.queryProperty[1].children,function(t,e){return r(\"Radio\",{key:e,attrs:{label:t.pvId}},[a._v(a._s(t.propertyValue))])}),1):a._e()],1):a._e(),a._v(\" \"),a._l(a.queryProperty,function(t,e){return 100!=a.selectProduct.id?r(\"Row\",{key:e,staticClass:\"type-select\"},[r(\"p\",[a._v(a._s(t.name))]),a._v(\" \"),r(\"RadioGroup\",{attrs:{type:\"button\",size:\"large\"},on:{\"on-change\":a.property_change},model:{value:a.selectProperty[e],callback:function(t){a.$set(a.selectProperty,e,t)},expression:\"selectProperty[index]\"}},a._l(t.children,function(t,e){return r(\"Radio\",{key:e,attrs:{label:t.pvId}},[a._v(a._s(t.propertyValue))])}),1)],1):a._e()}),a._v(\" \"),r(\"Row\",{staticStyle:{\"margin-top\":\"20px\"}},[r(\"p\",{staticStyle:{\"font-size\":\"16px\",\"padding-bottom\":\"16px\"}},[a._v(\"地区\")]),a._v(\" \"),r(\"Col\",{attrs:{span:\"10\"}},[r(\"al-cascader\",{attrs:{\"data-type\":\"code\",level:\"2\"},on:{\"on-change\":a.area_change},model:{value:a.areaCode,callback:function(t){a.areaCode=t},expression:\"areaCode\"}})],1)],1),a._v(\" \"),r(\"Row\",[r(\"Button\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{type:\"error\",icon:\"bag\",size:\"large\"},on:{click:a.open_flow_img}},[a._v(\"查看流程图\")])],1)],2)],1)},[],!1,null,null,null);n.options.__file=\"productAttr.vue\";var i={name:\"productList_index\",components:{productAttr:n.exports},data:function(){var r=this;return{search_model:\"\",loading:!1,header:[{title:\"产品名称\",key:\"product\",minWidth:180},{title:\"状态\",key:\"statusText\",minWidth:90},{title:\"产品编码\",key:\"productCode\",minWidth:150},{title:\"操作\",key:\"action\",width:220,render:function(t,e){var a=r;return t(\"div\",[t(\"Button\",{props:{type:\"primary\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(t){a.$router.push({path:\"/productDetail?id=\"+e.row.id}),t.stopPropagation()}}},\"编辑\"),t(\"Button\",{props:{type:\"info\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(t){a.edit_product_price(e.row.id),t.stopPropagation()}}},\"修改价格\"),t(\"Button\",{props:{type:\"warning\",size:\"small\",icon:\"trash-a\",disabled:!0}},\"删除\")])}}],data:[],page:1,pageSize:10,total:0,selectRow:\"\",formValidate:{product:\"\",productCode:\"\"}}},methods:{get_data:function(){var a=this;a.loading=!0;var t={params:{page:a.page,pageSize:a.pageSize,product:a.formValidate.product,productCode:a.formValidate.productCode}};this.$Get(\"api/product/list\",t,function(t){a.data=t.data.data.rows,a.total=t.data.data.total;for(var e=0;e<a.data.length;e++)0==a.data[e].status?a.data[e].statusText=\"下架\":a.data[e].statusText=\"在售\";a.loading=!1})},page_change:function(t){this.page=t,this.get_data()},page_size_change:function(t){this.page=1,this.pageSize=t,this.get_data()},search:function(){this.page=1,this.get_data()},handleReset:function(){this.page=1,this.$refs.formValidate.resetFields(),this.get_data()},select_row:function(t){this.selectRow=t},edit_product_price:function(t){this.$router.push({name:\"updateProductPrice\",params:{id:t}})},create:function(){this.$router.push({path:\"/productDetail?id=\"})}},watch:{},created:function(){var t=this;this.get_data(),this.$bus.off(\"UPDATE_PRODUCT_LIST\"),this.$bus.on(\"UPDATE_PRODUCT_LIST\",function(){t.get_data()})}},s=Object(o.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.search(t):null}},slot:\"content\"},[a(\"Form\",{ref:\"formValidate\",staticStyle:{\"margin-top\":\"15px\"},attrs:{model:e.formValidate,\"label-width\":120}},[a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"产品名称：\",prop:\"product\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.formValidate.product,callback:function(t){e.$set(e.formValidate,\"product\",t)},expression:\"formValidate.product\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"产品编码：\",prop:\"productCode\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.formValidate.productCode,callback:function(t){e.$set(e.formValidate,\"productCode\",t)},expression:\"formValidate.productCode\"}})],1)],1)],1),e._v(\" \"),a(\"center\",[a(\"FormItem\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Button\",{attrs:{type:\"primary\",name:\"marketingManagement_index_edit_search\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\",name:\"marketingManagement_index_edit_reset\"},on:{click:e.handleReset}},[e._v(\"重置\")])],1)],1)],1)],1)],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"ButtonGroup\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.create}},[e._v(\"新增产品\")])],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Col\",{attrs:{span:\"12\"}},[a(\"Table\",{attrs:{loading:e.loading,\"highlight-row\":\"\",border:\"\",size:\"small\",columns:e.header,data:e.data},on:{\"on-current-change\":e.select_row}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.total,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\",current:e.page},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.page_change,\"on-page-size-change\":e.page_size_change}})],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"12\"}},[a(\"product-attr\",{staticStyle:{\"margin-left\":\"5px\"},attrs:{product:e.selectRow}})],1)],1)],1)],1)},[],!1,null,null,null);s.options.__file=\"index.vue\";e.default=s.exports}}]);"}