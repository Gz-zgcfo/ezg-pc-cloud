{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{448:function(t,a,e){},449:function(t,a,e){},706:function(t,a,e){var s={\"./af\":502,\"./af.js\":502,\"./ar\":503,\"./ar-dz\":504,\"./ar-dz.js\":504,\"./ar-kw\":505,\"./ar-kw.js\":505,\"./ar-ly\":506,\"./ar-ly.js\":506,\"./ar-ma\":507,\"./ar-ma.js\":507,\"./ar-sa\":508,\"./ar-sa.js\":508,\"./ar-tn\":509,\"./ar-tn.js\":509,\"./ar.js\":503,\"./az\":510,\"./az.js\":510,\"./be\":511,\"./be.js\":511,\"./bg\":512,\"./bg.js\":512,\"./bm\":513,\"./bm.js\":513,\"./bn\":514,\"./bn.js\":514,\"./bo\":515,\"./bo.js\":515,\"./br\":516,\"./br.js\":516,\"./bs\":517,\"./bs.js\":517,\"./ca\":518,\"./ca.js\":518,\"./cs\":519,\"./cs.js\":519,\"./cv\":520,\"./cv.js\":520,\"./cy\":521,\"./cy.js\":521,\"./da\":522,\"./da.js\":522,\"./de\":523,\"./de-at\":524,\"./de-at.js\":524,\"./de-ch\":525,\"./de-ch.js\":525,\"./de.js\":523,\"./dv\":526,\"./dv.js\":526,\"./el\":527,\"./el.js\":527,\"./en-au\":528,\"./en-au.js\":528,\"./en-ca\":529,\"./en-ca.js\":529,\"./en-gb\":530,\"./en-gb.js\":530,\"./en-ie\":531,\"./en-ie.js\":531,\"./en-il\":532,\"./en-il.js\":532,\"./en-nz\":533,\"./en-nz.js\":533,\"./eo\":534,\"./eo.js\":534,\"./es\":535,\"./es-do\":536,\"./es-do.js\":536,\"./es-us\":537,\"./es-us.js\":537,\"./es.js\":535,\"./et\":538,\"./et.js\":538,\"./eu\":539,\"./eu.js\":539,\"./fa\":540,\"./fa.js\":540,\"./fi\":541,\"./fi.js\":541,\"./fo\":542,\"./fo.js\":542,\"./fr\":543,\"./fr-ca\":544,\"./fr-ca.js\":544,\"./fr-ch\":545,\"./fr-ch.js\":545,\"./fr.js\":543,\"./fy\":546,\"./fy.js\":546,\"./gd\":547,\"./gd.js\":547,\"./gl\":548,\"./gl.js\":548,\"./gom-latn\":549,\"./gom-latn.js\":549,\"./gu\":550,\"./gu.js\":550,\"./he\":551,\"./he.js\":551,\"./hi\":552,\"./hi.js\":552,\"./hr\":553,\"./hr.js\":553,\"./hu\":554,\"./hu.js\":554,\"./hy-am\":555,\"./hy-am.js\":555,\"./id\":556,\"./id.js\":556,\"./is\":557,\"./is.js\":557,\"./it\":558,\"./it.js\":558,\"./ja\":559,\"./ja.js\":559,\"./jv\":560,\"./jv.js\":560,\"./ka\":561,\"./ka.js\":561,\"./kk\":562,\"./kk.js\":562,\"./km\":563,\"./km.js\":563,\"./kn\":564,\"./kn.js\":564,\"./ko\":565,\"./ko.js\":565,\"./ku\":566,\"./ku.js\":566,\"./ky\":567,\"./ky.js\":567,\"./lb\":568,\"./lb.js\":568,\"./lo\":569,\"./lo.js\":569,\"./lt\":570,\"./lt.js\":570,\"./lv\":571,\"./lv.js\":571,\"./me\":572,\"./me.js\":572,\"./mi\":573,\"./mi.js\":573,\"./mk\":574,\"./mk.js\":574,\"./ml\":575,\"./ml.js\":575,\"./mn\":576,\"./mn.js\":576,\"./mr\":577,\"./mr.js\":577,\"./ms\":578,\"./ms-my\":579,\"./ms-my.js\":579,\"./ms.js\":578,\"./mt\":580,\"./mt.js\":580,\"./my\":581,\"./my.js\":581,\"./nb\":582,\"./nb.js\":582,\"./ne\":583,\"./ne.js\":583,\"./nl\":584,\"./nl-be\":585,\"./nl-be.js\":585,\"./nl.js\":584,\"./nn\":586,\"./nn.js\":586,\"./pa-in\":587,\"./pa-in.js\":587,\"./pl\":588,\"./pl.js\":588,\"./pt\":589,\"./pt-br\":590,\"./pt-br.js\":590,\"./pt.js\":589,\"./ro\":591,\"./ro.js\":591,\"./ru\":592,\"./ru.js\":592,\"./sd\":593,\"./sd.js\":593,\"./se\":594,\"./se.js\":594,\"./si\":595,\"./si.js\":595,\"./sk\":596,\"./sk.js\":596,\"./sl\":597,\"./sl.js\":597,\"./sq\":598,\"./sq.js\":598,\"./sr\":599,\"./sr-cyrl\":600,\"./sr-cyrl.js\":600,\"./sr.js\":599,\"./ss\":601,\"./ss.js\":601,\"./sv\":602,\"./sv.js\":602,\"./sw\":603,\"./sw.js\":603,\"./ta\":604,\"./ta.js\":604,\"./te\":605,\"./te.js\":605,\"./tet\":606,\"./tet.js\":606,\"./tg\":607,\"./tg.js\":607,\"./th\":608,\"./th.js\":608,\"./tl-ph\":609,\"./tl-ph.js\":609,\"./tlh\":610,\"./tlh.js\":610,\"./tr\":611,\"./tr.js\":611,\"./tzl\":612,\"./tzl.js\":612,\"./tzm\":613,\"./tzm-latn\":614,\"./tzm-latn.js\":614,\"./tzm.js\":613,\"./ug-cn\":615,\"./ug-cn.js\":615,\"./uk\":616,\"./uk.js\":616,\"./ur\":617,\"./ur.js\":617,\"./uz\":618,\"./uz-latn\":619,\"./uz-latn.js\":619,\"./uz.js\":618,\"./vi\":620,\"./vi.js\":620,\"./x-pseudo\":621,\"./x-pseudo.js\":621,\"./yo\":622,\"./yo.js\":622,\"./zh-cn\":623,\"./zh-cn.js\":623,\"./zh-hk\":624,\"./zh-hk.js\":624,\"./zh-tw\":625,\"./zh-tw.js\":625};function n(t){var a=o(t);return e(a)}function o(t){var a=s[t];if(a+1)return a;var e=new Error(\"Cannot find module '\"+t+\"'\");throw e.code=\"MODULE_NOT_FOUND\",e}n.keys=function(){return Object.keys(s)},n.resolve=o,(t.exports=n).id=706},709:function(t,a,e){\"use strict\";var s=e(448);e.n(s).a},711:function(t,a,e){\"use strict\";var s=e(449);e.n(s).a},836:function(t,a,e){\"use strict\";e.r(a);var s=e(704),n=e(801),o=e(114),i=e(707),l=e.n(i),r=(e(708),{data:function(){return{newMission:{taskName:\"\",taskContent:\"\",planDate:new Date,specificDate:\"\",taskLevel:\"importance\",taskDesCode:\"\",taskKind:\"tkFollow\",taskStage:\"\",followResult:\"\",followUpType:\"\",companyId:\"\",executorId:[]},createLoading:!1,openAddMission:!1,companyLoading:!1,companyList:[],userList:[],allUserList:[],allUserList_map:new Map,taskLevel:[],taskDesCode:[],taskKind:[],taskStage:[],market_status:[],markert_follow_up_type:[],taskLevel_map:new Map,taskDesCode_map:new Map,taskKind_map:new Map,taskStage_map:new Map,market_status_map:new Map,markert_follow_up_type_map:new Map,userLoading:!1,user:\"\",useropen:!1}},methods:{create_task:function(){var a=this;a.createLoading=!0;for(var t=[],e=0;e<a.newMission.executorId.length;e++)t.push(a.allUserList_map.get(a.newMission.executorId[e].toString()));var s={taskName:a.newMission.taskName,companyId:a.newMission.companyId,executorId:a.newMission.executorId.join(\",\"),executorName:t.join(\",\"),taskContent:a.newMission.taskContent,taskLevel:a.newMission.taskLevel,planDate:Object(o.d)(a.newMission.planDate),taskKind:a.newMission.taskKind,taskStage:\"tesUnstarted\",taskLevelName:a.taskLevel_map.get(a.newMission.taskLevel),taskKindName:a.taskKind_map.get(a.newMission.taskKind),taskStageName:\"未开始\",creatorName:localStorage.getItem(\"realname\")};this.$Post(\"api/task/addTask\",s,function(t){a.createLoading=!1,a.openAddMission=!1,a.$bus.emit(\"UPDATE_TASK_LIST_DEMO\",!0),a.cancel_task()},function(t){a.createLoading=!1})},cancel_task:function(){this.$refs.newMission.resetFields()},get_company:function(t){var a=this;a.companyLoading=!0;var e={params:{page:1,pageSize:10,companyname:t}};this.$Get(\"api/customer/company/list\",e,function(t){a.companyLoading=!1,a.companyList=t.data.data.rows})},get_user:function(t){var a=this;a.userLoading=!0;var e={params:{page:1,pageSize:5,realname:t}};this.$Get(\"api/user/list\",e,function(t){a.userLoading=!1,a.userList=t.data.data.rows})},get_data_center:function(){var a=this;this.$GetDataCenter(\"taskLevel,taskDesCode,taskKind,taskStage,market_status,markert_follow_up_type\",function(t){a.taskLevel=t.data.data.taskLevel,a.taskDesCode=t.data.data.taskDesCode,a.taskKind=t.data.data.taskKind,a.taskStage=t.data.data.taskStage,a.market_status=t.data.data.market_status,a.markert_follow_up_type=t.data.data.markert_follow_up_type,a.taskLevel_map=a.$array2map(a.taskLevel),a.taskDesCode_map=a.$array2map(a.taskDesCode),a.taskKind_map=a.$array2map(a.taskKind),a.taskStage_map=a.$array2map(a.taskStage),a.market_status_map=a.$array2map(a.market_status),a.markert_follow_up_type_map=a.$array2map(a.markert_follow_up_type)})},get_all_user:function(){var e=this;this.$Get(\"api/user/list\",{params:{page:1,pageSize:1e3}},function(t){e.userList=t.data.data.rows,e.allUserList=t.data.data.rows;for(var a=0;a<e.allUserList.length;a++)e.allUserList_map.set(e.allUserList[a].id.toString(),e.allUserList[a].realname)})}},created:function(){var a=this;this.get_data_center(),this.get_all_user(),this.$bus.on(\"SCHEDULE_CREATE_TASK\",function(t){a.user=localStorage.getItem(\"id\"),a.newMission.executorId=[],a.newMission.executorId.push(parseInt(a.user)),a.openAddMission=!0,a.newMission.planDate=t})}}),p=e(4),d=Object(p.a)(r,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"Modal\",{attrs:{title:\"新增任务\",width:\"800\",\"mask-closable\":!1},model:{value:e.openAddMission,callback:function(t){e.openAddMission=t},expression:\"openAddMission\"}},[s(\"Form\",{ref:\"newMission\",staticStyle:{\"margin-left\":\"50px\",\"margin-right\":\"50px\"},attrs:{model:e.newMission,\"label-width\":80}},[s(\"FormItem\",{attrs:{label:\"任务名称\",prop:\"taskName\"}},[s(\"Input\",{model:{value:e.newMission.taskName,callback:function(t){e.$set(e.newMission,\"taskName\",t)},expression:\"newMission.taskName\"}})],1),e._v(\" \"),s(\"FormItem\",{attrs:{label:\"任务对象\",prop:\"companyId\"}},[s(\"Select\",{attrs:{placeholder:\"输入公司名称搜索\",filterable:\"\",remote:\"\",\"remote-method\":e.get_company,loading:e.companyLoading},model:{value:e.newMission.companyId,callback:function(t){e.$set(e.newMission,\"companyId\",t)},expression:\"newMission.companyId\"}},e._l(e.companyList,function(t){return s(\"Option\",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.companyname))])}),1)],1),e._v(\" \"),s(\"FormItem\",{attrs:{label:\"执行者\",prop:\"executorId\"}},[s(\"Select\",{attrs:{placeholder:\"执行者\",filterable:\"\",multiple:\"\",remote:\"\",\"remote-method\":e.get_user,loading:e.userLoading},model:{value:e.newMission.executorId,callback:function(t){e.$set(e.newMission,\"executorId\",t)},expression:\"newMission.executorId\"}},e._l(e.userList,function(t){return s(\"Option\",{key:t.id,attrs:{value:t.id,label:t.realname}},[s(\"span\",[e._v(e._s(t.realname))]),e._v(\" \"),s(\"span\",{staticStyle:{float:\"right\",color:\"#ccc\"}},[e._v(e._s(t.departname))])])}),1)],1),e._v(\" \"),s(\"FormItem\",{attrs:{label:\"任务详情\",prop:\"taskContent\"}},[s(\"Input\",{attrs:{type:\"textarea\",rows:3},model:{value:e.newMission.taskContent,callback:function(t){e.$set(e.newMission,\"taskContent\",t)},expression:\"newMission.taskContent\"}})],1),e._v(\" \"),s(\"Row\",{attrs:{gutter:12}},[s(\"Col\",{attrs:{span:\"12\"}},[s(\"FormItem\",{attrs:{label:\"执行时间\",prop:\"planDate\"}},[s(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{type:\"datetime\"},model:{value:e.newMission.planDate,callback:function(t){e.$set(e.newMission,\"planDate\",t)},expression:\"newMission.planDate\"}})],1)],1)],1),e._v(\" \"),s(\"Row\",{attrs:{gutter:12}},[s(\"Col\",{attrs:{span:\"12\"}},[s(\"FormItem\",{attrs:{label:\"任务级别\",prop:\"taskLevel\"}},[s(\"Select\",{attrs:{type:\"text\",transfer:\"\"},model:{value:e.newMission.taskLevel,callback:function(t){e.$set(e.newMission,\"taskLevel\",t)},expression:\"newMission.taskLevel\"}},e._l(e.taskLevel,function(t,a){return s(\"Option\",{key:a,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1),e._v(\" \"),s(\"Col\",{attrs:{span:\"12\"}},[s(\"FormItem\",{attrs:{label:\"任务类型\",prop:\"taskKind\"}},[s(\"Select\",{model:{value:e.newMission.taskKind,callback:function(t){e.$set(e.newMission,\"taskKind\",t)},expression:\"newMission.taskKind\"}},e._l(e.taskKind,function(t,a){return s(\"Option\",{key:a,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1)],1),e._v(\" \"),s(\"Row\",{attrs:{gutter:12}})],1),e._v(\" \"),s(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[s(\"Button\",{attrs:{type:\"primary\",loading:e.createLoading},on:{click:e.create_task}},[e._v(\"新增\")]),e._v(\" \"),s(\"Button\",{attrs:{type:\"ghost\"},on:{click:e.cancel_task}},[e._v(\"清空\")])],1)],1)},[],!1,null,null,null);d.options.__file=\"createTask.vue\";var c=d.exports,_={data:function(){return{openFollowUp:!1,addDetailContent:{content:\"\",followUpType:\"\"},companyInfo:{companyname:\"\",NAME:\"\"},followTypeText:[],followUp_loading:!1,addDetailContentRule:{followUpType:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],content:[{required:!0,message:\"必填项！\",trigger:\"change\",type:\"string\"}]}}},methods:{GetFollowUpType:function(){var s=this;s.followTypeText=[],this.$GetDataCenter(\"markert_follow_up_type\",function(t){for(var a=0;a<t.data.data.markert_follow_up_type.length;a++){var e={};21==t.data.data.markert_follow_up_type[a].typecode||22==t.data.data.markert_follow_up_type[a].typecode||(e.typecode=t.data.data.markert_follow_up_type[a].typecode,e.typename=t.data.data.markert_follow_up_type[a].typename,e.id=t.data.data.markert_follow_up_type[a].id,s.followTypeText.push(e))}})},cancel_workorder_followup:function(){this.$refs.addDetailContent.resetFields()},upload:function(){this.addDetailContent.content&&this.addDetailContent.followUpType?this.submit():this.$Message.fail(\"请补全信息！\")},submit:function(){var a=this;a.followUp_loading=!0;var t={content:a.addDetailContent.content,customerId:a.companyInfo.custId,companyId:a.companyInfo.company_id,followUpType:a.addDetailContent.followUpType};this.$Post(\"api/customer/addCustomerContentNote\",t,function(t){a.cancel_workorder_followup(),a.openFollowUp=!1,a.followUp_loading=!1,a.$bus.emit(\"FINISH_DEAL_WITH_SCHELCE\",!0)},function(t){a.followUp_loading=!1})}},created:function(){var a=this;this.GetFollowUpType(),a.$bus.off(\"OPEN_SCHEDULE_FOLLOWUP\",!0),a.$bus.on(\"OPEN_SCHEDULE_FOLLOWUP\",function(t){a.companyInfo=t,a.openFollowUp=!0})}},u=Object(p.a)(_,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e(\"Modal\",{attrs:{title:\"新增跟进\",width:\"700\"},model:{value:a.openFollowUp,callback:function(t){a.openFollowUp=t},expression:\"openFollowUp\"}},[e(\"Form\",{ref:\"addDetailContent\",attrs:{model:a.addDetailContent,\"label-width\":120,rule:a.addDetailContentRule}},[e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{label:\"公司名称：\"}},[a._v(\"\\n                        \"+a._s(a.companyInfo.companyname)+\"\\n                    \")])],1)],1),a._v(\" \"),e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{label:\"归属客户：\"}},[a._v(\"\\n                        \"+a._s(a.companyInfo.NAME)+\"\\n                    \")])],1)],1),a._v(\" \"),e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"followUpType\",label:\"跟进类型：\"}},[e(\"Select\",{attrs:{transfer:\"\",size:\"small\"},model:{value:a.addDetailContent.followUpType,callback:function(t){a.$set(a.addDetailContent,\"followUpType\",t)},expression:\"addDetailContent.followUpType\"}},a._l(a.followTypeText,function(t){return e(\"Option\",{key:t.typecode,attrs:{value:t.typecode}},[a._v(a._s(t.typename))])}),1)],1)],1)],1),a._v(\" \"),e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[a._v(\"1\")]),a._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"content\",label:\"跟进内容：\"}},[e(\"Input\",{attrs:{type:\"textarea\"},model:{value:a.addDetailContent.content,callback:function(t){a.$set(a.addDetailContent,\"content\",t)},expression:\"addDetailContent.content\"}})],1)],1)],1)],1),a._v(\" \"),e(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[e(\"Button\",{attrs:{type:\"primary\",loading:a.followUp_loading},on:{click:a.upload}},[a._v(\"新增\")]),a._v(\" \"),e(\"Button\",{attrs:{type:\"ghost\"},on:{click:a.cancel_workorder_followup}},[a._v(\"重置\")])],1)],1)},[],!1,null,null,null);u.options.__file=\"createFollowUp.vue\";var m={components:{followUpList:u.exports},data:function(){return{id:\"\",discussLoading:!1,discuss:{rate:5,content:\"\"},loading:!1,openTaskDetail:!1,data:{taskData:[{task_name:\"\",id:\"\",expect_start_date:\"\",task_stage:\"\",plan_date:\"\",company_name:\"\",task_content:\"\",company_id:\"\"}],log:[],discuss:[]},taskStage:[],taskLevel:[],taskDesCode:[],task_memo:\"\",followUpContent:[{userName:\"\",createdate:\"\",followTypeName:\"\",serviceContent:\"\"}]}},computed:{openSubmit:function(){return!this.task_memo}},methods:{get_detail:function(t){var a=this,e={params:{taskId:t}};this.$Get(\"api/task/findTaskDetail\",e,function(t){a.data=t.data.data,t.data.data.taskData[0]?a.get_last_follow_up_content(t.data.data.taskData[0].company_id):a.data={taskData:[{task_name:\"\",id:\"\",expect_start_date:\"\",task_stage:\"\",plan_date:\"\",company_name:\"\",task_content:\"\",company_id:\"\"}],log:[],discuss:[]}})},delete_task:function(){var a=this,t={params:{taskId:a.data.taskData.id}};this.$Get(\"api/task/deleteTask\",t,function(t){a.openTaskDetail=!1})},get_data_center:function(){var a=this;this.$GetDataCenter(\"taskLevel,taskDesCode,taskKind,taskStage,market_status,markert_follow_up_type\",function(t){a.taskLevel=t.data.data.taskLevel,a.taskDesCode=t.data.data.taskDesCode,a.taskStage=t.data.data.taskStage})},before_update_task:function(){var t=this;\"tkFollow\"==t.data.taskData[0].task_kind&&\"tesFinished\"==t.data.taskData[0].task_stage&&null!=t.data.taskData[0].companyname?t.$bus.emit(\"OPEN_SCHEDULE_FOLLOWUP\",{companyname:t.data.taskData[0].companyname,NAME:t.data.taskData[0].custName,company_id:t.data.taskData[0].company_id,custId:t.data.taskData[0].custId}):this.update_task()},update_task:function(){var a=this,t=new FormData;t.append(\"taskId\",a.id),t.append(\"taskStage\",a.data.taskData[0].task_stage),t.append(\"changeReason\",a.task_memo);a.data.taskData[0].id,a.data.taskData[0].task_stage;this.$Post(\"api/task/updateTaskStage\",t,function(t){a.update_content(),a.task_memo=\"\"},function(t){})},update_content:function(){var a=this,t={taskId:a.id,content:a.task_memo,creatorId:localStorage.getItem(\"id\"),creatorName:localStorage.getItem(\"realname\")};this.$Post(\"api/task/addTaskDiscuss\",t,function(t){a.loading=!1,a.get_detail(a.id)},function(t){a.loading=!1})},get_last_follow_up_content:function(t){var a=this,e={params:{companyId:t}};this.$Get(\"api/customer/findLastCustomerContentByCompanyId\",e,function(t){t.data.data&&(a.followUpContent=t.data.data)})},submit_discuss:function(){var a=this;a.discussLoading=!0;var t={taskId:a.id,content:a.discuss.content,evaluation:10*a.discuss.rate,creatorId:localStorage.getItem(\"id\"),creatorName:localStorage.getItem(\"realname\")};this.$Post(\"api/task/addTaskDiscuss\",t,function(t){a.discussLoading=!1,a.get_detail(a.id)},function(t){a.discussLoading=!1})}},created:function(){var a=this;this.$bus.off(\"OPEN_SEHEDULE_DETAIL\",!0),this.$bus.on(\"OPEN_SEHEDULE_DETAIL\",function(t){a.get_data_center(),a.id=t.id,a.get_detail(t.id),a.detail=t,a.openTaskDetail=!0}),this.$bus.off(\"FINISH_DEAL_WITH_SCHELCE\",!0),this.$bus.on(\"FINISH_DEAL_WITH_SCHELCE\",function(t){a.update_task()})}},k=(e(709),Object(p.a)(m,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(\"div\",[s(\"Modal\",{attrs:{title:\"任务详情\",width:\"450\",scrollable:!0,\"class-name\":\"vertical-center-modal\"},model:{value:e.openTaskDetail,callback:function(t){e.openTaskDetail=t},expression:\"openTaskDetail\"}},[s(\"div\",{staticStyle:{\"min-height\":\"90vh\",width:\"400px\"}},[s(\"Row\",[s(\"Col\",{attrs:{span:\"16\"}},[s(\"Input\",{staticStyle:{width:\"100%\"},attrs:{type:\"text\",readonly:\"\"},model:{value:e.data.taskData[0].task_name,callback:function(t){e.$set(e.data.taskData[0],\"task_name\",t)},expression:\"data.taskData[0].task_name\"}})],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"}},[s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"任务对象\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(e._s(e.data.taskData[0].companyname)+\"\\n                        \")])])],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"执行者\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(e._s(e.data.taskData[0].executor_name)+\"\\n                        \")])])],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"任务级别\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"Select\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",disabled:\"\"},model:{value:e.data.taskData[0].task_level,callback:function(t){e.$set(e.data.taskData[0],\"task_level\",t)},expression:\"data.taskData[0].task_level\"}},e._l(e.taskLevel,function(t){return s(\"Option\",{key:t.id,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"任务类型\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(e._s(e.data.taskData[0].task_kind_name))])])],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"开始时间\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"DatePicker\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"datetime\",readonly:\"\"},model:{value:e.data.taskData[0].expect_start_date,callback:function(t){e.$set(e.data.taskData[0],\"expect_start_date\",t)},expression:\"data.taskData[0].expect_start_date\"}})],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"提醒时间\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"DatePicker\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"datetime\",readonly:\"\"},model:{value:e.data.taskData[0].plan_date,callback:function(t){e.$set(e.data.taskData[0],\"plan_date\",t)},expression:\"data.taskData[0].plan_date\"}})],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"任务详情\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"Input\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"textarea\",row:5,readonly:\"\",autosize:\"\"},model:{value:e.data.taskData[0].task_content,callback:function(t){e.$set(e.data.taskData[0],\"task_content\",t)},expression:\"data.taskData[0].task_content\"}})],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"任务状态\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"Select\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\"},model:{value:e.data.taskData[0].task_stage,callback:function(t){e.$set(e.data.taskData[0],\"task_stage\",t)},expression:\"data.taskData[0].task_stage\"}},e._l(e.taskStage,function(t){return s(\"Option\",{key:t.id,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"4\"}},[s(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[e._v(\"任务总结\")])]),e._v(\" \"),s(\"Col\",{attrs:{span:\"20\"}},[s(\"Input\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"textarea\",row:5,placeholder:\"变更状态时，需要填写！（完成时填写总结，取消或终止时请输入原因！）\"},model:{value:e.task_memo,callback:function(t){e.task_memo=t},expression:\"task_memo\"}})],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"40px\"}},[s(\"Button\",{staticStyle:{\"margin-left\":\"40px\"},attrs:{type:\"primary\",disabled:e.openSubmit,loading:e.loading},on:{click:e.before_update_task}},[e._v(\"修改\")])],1)],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"20px\"}},[s(\"Tabs\",{attrs:{value:\"1\",size:\"small\"}},[s(\"TabPane\",{attrs:{label:\"日志\",name:\"1\"}},[s(\"Timeline\",e._l(e.data.log,function(t,a){return s(\"TimelineItem\",{key:a},[s(\"Row\",{attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(t.log_content))]),e._v(\" \"),s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(t.log_date))])],1),e._v(\" \"),t.change_reason?s(\"Row\",{attrs:{gutter:20}},[s(\"Col\",[e._v(\"备注：\"+e._s(t.change_reason))])],1):e._e()],1)}),1)],1),e._v(\" \"),s(\"TabPane\",{attrs:{label:\"讨论\",name:\"2\"}},[s(\"Row\",{staticStyle:{\"padding-bottom\":\"10px\",\"padding-top\":\"5px\"}},[s(\"Input\",{staticStyle:{width:\"90%\",\"padding-right\":\"20px\"},attrs:{size:\"small\",placeholder:\"请输入内容参与讨论！\"},model:{value:e.discuss.content,callback:function(t){e.$set(e.discuss,\"content\",t)},expression:\"discuss.content\"}},[s(\"Button\",{attrs:{slot:\"append\",loading:e.discussLoading,type:\"primary\",size:\"small\"},on:{click:e.submit_discuss},slot:\"append\"},[e._v(\"发送\")])],1),e._v(\" \"),s(\"Rate\",{attrs:{size:\"small\"},model:{value:e.discuss.rate,callback:function(t){e.$set(e.discuss,\"rate\",t)},expression:\"discuss.rate\"}})],1),e._v(\" \"),s(\"Timeline\",e._l(e.data.discuss,function(t,a){return s(\"TimelineItem\",{key:a},[s(\"Row\",{attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(t.creator_name))]),e._v(\" \"),s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(t.creator_date))])],1),e._v(\" \"),s(\"Row\",{staticStyle:{\"margin-top\":\"5px\"},attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"24\"}},[e._v(e._s(t.content))]),e._v(\" \"),s(\"Col\",{attrs:{span:\"12\"}},[s(\"Rate\",{attrs:{disabled:\"\",value:t.evaluation/10,size:\"small\"}})],1)],1)],1)}),1)],1),e._v(\" \"),s(\"TabPane\",{attrs:{label:\"最近跟进\",name:\"3\"}},[s(\"div\",[s(\"Timeline\",[s(\"TimelineItem\",[s(\"Row\",{attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(e.followUpContent.userName))]),e._v(\" \"),s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(e.followUpContent.createdate))])],1),e._v(\" \"),s(\"Row\",{attrs:{gutter:20}},[s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(e.followUpContent.followTypeName))]),e._v(\" \"),s(\"Col\",{attrs:{span:\"12\"}},[e._v(e._s(e.followUpContent.serviceContent))])],1)],1)],1)],1)])],1)],1)],1),e._v(\" \"),s(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})]),e._v(\" \"),s(\"follow-up-list\")],1)},[],!1,null,null,null));k.options.__file=\"detailTask.vue\";var v=k.exports,f={name:\"schedule_index\",components:{FullCalendar:n.a,Datepicker:l.a,CreateTask:c,TaskDetail:v},data:function(){return{rightTop:\"\",rightLeft:\"\",right_click_show:!1,local_date:\"\",openRightHover:!1,top:\"\",left:\"\",click_show:!1,zh:s.a,date:new Date,config:{locale:\"zh-cn\"},events:[],events_temp:[],defaultView:\"month\",hover_local:\"\",oneData:[],rightClickDate:\"\"}},mounted:function(){},methods:{eventSelected:function(t,a,e){this.$bus.emit(\"OPEN_SEHEDULE_DETAIL\",t)},eventDrop:function(t){},eventResize:function(t){},eventCreated:function(t){},eventReceive:function(t){},eventrender:function(t){},dayClick:function(t,a,e){this.date=t._d;var s=Object(o.a)(t);this.get_onedate_data(s)},next:function(){this.$refs.calendar.fireMethod(\"getEventSources\")},change_date:function(t){var a=Object(o.a)(t);this.$refs.calendar.fireMethod(\"changeView\",this.$refs.calendar.fireMethod(\"getView\").type,a),this.get_onedate_data(a)},dayRightClick:function(t,a,e){this.right_click_show=!0,this.rightClickDate=t._d,this.rightTop=a.pageY,this.rightLeft=a.pageX},add_task:function(){this.$bus.emit(\"SCHEDULE_CREATE_TASK\",this.rightClickDate)},close_right_menu:function(){this.right_click_show=!1},mouse_out:function(){this.click_show=!1},mouse_over:function(t,a,e){this.click_show=!0,this.top=a.clientY,this.left=a.clientX,this.hover_local=t},get_date:function(){this.$refs.calendar.fireMethod(\"changeView\",\"agendaDay\",\"2017-06-01\")},get_data:function(){var e=this;this.$Get(\"api/task/list\",{params:{page:1,pageSize:1e3,day:\"\"}},function(t){e.events_temp=t.data.data.rows;for(var a=0;a<e.events_temp.length;a++)e.events_temp[a].start=e.events_temp[a].plan_date,e.events_temp[a].title=e.events_temp[a].task_name,\"tesExecuting\"==e.events_temp[a].task_stage&&(e.events_temp[a].color=\"blue\"),e.events_temp[a].plan_date.slice(0,10)==e.local_date&&(e.events_temp[a].color=\"orange\"),\"tesFinished\"==e.events_temp[a].task_stage&&(e.events_temp[a].color=\"#228B22\"),\"tdOverdue\"==e.events_temp[a].task_des_code&&(e.events_temp[a].color=\"red\"),\"tkClue\"==e.events_temp[a].task_kind&&\"tesFinished\"!=e.events_temp[a].task_stage&&(e.events_temp[a].color=\"#FF7F00\"),\"tkClue\"==e.events_temp[a].task_kind&&\"tesFinished\"==e.events_temp[a].task_stage&&(e.events_temp[a].color=\"#228B22\");e.events=e.events_temp},function(t){})},get_onedate_data:function(t){var a=this,e={params:{page:1,pageSize:1e3,day:this.local_date=t,sortField:\"plan_date\"}};this.$Get(\"api/task/list\",e,function(t){a.oneData=t.data.data.rows},function(t){})}},created:function(){var a=this;a.get_data(),this.local_date=Object(o.a)(new Date),this.get_onedate_data(Object(o.a)(new Date)),a.$bus.on(\"UPDATE_TASK_LIST_DEMO\",function(t){a.get_data(),a.get_onedate_data(Object(o.a)(new Date))})}},g=(e(711),Object(p.a)(f,function(){var a=this,t=a.$createElement,e=a._self._c||t;return e(\"div\",{staticStyle:{\"min-width\":\"1300px\"},on:{click:a.close_right_menu}},[a.right_click_show?e(\"Button\",{staticStyle:{position:\"fixed\",\"z-index\":\"9000\"},style:{top:a.rightTop+\"px\",left:a.rightLeft+\"px\"},attrs:{type:\"primary\"},on:{click:a.add_task}},[a._v(\"新增日程\")]):a._e(),a._v(\" \"),e(\"Card\",{attrs:{title:\"日程表\"}},[a.click_show?e(\"Card\",{staticStyle:{width:\"400px\",position:\"fixed\",\"z-index\":\"9999\"},style:{top:a.top+\"px\",left:a.left+\"px\"}},[e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[a._v(\"任务对象：\")])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[a._v(a._s(a.hover_local.companyName))])])],1),a._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[a._v(\"任务详情：\")])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[a._v(a._s(a.hover_local.task_content))])])],1),a._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[a._v(\"执行人：\")])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[a._v(a._s(a.hover_local.executor_name))])])],1),a._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[a._v(\"创建人：\")])]),a._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[a._v(a._s(a.hover_local.realname))])])],1)],1):a._e(),a._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"18\"}},[e(\"full-calendar\",{ref:\"calendar\",attrs:{events:a.events,config:a.config,defaultView:a.defaultView,editable:!1},on:{\"event-selected\":a.eventSelected,\"day-click\":a.dayClick,\"day-right-click\":a.dayRightClick,\"event-mouseover\":a.mouse_over,\"event-mouseout\":a.mouse_out}})],1),a._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[e(\"Row\",{staticStyle:{height:\"340px\"}},[e(\"datepicker\",{attrs:{inline:!0,language:a.zh},on:{selected:a.change_date},model:{value:a.date,callback:function(t){a.date=t},expression:\"date\"}})],1),a._v(\" \"),e(\"Row\",[e(\"span\",[a._v(\"执行中的任务--蓝色\"),e(\"br\")]),a._v(\" \"),e(\"span\",[a._v(\"当天需要完结的任务--黄色\"),e(\"br\")]),a._v(\" \"),e(\"span\",[a._v(\"完结任务--绿色\"),e(\"br\")]),a._v(\" \"),e(\"span\",[a._v(\"逾期任务--红色\"),e(\"br\")]),a._v(\" \"),e(\"span\",[a._v(\"线索未完成--橙色\"),e(\"br\")]),a._v(\" \"),e(\"span\",[a._v(\"线索完成--绿色\"),e(\"br\")])]),a._v(\" \"),e(\"Row\",[e(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[e(\"h3\",[a._v(a._s(a.local_date))])]),a._v(\" \"),e(\"Row\",[e(\"Scroll\",{attrs:{height:\"520\"}},[e(\"Timeline\",a._l(a.oneData,function(t){return e(\"TimelineItem\",{key:t.id},[e(\"p\",{staticClass:\"time\"},[a._v(a._s(t.plan_date.slice(10)))]),a._v(\" \"),e(\"p\",{staticClass:\"content\"},[a._v(a._s(t.task_name))])])}),1)],1)],1)],1)],1)],1)],1),a._v(\" \"),e(\"create-task\"),a._v(\" \"),e(\"task-detail\")],1)},[],!1,null,null,null));g.options.__file=\"index.vue\";a.default=g.exports}}]);"}