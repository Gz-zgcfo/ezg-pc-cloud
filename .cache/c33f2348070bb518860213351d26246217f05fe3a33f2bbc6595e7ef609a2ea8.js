{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{849:function(e,t,a){\"use strict\";a.r(t);var l=a(53),i=a(802),s=a(114),r={name:\"fieldWarning_index\",components:{companyDetail:i.default},data:function(){var a=this;return{service_record_status:\"\",service_record_status_Map:new Map,fieldClockType:\"\",fieldClockType_Map:new Map,loading:!1,current_row:\"\",openFiedDetail:!1,fiedDetail:{},search_model:\"\",pageTotal:new Number,page:1,pageSize:10,searchModel:{companyname:\"\",name:\"\",tel:\"\",createdate:[],updatedate:[],realname:\"\",departname:\"\"},data:[],imgList:[],header:[{title:\"公司\",key:\"companyname\",width:300},{title:\"客户\",key:\"name\",width:120},{title:\"客户电话\",key:\"tel\",width:120},{title:\"部门\",key:\"departname\",width:120},{title:\"打卡类型\",key:\"fieldClockTypeName\",width:120},{title:\"打卡地址\",key:\"address1\",width:210,render:function(e,t){return\"\"==t.row.address1||null==t.row.address1?\"\":13<t.row.address1.length?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.address1.slice(0,13)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.address1)])]):e(\"span\",t.row.address1)}},{title:\"开始打卡时间\",key:\"clocktime\",width:160},{title:\"离开打卡时间\",key:\"endtime\",width:160},{title:\"外勤时长\",key:\"fieldlength\",width:120},{title:\"打卡人\",key:\"realname\",width:120},{title:\"外勤结果\",key:\"service_record_statusName\",width:120},{title:\"总结\",key:\"remark\",width:150},{title:\"外勤类型\",key:\"assiststatus\",width:150},{title:\"操作\",key:\"action\",fixed:\"right\",width:100,align:\"center\",render:function(e,t){return e(\"div\",[e(\"Button\",{props:{type:\"text\",size:\"small\"},on:{click:function(){a.$store.commit(\"open_gobal_customer_detail_modal\",{ID:t.row.customerid})}}},\"[客户详情]\")])}}]}},methods:{getData:function(){var a=this;this.loading=!0;var e={params:{page:a.page,pageSize:a.pageSize,companyname:a.searchModel.companyname,name:a.searchModel.name,tel:a.searchModel.tel,bcreatedate:Object(s.a)(a.searchModel.createdate[0]),ecreatedate:Object(s.a)(a.searchModel.createdate[1]),bupdatedate:Object(s.a)(a.searchModel.updatedate[0]),eupdatedate:Object(s.a)(a.searchModel.updatedate[1]),realname:a.searchModel.realname,departname:a.searchModel.departname,sortField:\"clocktime\"}};this.$Get(\"api/legwork/legworkList\",e,function(e){a.loading=!1,a.pageTotal=e.data.data.total,a.data=e.data.data.rows;for(var t=0;t<a.data.length;t++)a.data[t].fieldClockTypeName=a.fieldClockType_Map.get(a.data[t].fieldtype),a.data[t].service_record_statusName=a.service_record_status_Map.get(a.data[t].resulttype),\"\"==a.data[t].assiststatus||\"N\"==a.data[t].assiststatus?a.data[t].assiststatus=\"非协助外勤\":a.data[t].assiststatus=\"协助外勤\"},function(e){a.loading=!1})},getDetail:function(){var t=this,e={params:{legworkId:t.current_row.id}};this.$Get(\"api/legwork/checkLegwork\",e,function(e){t.fiedDetail=e.data.data[0],t.imgList=e.data.data[1].realpath},function(e){})},downloadExcel:function(){var e=this,t={page:\"1\",pageSize:\"1000000\",companyname:e.searchModel.companyname,name:e.searchModel.name,tel:e.searchModel.tel,bcreatedate:Object(s.a)(e.searchModel.createdate[0]),ecreatedate:Object(s.a)(e.searchModel.createdate[1]),bupdatedate:Object(s.a)(e.searchModel.updatedate[0]),eupdatedate:Object(s.a)(e.searchModel.updatedate[1]),realname:e.searchModel.realname,departname:e.searchModel.departname,export:\"Y\",sortField:\"clocktime\",exportField:encodeURI(JSON.stringify([{field:\"companyname\",title:\"公司名称\"},{field:\"name\",title:\"姓名\"},{field:\"departname\",title:\"部门\"},{field:\"fieldtype\",title:\"打卡类型\",format:\"fieldClockType\"},{field:\"address1\",title:\"打卡地址\"},{field:\"clocktime\",title:\"开始打卡时间\"},{field:\"endtime\",title:\"离开打卡时间\"},{field:\"fieldlength\",title:\"外勤时长\"},{field:\"realname\",title:\"打卡人\"},{field:\"remark\",title:\"总结\"},{field:\"service_record_status\",title:\"外勤结果\",format:\"field_total\"},{field:\"assiststatus\",title:\"外勤类型\"}]))},a=this.$MergeURL(\"api/legwork/legworkList\",t);window.open(a)},reset:function(){this.page=1,this.$refs.searchModel.resetFields(),this.getData()},search:function(){this.page=1,this.getData()},pageChange:function(e){this.page=e,this.getData()},pageSizeChange:function(e){this.pageSize=e,this.getData()},selectrow:function(e){this.current_row=e},openShow:function(){\"\"==this.current_row||null==this.current_row?this.$Message.warning(\"请选择一行进行查看！\"):(this.openFiedDetail=!0,this.getDetail())},getDataCenter:function(){var t=this;this.$GetDataCenter(\"fieldClockType,field_total\",function(e){t.fieldClockType=e.data.data.fieldClockType,t.service_record_status=e.data.data.field_total,t.fieldClockType_Map=t.$array2map(t.fieldClockType),t.service_record_status_Map=t.$array2map(t.service_record_status)})}},mounted:function(){},created:function(){this.getData(),this.getDataCenter()}},o=a(4),n=Object(o.a)(r,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:t.search_model,callback:function(e){t.search_model=e},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),t._v(\"\\n                筛选\\n                    \"),t._v(\" \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.search(e):null}},slot:\"content\"},[a(\"Form\",{ref:\"searchModel\",attrs:{model:t.searchModel,\"label-width\":100}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"companyname\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:t.searchModel.companyname,callback:function(e){t.$set(t.searchModel,\"companyname\",e)},expression:\"searchModel.companyname\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"name\",label:\"客户名称：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:t.searchModel.name,callback:function(e){t.$set(t.searchModel,\"name\",e)},expression:\"searchModel.name\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"tel\",label:\"客户电话：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:t.searchModel.tel,callback:function(e){t.$set(t.searchModel,\"tel\",e)},expression:\"searchModel.tel\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"departname\",label:\"服务部门：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:t.searchModel.departname,callback:function(e){t.$set(t.searchModel,\"departname\",e)},expression:\"searchModel.departname\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"createdate\",label:\"打卡时间：\"}},[a(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",type:\"daterange\",placement:\"bottom-start\",size:\"small\"},model:{value:t.searchModel.createdate,callback:function(e){t.$set(t.searchModel,\"createdate\",e)},expression:\"searchModel.createdate\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"updatedate\",label:\"离开时间：\"}},[a(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",type:\"daterange\",placement:\"bottom-start\",size:\"small\"},model:{value:t.searchModel.updatedate,callback:function(e){t.$set(t.searchModel,\"updatedate\",e)},expression:\"searchModel.updatedate\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"realname\",label:\"服务人员：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:t.searchModel.realname,callback:function(e){t.$set(t.searchModel,\"realname\",e)},expression:\"searchModel.realname\"}})],1)],1)],1),t._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:t.search}},[t._v(\"搜索\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:t.reset}},[t._v(\"重置\")])],1)],1)],1)],1)],1)],1),t._v(\" \"),a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:t.openShow}},[t._v(\"查看\")]),t._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:t.downloadExcel}},[t._v(\"导出Excel\")])],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",loading:t.loading,columns:t.header,data:t.data},on:{\"on-current-change\":t.selectrow,\"on-row-dblclick\":t.openShow}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:t.pageTotal,current:t.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\",placement:\"top\"},on:{\"update:current\":function(e){t.page=e},\"on-change\":t.pageChange,\"on-page-size-change\":t.pageSizeChange}})],1)],1),t._v(\" \"),a(\"Modal\",{attrs:{title:\"外勤详情\",width:\"700\"},on:{\"on-cancel\":function(e){t.openFiedDetail=!1}},model:{value:t.openFiedDetail,callback:function(e){t.openFiedDetail=e},expression:\"openFiedDetail\"}},[a(\"Row\",[a(\"Form\",{ref:\"fiedDetail\",attrs:{model:t.fiedDetail,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"companyname\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.companyname,callback:function(e){t.$set(t.fiedDetail,\"companyname\",e)},expression:\"fiedDetail.companyname\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"name\",label:\"客户名称：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.name,callback:function(e){t.$set(t.fiedDetail,\"name\",e)},expression:\"fiedDetail.name\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"tel\",label:\"客户电话：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.tel,callback:function(e){t.$set(t.fiedDetail,\"tel\",e)},expression:\"fiedDetail.tel\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"clocktime\",label:\"上门时间：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.clocktime,callback:function(e){t.$set(t.fiedDetail,\"clocktime\",e)},expression:\"fiedDetail.clocktime\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"endtime\",label:\"离开时间：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.endtime,callback:function(e){t.$set(t.fiedDetail,\"endtime\",e)},expression:\"fiedDetail.endtime\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"fieldlength\",label:\"外勤时长：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.fieldlength,callback:function(e){t.$set(t.fiedDetail,\"fieldlength\",e)},expression:\"fiedDetail.fieldlength\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"assiststatus\",label:\"外勤类型：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.assiststatus,callback:function(e){t.$set(t.fiedDetail,\"assiststatus\",e)},expression:\"fiedDetail.assiststatus\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"clockshows\",label:\"打卡说明：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.clockshows,callback:function(e){t.$set(t.fiedDetail,\"clockshows\",e)},expression:\"fiedDetail.clockshows\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"startAddress\",label:\"第一次打卡地址：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.startAddress,callback:function(e){t.$set(t.fiedDetail,\"startAddress\",e)},expression:\"fiedDetail.startAddress\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"endAddress\",label:\"第二次打卡地址：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.endAddress,callback:function(e){t.$set(t.fiedDetail,\"endAddress\",e)},expression:\"fiedDetail.endAddress\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"remark\",label:\"备注总结：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:t.fiedDetail.remark,callback:function(e){t.$set(t.fiedDetail,\"remark\",e)},expression:\"fiedDetail.remark\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{margin:\"5px\"},attrs:{prop:\"Providentfund\",label:\"附件：\",disabled:\"\"}},t._l(t.imgList,function(e,t){return a(\"Row\",{key:t},[a(\"a\",{attrs:{target:\"_blank\",href:\"/api/assets/\"+e.realpath}},[a(\"img\",{attrs:{src:\"/api/assets/\"+e.realpath,alt:\"\",width:\"100\",height:\"100\",onerror:\"this.src='/api/assets/upload/commonImg/error.jpg';this.onerror=null\"}})])])}),1)],1)],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);n.options.__file=\"commonFiedManagement.vue\";var d={name:\"commonfieldmanagement_index\",components:{commonField:n.exports},data:function(){return{}},methods:{pageChange:function(e){this.page=e,this.getData()},pageSizeChange:function(e){this.pageSize=e,this.getData()},getData:function(){var t=this;this.loading=!0;var e={params:{warningId:t.id,page:t.page,pageSize:t.pageSize}};this.$Get(\"api/legwork/checkCompanyMsg\",e,function(e){t.open_detail=!0,t.loading=!1,t.data=e.data.data.rows,t.pageTotal=e.data.data.total},function(e){t.loading=!1})}},created:function(){var t=this;l.a.$on(\"Open_field_Working\",function(e){t.page=1,t.pageSize=10,t.id=e,t.getData()})}},c=Object(o.a)(d,function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",[t(\"common-field\")],1)},[],!1,null,null,null);c.options.__file=\"commonFieldIndex.vue\";t.default=c.exports}}]);"}