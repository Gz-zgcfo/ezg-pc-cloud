{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{467:function(e,a,t){\"use strict\";t.r(a);var n={name:\"channelType_index\",data:function(){var e=this;return{searchLabel:\"\",isSearch:!1,UsersearchformInline:{realname:\"\",mobilephone:\"\"},user_search:!1,loading:!0,isAdd:!1,isQd:!1,isEdit:!1,addType:!1,addCannelUser:!1,page:1,pageSize:10,pageTotal:new Number,pageq:1,pageSizeq:10,pageTotalq:new Number,pagea:1,pageSizea:10,pageTotala:new Number,pagex:1,pageSizex:10,pageTotalx:new Number,title:\"\",channelId:\"\",channelName:\"\",channelCode:\"\",qudao:\"\",single:!1,data:[],data2:[],data3:[],data4:[],formValidate:{channelTypeName:\"\",channelTypeCode:\"\"},ruleValidate:{channelTypeName:[{required:!0,message:\"请填写渠道名称\",trigger:\"blur\"}],channelTypeCode:[{required:!0,message:\"请填写渠道编码\",trigger:\"blur\"}]},columns:[{title:\"渠道编码\",key:\"channel_type_code\",width:160},{title:\"渠道名称\",key:\"channel_type_name\",width:160},{title:\"操作\",key:\"action\",fixed:\"right\",width:70,align:\"center\",render:function(a,t){return a(\"div\",[a(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){e.getUser(t.row.id)}}},\"用户\")])}}],columns2:[{title:\"用户id\",key:\"user_id\",width:160},{title:\"真实姓名\",key:\"userRealName\",width:160},{title:\"操作\",key:\"action\",fixed:\"right\",width:70,align:\"center\",render:function(a,t){return a(\"div\",[a(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){e.deleteUser(t)}}},\"删除\")])}}],columns3:[{title:\"用户名\",key:\"username\"},{title:\"真实姓名\",key:\"realname\"},{title:\"电话\",key:\"mobilephone\"}],columns4:[{title:\"用户id\",key:\"user_id\"},{title:\"真实姓名\",key:\"userRealName\"},{title:\"操作\",key:\"action\",fixed:\"right\",width:70,align:\"center\",render:function(a,t){return a(\"div\",[a(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){e.deleteUser(t)}}},\"删除\")])}}],searchformInline:{channelTypeName:\"\"}}},methods:{searchLabelData:function(){\"\"==this.searchLabel?this.isSearch=!1:this.isSearch=!0,this.getTableData()},search_channel:function(){this.page=1,this.getTableData()},reset_channel:function(){this.searchformInline.channelTypeName=\"\",this.page=1,this.getTableData()},getTableData:function(){var e=this;if(\"\"==e.searchLabel)var a=\"/channel/type/list?page=\"+e.page+\"&pageSize=\"+e.pageSize;else a=\"/channel/type/list?page=\"+e.page+\"&pageSize=\"+e.pageSize+\"&channelTypeName=\"+e.searchLabel;this.GetData(a,function(a){var t=a.data.data;e.pageTotal=t.total,e.data=[];for(var n=0;n<t.rows.length;n++)e.data.push({id:t.rows[n].id,channel_type_code:t.rows[n].channel_type_code,channel_type_name:t.rows[n].channel_type_name})})},postAdd:function(e){var a=this,t=this;setTimeout(function(){t.loading=!1,t.$refs[e].validate(function(e){if(e){var n;1==t.isAdd?n=\"/channel/type/create\":1==t.isEdit&&(n=\"/channel/type/update\",t.formValidate.id=t.channelId),a.PostData(n,t.formValidate,function(e){t.loading=!0,t.$Message.success(\"提交成功\"),t.addType=!1,t.channelId=\"\",t.cancel(\"formValidate\"),t.getTableData()},function(e){t.$nextTick(function(){t.loading=!0}),t.$Message.error(\"提交失败!\")})}})},2e3)},cancel:function(e){this.isAdd=!1,this.isEdit=!1,this.$refs[e].resetFields()},selectRow:function(e){this.channelId=e.id,this.channelName=e.channel_type_name,this.channelCode=e.channel_type_code},addT:function(){this.title=\"新增\",this.isAdd=!0,this.addType=!0},TypeEdit:function(){\"\"==this.channelId?this.$Message.warning(\"请选择要编辑的渠道类型\"):(this.title=\"编辑\",this.isEdit=!0,this.formValidate.channelTypeCode=this.channelCode,this.formValidate.channelTypeName=this.channelName,this.addType=!0)},deleteType:function(){var e=this,a=this;\"\"==a.channelId?a.$Message.warning(\"请选择要删除的渠道类型\"):a.$Modal.confirm({title:\"删除\",content:\"<p>是否删除该渠道类型</p>\",onOk:function(){var t={id:a.channelId};e.PostData(\"/channel/type/del\",t,function(){a.getTableData(),a.$Message.success(\"删除成功\")})}})},pageChange:function(e){this.page=e,this.getTableData()},pageSizeChange:function(e){this.pageSize=e,this.getTableData()},getUser:function(e){var a=this,t=\"/channel/user/list?page=\"+a.pageq+\"&pageSize=\"+a.pageSizeq+\"&channelTypeId=\"+e+\"&type=qdyh\",n=\"/channel/user/list?page=\"+a.pageq+\"&pageSize=\"+a.pageSizeq+\"&channelTypeId=\"+e+\"&type=xs\";this.GetData(t,function(e){var t=e.data.data;a.data2=[],a.pageTotalq=t.total;for(var n=0;n<t.rows.length;n++)a.data2.push({id:t.rows[n].id,channel_type_id:t.rows[n].channel_type_id,user_id:t.rows[n].user_id,userRealName:t.rows[n].userRealName})}),this.GetData(n,function(e){var t=e.data.data;a.data4=[],a.pageTotalx=t.total;for(var n=0;n<t.rows.length;n++)a.data4.push({id:t.rows[n].id,channel_type_id:t.rows[n].channel_type_id,user_id:t.rows[n].user_id,userRealName:t.rows[n].userRealName})})},pageChangeq:function(e){this.pageq=e,this.getUser(this.channelId)},pageSizeChangeq:function(e){this.pageSizeq=e,this.getUser(this.channelId)},pageChangex:function(e){this.pagex=e,this.getUser(this.channelId)},pageSizeChangex:function(e){this.pageSizex=e,this.getUser(this.channelId)},addq:function(e){this.qudao=e,\"qd\"==this.qudao?this.isQd=!0:this.isQd=!1,this.getuserlist()},usersearch:function(){0==this.user_search&&(this.pagea=1),this.user_search=!0,this.getuserlist()},userreset:function(){this.UsersearchformInline.realname=\"\",this.UsersearchformInline.mobilephone=\"\",this.pagea=1,this.getuserlist(),this.user_search=!1},clean:function(){this.UsersearchformInline.realname=\"\",this.UsersearchformInline.mobilephone=\"\"},pageChangea:function(e){this.pagea=e,this.addq(this.qudao)},pageSizeChangea:function(e){this.pageSizea=e,this.addq(this.qudao)},getuserlist:function(){var e=this,a={params:{rolecode:1==e.isQd?\"jianzhi\":\"salers\",page:e.pagea,pageSize:e.pageSizea,realname:e.UsersearchformInline.realname,mobilephone:e.UsersearchformInline.mobilephone}};for(var t in e.UsersearchformInline)\"\"!=e.UsersearchformInline[t]&&null!=e.UsersearchformInline[t]||delete a.params[t];this.$http.get(\"api/user/list\",a).then(function(a){!function(a){var t=a.data.data;e.addCannelUser=!0,e.pageTotala=t.total,e.data3=[];for(var n=0;n<t.rows.length;n++)e.data3.push({id:t.rows[n].id,mobilephone:t.rows[n].mobilephone,realname:t.rows[n].realname,username:t.rows[n].username})}(a)})},deleteUser:function(e){var a=this,t={id:e.row.id};this.PostData(\"/channel/user/del\",t,function(){a.pageq=1,a.getUser(e.row.channel_type_id),a.$Message.success(\"删除成功\")})},addUserClick:function(e){var a,t=this,n=\"/channel/user/create\",i={},s={};1==t.isQd?i={channelTypeId:t.channelId,userId:e.id,type:\"qdyh\"}:(a=1==t.single?\"Y\":\"N\",s={channelTypeId:t.channelId,userId:e.id,type:\"xs\",manager:a});function l(e){t.getUser(t.channelId),t.addCannelUser=!1,t.single=!1,t.$Message.success(\"添加成功\")}function r(e){t.$Message.warning(e.data.msg),t.single=!1}1==t.isQd?this.PostData(n,i,l,r):this.PostData(n,s,l,r)}},mounted:function(){this.getTableData()}},i=t(2),s=Object(i.a)(n,function(){var e=this,a=e.$createElement,t=e._self._c||a;return t(\"div\",[t(\"Row\",[t(\"Col\",{attrs:{span:\"11\"}},[t(\"Card\",[t(\"Row\",[t(\"ButtonGroup\",[t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.add\"],expression:\"['channelT.add']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:e.addT}},[e._v(\"新增\")]),e._v(\" \"),t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.edit\"],expression:\"['channelT.edit']\"}],attrs:{type:\"primary\",icon:\"edit\"},on:{click:e.TypeEdit}},[e._v(\"编辑\")]),e._v(\" \"),t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.delete\"],expression:\"['channelT.delete']\"}],attrs:{type:\"primary\",icon:\"edit\"},on:{click:e.deleteType}},[e._v(\"删除\")])],1),e._v(\" \"),t(\"Col\",{staticStyle:{float:\"right\"},attrs:{span:\"6\"}},[t(\"Input\",{attrs:{placeholder:\"输入标签名称搜索\"},on:{\"on-keydown\":function(a){return\"button\"in a||!e._k(a.keyCode,\"enter\",13,a.key,\"Enter\")?e.searchLabelData(a):null}},model:{value:e.searchLabel,callback:function(a){e.searchLabel=a},expression:\"searchLabel\"}},[t(\"Button\",{attrs:{slot:\"append\",icon:\"ios-search\"},on:{click:e.searchLabelData},slot:\"append\"})],1)],1)],1),e._v(\" \"),t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:e.columns,data:e.data},on:{\"on-current-change\":e.selectRow,\"on-row-dblclick\":e.TypeEdit}}),e._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotal,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":e.pageChange,\"on-page-size-change\":e.pageSizeChange}})],1)],1)],1),e._v(\" \"),\"\"!=e.channelId?t(\"Col\",{attrs:{span:\"11\"}},[t(\"Card\",[t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Tabs\",{attrs:{value:\"name1\"}},[t(\"TabPane\",{attrs:{label:\"渠道用户\",name:\"name1\"}},[t(\"Row\",[t(\"ButtonGroup\",[t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.cannel.add\"],expression:\"['channelT.cannel.add']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:function(a){e.addq(\"qd\")}}},[e._v(\"新增\")])],1)],1),e._v(\" \"),t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",border:\"\",columns:e.columns2,data:e.data2,size:\"small\"}}),e._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotalq,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":e.pageChangeq,\"on-page-size-change\":e.pageSizeChangeq}})],1)],1),e._v(\" \"),t(\"TabPane\",{attrs:{label:\"销售\",name:\"name2\"}},[t(\"Row\",[t(\"ButtonGroup\",[t(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"channelT.sales.add\"],expression:\"['channelT.sales.add']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:function(a){e.addq(\"xs\")}}},[e._v(\"新增\")])],1)],1),e._v(\" \"),t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",border:\"\",columns:e.columns4,data:e.data4,size:\"small\"}}),e._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotalx,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"on-change\":e.pageChangex,\"on-page-size-change\":e.pageSizeChangex}})],1)],1)],1)],1)],1)],1):e._e()],1),e._v(\" \"),t(\"Modal\",{attrs:{title:e.title,loading:e.loading,width:\"40%\"},on:{\"on-ok\":function(a){e.postAdd(\"formValidate\")},\"on-cancel\":function(a){e.cancel(\"formValidate\")}},model:{value:e.addType,callback:function(a){e.addType=a},expression:\"addType\"}},[t(\"Form\",{ref:\"formValidate\",attrs:{rules:e.ruleValidate,model:e.formValidate,\"label-width\":90}},[t(\"FormItem\",{attrs:{label:\"渠道名称\",prop:\"channelTypeName\"}},[t(\"Input\",{attrs:{size:\"small\"},model:{value:e.formValidate.channelTypeName,callback:function(a){e.$set(e.formValidate,\"channelTypeName\",a)},expression:\"formValidate.channelTypeName\"}})],1),e._v(\" \"),t(\"FormItem\",{attrs:{label:\"渠道编码\",prop:\"channelTypeCode\"}},[t(\"Input\",{attrs:{size:\"small\"},model:{value:e.formValidate.channelTypeCode,callback:function(a){e.$set(e.formValidate,\"channelTypeCode\",a)},expression:\"formValidate.channelTypeCode\"}})],1)],1)],1),e._v(\" \"),t(\"Modal\",{attrs:{title:\"新增\",width:\"40%\"},on:{\"on-cancel\":e.clean},model:{value:e.addCannelUser,callback:function(a){e.addCannelUser=a},expression:\"addCannelUser\"}},[t(\"Row\",[t(\"Col\",{attrs:{span:\"12\"}},[e.isQd?e._e():t(\"Checkbox\",{model:{value:e.single,callback:function(a){e.single=a},expression:\"single\"}},[t(\"Icon\",{attrs:{type:\"information-circled\"}}),e._v(\" \"),t(\"span\",[e._v(\"是否设置该销售为主要负责人\")])],1),e._v(\" \"),t(\"div\",{staticStyle:{visibility:\"hidden\"}},[e._v(\"..\")])],1),e._v(\" \"),t(\"Col\",{attrs:{span:\"12\"}},[t(\"Poptip\",{staticStyle:{float:\"right\"},attrs:{trigger:\"click\",title:\"筛选\",placement:\"bottom-end\"}},[t(\"Button\",{attrs:{type:\"text\",icon:\"funnel\"}},[e._v(\"筛选\")]),e._v(\" \"),t(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(a){return\"button\"in a||!e._k(a.keyCode,\"enter\",13,a.key,\"Enter\")?e.usersearch(a):null}},slot:\"content\"},[t(\"Form\",{ref:\"UsersearchformInline\",attrs:{model:e.UsersearchformInline,\"label-width\":60}},[t(\"Row\",[t(\"FormItem\",{attrs:{prop:\"realname\",label:\"真实姓名：\"}},[t(\"Input\",{staticStyle:{width:\"180px\"},attrs:{type:\"text\",placeholder:\"\"},model:{value:e.UsersearchformInline.realname,callback:function(a){e.$set(e.UsersearchformInline,\"realname\",a)},expression:\"UsersearchformInline.realname\"}})],1)],1),e._v(\" \"),t(\"Row\",[t(\"FormItem\",{attrs:{prop:\"mobilephone\",label:\"电话：\"}},[t(\"Input\",{staticStyle:{width:\"180px\"},attrs:{type:\"text\",placeholder:\"\"},model:{value:e.UsersearchformInline.mobilephone,callback:function(a){e.$set(e.UsersearchformInline,\"mobilephone\",a)},expression:\"UsersearchformInline.mobilephone\"}})],1)],1),e._v(\" \"),t(\"FormItem\",[t(\"Button\",{attrs:{type:\"primary\"},on:{click:e.usersearch}},[e._v(\"搜索\")]),e._v(\" \"),t(\"Button\",{staticStyle:{\"margin-left\":\"20px\",\"margin-bottom\":\"0\"},attrs:{type:\"ghost\"},on:{click:e.userreset}},[e._v(\"重置\")])],1)],1)],1)],1)],1)],1),e._v(\" \"),t(\"Table\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{\"highlight-row\":\"\",columns:e.columns3,data:e.data3,size:\"small\"},on:{\"on-row-dblclick\":e.addUserClick}}),e._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotala,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\",current:e.pagea},on:{\"on-change\":e.pageChangea,\"on-page-size-change\":e.pageSizeChangea,\"update:current\":function(a){e.pagea=a}}}),e._v(\" \"),t(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);s.options.__file=\"channelType_index.vue\";a.default=s.exports}}]);"}