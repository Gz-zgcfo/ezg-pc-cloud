{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{159:function(e,t,a){},160:function(e,t,a){},332:function(e,t,a){\"use strict\";var n=a(159);a.n(n).a},334:function(e,t,a){\"use strict\";var n=a(160);a.n(n).a},391:function(e,t,a){\"use strict\";a.r(t);new(a(1).default);var n={data:function(){return{formInline:{companyName:\"\",ordercode:\"\",createbyname:\"\"}}},methods:{search:function(){this.$bus.emit(\"search1\",this.formInline)},reset:function(){this.formInline.companyName=\"\",this.formInline.ordercode=\"\",this.formInline.createbyname=\"\",this.$bus.emit(\"reset1\",!0)}}},o=a(2),r=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.search(t):null}}},[a(\"Form\",{ref:\"formInline\",attrs:{model:e.formInline,\"label-width\":80}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"companyName\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.companyName,callback:function(t){e.$set(e.formInline,\"companyName\",t)},expression:\"formInline.companyName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"orderId\",label:\"订单编号：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.ordercode,callback:function(t){e.$set(e.formInline,\"ordercode\",t)},expression:\"formInline.ordercode\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"createbyname\",label:\"销售人员：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.createbyname,callback:function(t){e.$set(e.formInline,\"createbyname\",t)},expression:\"formInline.createbyname\"}})],1)],1)],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:e.reset}},[e._v(\"重置\")])],1)],1)],1)},[],!1,null,null,null);r.options.__file=\"search.vue\";var i=r.exports,l={data:function(){return{show:\"1\",display:!1,balanceId:\"\",hadformValidate:{companyName:\"\",customerName:\"\",totalamount:\"\",paynumber:\"\",unpaidamount:\"\",approvalpendingamount:\"\"},balanceItem:[],header:[{title:\"序号\",type:\"index\",align:\"center\",width:60},{title:\"补交金额\",key:\"transcationamount\"},{title:\"当前状态\",key:\"processtype\"},{title:\"缴费渠道\",key:\"paydir\"},{title:\"缴费时间\",key:\"transcationtime\"},{title:\"财务确认时间\",key:\"confirmtime\"},{title:\"确认收款人\",key:\"userName\"}]}},methods:{init:function(){var e=this;this.$bus.on(\"select_had_pay\",function(t){e.show=\"1\",e.display=!0,e.balanceId=t,e.GetBalanceIdDate()})},GetBalanceIdDate:function(){var e=this,t=\"api/order/balance/detail?balanceId=\"+e.balanceId;this.$http.get(t).then(function(t){var a=t.data.data;e.hadformValidate=a.balance[0],e.balanceItem=a.balanceItem,e.balanceItem=e.balanceItem.reverse();for(var n=0;n<e.balanceItem.length;n++)null!=e.balanceItem[n].transcationtime&&(e.balanceItem[n].transcationtime=e.balanceItem[n].transcationtime.slice(0,10)),null!=e.balanceItem[n].confirmtime&&(e.balanceItem[n].confirmtime=e.balanceItem[n].confirmtime.slice(0,10))})},close_displayment:function(){this.display=!1}},created:function(){this.init()}},s=Object(o.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"查看\",width:900},model:{value:e.display,callback:function(t){e.display=t},expression:\"display\"}},[a(\"Form\",{ref:\"hadformValidate\",attrs:{model:e.hadformValidate,\"label-width\":90}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属公司\",prop:\"companyName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.hadformValidate.companyName,callback:function(t){e.$set(e.hadformValidate,\"companyName\",t)},expression:\"hadformValidate.companyName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属客户\",prop:\"customerName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.hadformValidate.customerName,callback:function(t){e.$set(e.hadformValidate,\"customerName\",t)},expression:\"hadformValidate.customerName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"余款总额\",prop:\"totalamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.hadformValidate.totalamount,callback:function(t){e.$set(e.hadformValidate,\"totalamount\",t)},expression:\"hadformValidate.totalamount\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"已补金额\",prop:\"paynumber\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.hadformValidate.paynumber,callback:function(t){e.$set(e.hadformValidate,\"paynumber\",t)},expression:\"hadformValidate.paynumber\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"未补金额\",prop:\"unpaidamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.hadformValidate.unpaidamount,callback:function(t){e.$set(e.hadformValidate,\"unpaidamount\",t)},expression:\"hadformValidate.unpaidamount\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"待审批金额\",prop:\"approvalpendingamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.hadformValidate.approvalpendingamount,callback:function(t){e.$set(e.hadformValidate,\"approvalpendingamount\",t)},expression:\"hadformValidate.approvalpendingamount\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"Collapse\",{model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[e._v(\"\\n                        补交明细\\n                        \"),a(\"div\",{attrs:{slot:\"content\"},slot:\"content\"},[a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:e.header,data:e.balanceItem}})],1)],1)])],1)],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"ghost\"},on:{click:e.close_displayment}},[e._v(\"关闭\")])],1)],1)],1)},[],!1,null,null,null);s.options.__file=\"display.vue\";var c={data:function(){return{search_model2:\"\",np_loading:!1,searchgroups:{companyName:\"\",ordercode:\"\",createbyname:\"\",approval:\"\"},total_NUM:new Number,page:1,pageSize:10,had_pay_list:[],had_pay_current_row_id:\"\",header:[{title:\"订单编号\",key:\"ordercode\",minWidth:150},{title:\"产品名称\",key:\"product\",minWidth:150,render:function(e,t){return\"\"==t.row.product||null==t.row.product?\"\":t.row.product.length>8?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.product.slice(0,8)+\"...\"),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.product)])]):e(\"span\",t.row.product)}},{title:\"公司名称\",key:\"companyName\",minWidth:200,render:function(e,t){return\"\"==t.row.companyName||null==t.row.companyName?\"\":t.row.companyName.length>10?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.companyName.slice(0,10)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.companyName)])]):e(\"span\",t.row.companyName)}},{title:\"余款总额\",key:\"totalamount\",minWidth:120},{title:\"已补余款\",key:\"paynumber\",minWidth:100},{title:\"剩余余款\",key:\"unpaidamount\",minWidth:100},{title:\"待审批金额\",key:\"zip\",minWidth:100},{title:\"跟进人\",key:\"followbyname\",minWidth:100}]}},methods:{downloadExcel:function(){var e={page:\"1\",pageSize:\"1000000\",isend:\"Y\",companyName:this.searchgroups.companyName,ordercode:this.searchgroups.ordercode,createbyname:this.searchgroups.createbyname,approval:this.searchgroups.approval,export:\"Y\",exportField:encodeURI(JSON.stringify([{field:\"ordercode\",title:\"订单号码\"},{field:\"product\",title:\"产品名称\"},{field:\"companyName\",title:\"公司名称\"},{field:\"totalamount\",title:\"余款总额\"},{field:\"paynumber\",title:\"已补余款\"},{field:\"unpaidamount\",title:\"剩余余款\"},{field:\"approvalpendingamount\",title:\"待审批金额\"},{field:\"followbyname\",title:\"创建人\"}]))},t=this.$MergeURL(\"api/order/balance/list\",e);window.open(t)},GetTableData:function(){var e=this;e.np_loading=!0;var t={params:{isend:\"Y\",page:e.page,pageSize:e.pageSize,companyName:e.searchgroups.companyName,ordercode:e.searchgroups.ordercode,createbyname:e.searchgroups.createbyname,sumField:\"unpaidamount,approvalpendingamount,totalamount\",sortField:\"updatedate\"}};for(var a in e.searchgroups)\"\"!=e.searchgroups[a]&&null!=e.searchgroups[a]||delete t.params[a];e.local_data=[],this.$http.get(\"api/order/balance/list\",t).then(function(t){e.$backToLogin(t),e.had_pay_list=t.data.data.rows,e.total_NUM=t.data.data.total,e.np_loading=!1;var a=t.data.data.sum.approvalpendingamount,n=t.data.data.sum.unpaidamount;e.local_data.push({companyName:\"合计\",approvalpendingamount:a,unpaidamount:n})})},PageChange:function(e){this.page=e,this.GetTableData()},PageSizeChange:function(e){this.pageSize=e,this.GetTableData()},display:function(){\"\"!=this.had_pay_current_row_id?this.$bus.emit(\"select_had_pay\",this.had_pay_current_row_id):this.$Message.warning(\"请选择一行\")},save_current:function(e){this.had_pay_current_row_id=e.id},reset:function(){this.searchgroups.companyName=\"\",this.searchgroups.ordercode=\"\",this.searchgroups.createbyname=\"\",this.page=1,this.GetTableData()},search:function(e){this.searchgroups.companyName=e.companyName,this.searchgroups.ordercode=e.ordercode,this.searchgroups.createbyname=e.createbyname,this.GetTableData()}},created:function(){var e=this;this.GetTableData(),this.$bus.on(\"search1\",function(t){e.search(t)}),this.$bus.on(\"reset1\",function(t){e.reset()}),this.$bus.on(\"refresh\",function(t){e.GetTableData()})},components:{Search:i,Display:s.exports}},p=(a(332),Object(o.a)(c,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:e.search_model2,callback:function(t){e.search_model2=t},expression:\"search_model2\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \"),e._v(\" \"),a(\"Search\",{attrs:{slot:\"content\"},slot:\"content\"})],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"div\",[a(\"ButtonGroup\",{staticStyle:{float:\"left\"}},[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.detail\"],expression:\"['spareM.detail']\"}],attrs:{type:\"primary\",icon:\"ios-crop\"},on:{click:e.display}},[e._v(\"查看\")]),e._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.exportY\"],expression:\"['spareM.exportY']\"}],attrs:{type:\"primary\",icon:\"ios-color-filter-outline\"},on:{click:e.downloadExcel}},[e._v(\"导出Excel\")])],1)],1)]),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:e.header,data:e.had_pay_list,\"highlight-row\":\"\",size:\"small\"},on:{\"on-current-change\":e.save_current}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{total:e.total_NUM,\"show-elevator\":\"\",\"show-sizer\":\"\",size:\"small\"},on:{\"on-change\":e.PageChange,\"on-page-size-change\":e.PageSizeChange}})],1)],1),e._v(\" \"),a(\"Display\")],1)},[],!1,null,null,null));p.options.__file=\"had_pay_list.vue\";var m=p.exports,d={data:function(){return{formInline:{companyName:\"\",ordercode:\"\",createbyname:\"\",approval:\"\"}}},methods:{search:function(){this.$bus.emit(\"search\",this.formInline)},reset:function(){this.formInline.companyName=\"\",this.formInline.ordercode=\"\",this.formInline.createbyname=\"\",this.formInline.approval=\"\",this.$bus.emit(\"reset\",!0)}}},u=Object(o.a)(d,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.search(t):null}}},[a(\"Form\",{ref:\"formInline\",attrs:{model:e.formInline,\"label-width\":80}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"companyName\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.companyName,callback:function(t){e.$set(e.formInline,\"companyName\",t)},expression:\"formInline.companyName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"orderId\",label:\"订单编号：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.ordercode,callback:function(t){e.$set(e.formInline,\"ordercode\",t)},expression:\"formInline.ordercode\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"createbyname\",label:\"销售人员：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.createbyname,callback:function(t){e.$set(e.formInline,\"createbyname\",t)},expression:\"formInline.createbyname\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"approval\",label:\"审批状况：\"}},[a(\"Select\",{attrs:{transfer:\"\",type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.formInline.approval,callback:function(t){e.$set(e.formInline,\"approval\",t)},expression:\"formInline.approval\"}},[a(\"Option\",{attrs:{value:\"Y\"}},[e._v(\"待审批\")]),e._v(\" \"),a(\"Option\",{attrs:{value:\"N\"}},[e._v(\"无审批\")])],1)],1)],1)],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:e.reset}},[e._v(\"重置\")])],1)],1)],1)},[],!1,null,null,null);u.options.__file=\"search.vue\";var h=u.exports;function y(e){var t=new Date(e),a=\"\"+(t.getMonth()+1),n=\"\"+t.getDate(),o=t.getFullYear();return a.length<2&&(a=\"0\"+a),n.length<2&&(n=\"0\"+n),[o,a,n].join(\"-\")}var f={data:function(){return{current_orderId:\"\",add_pay:!1,pay_type_label:[],payment:{transcationamount:\"\",transcationtime:\"\",paydir:\"\"},rulepayment:{transcationamount:[{required:!0,message:\"请输入付款金额\",trigger:\"blur\"}],paydir:[{required:!0,message:\"请选择付款方式\",trigger:\"change\"}],transcationtime:[{required:!0,type:\"date\",message:\"请输入日期\",trigger:\"change\"}]}}},created:function(){this.init()},methods:{init:function(){var e=this;this.GetLabelList(),this.$bus.on(\"add_pay\",function(t){e.add_pay=!0,e.current_orderId=t})},GetLabelList:function(){var e=this;this.$GetDataCenter(\"payDirs\",function(t){e.pay_type_label=t.data.data.payDirs})},handleSubmit:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(e){var n={balanceid:a.current_orderId,paydir:a.payment.paydir,transcationtime:y(a.payment.transcationtime),transcationamount:a.payment.transcationamount};t.$http.post(\"api/order/balance/item/create\",n).then(function(e){4e4==e.data.msgCode?(a.$Message.success(\"添加成功\"),a.add_pay=!1,a.$bus.emit(\"update\",!0)):a.$Message.error(\"添加失败，请重新添加\")})}})},handleReset:function(e){this.$refs[e].resetFields()}}},_=Object(o.a)(f,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"添加收款记录\",width:\"340\"},on:{\"on-visible-change\":function(t){e.handleReset(\"payment\")}},model:{value:e.add_pay,callback:function(t){e.add_pay=t},expression:\"add_pay\"}},[a(\"Form\",{ref:\"payment\",attrs:{model:e.payment,rules:e.rulepayment,\"label-width\":80}},[a(\"FormItem\",{attrs:{label:\"缴费金额\",prop:\"transcationamount\"}},[a(\"Input\",{staticStyle:{width:\"200px\"},attrs:{placeholder:\"\"},model:{value:e.payment.transcationamount,callback:function(t){e.$set(e.payment,\"transcationamount\",t)},expression:\"payment.transcationamount\"}})],1),e._v(\" \"),a(\"FormItem\",{attrs:{label:\"缴费方式\",prop:\"paydir\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},attrs:{transfer:\"\",placeholder:\"\"},model:{value:e.payment.paydir,callback:function(t){e.$set(e.payment,\"paydir\",t)},expression:\"payment.paydir\"}},e._l(e.pay_type_label,function(t){return a(\"Option\",{key:t.id,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1),e._v(\" \"),a(\"FormItem\",{attrs:{prop:\"transcationtime\",label:\"缴费日期\"}},[a(\"DatePicker\",{staticStyle:{width:\"200px\"},attrs:{type:\"date\",placeholder:\"\"},model:{value:e.payment.transcationtime,callback:function(t){e.$set(e.payment,\"transcationtime\",t)},expression:\"payment.transcationtime\"}})],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:function(t){e.handleSubmit(\"payment\")}}},[e._v(\"新增\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:function(t){e.handleReset(\"payment\")}}},[e._v(\"重置\")])],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);_.options.__file=\"add_payment.vue\";var b=_.exports,v={data:function(){return{edit_loading:!1,current_orderRow:\"\",current_orderId:\"\",edit_pay:!1,pay_type_label:[],editment:{transcationamount:\"\",transcationtime:\"\",paydir:\"\"},ruleeditment:{paydir:[{required:!0,message:\"请选择付款方式\",trigger:\"change\"}],transcationtime:[{required:!0,type:\"date\",message:\"请输入日期\",trigger:\"change\"}]}}},created:function(){this.init()},methods:{init:function(){var e=this;this.GetLabelList(),this.$bus.on(\"edit_pay\",function(t){e.edit_pay=!0,e.current_orderId=t.id,e.current_orderRow=t,e.editment.transcationamount=t.transcationamount,e.editment.transcationtime=t.transcationtime,e.editment.paydir=t.paydircode})},GetLabelList:function(){var e=this;this.$GetDataCenter(\"payDirs\",function(t){e.pay_type_label=t.data.data.payDirs})},handleSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(e){t.edit_loading=!0;var a={id:t.current_orderId,transcationamount:t.editment.transcationamount,transcationtime:y(t.editment.transcationtime),itemmemo:\"\",memo:\"\",paydir:t.editment.paydir};t.$Post(\"api/order/balance/updateOaBalanceItem\",a,function(e){t.$Message.success(\"修改成功\"),t.edit_pay=!1,t.$bus.emit(\"update\",!0),t.edit_loading=!1},function(e){t.edit_loading=!1})}})}}},g=Object(o.a)(v,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"修改\",width:\"340\"},model:{value:e.edit_pay,callback:function(t){e.edit_pay=t},expression:\"edit_pay\"}},[a(\"Form\",{ref:\"editment\",attrs:{model:e.editment,rules:e.ruleeditment,\"label-width\":80}},[a(\"FormItem\",{attrs:{label:\"缴费金额\",prop:\"transcationamount\"}},[a(\"Input\",{staticStyle:{width:\"200px\"},attrs:{placeholder:\"\"},model:{value:e.editment.transcationamount,callback:function(t){e.$set(e.editment,\"transcationamount\",t)},expression:\"editment.transcationamount\"}})],1),e._v(\" \"),a(\"FormItem\",{attrs:{label:\"缴费方式\",prop:\"paydir\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},attrs:{transfer:\"\",placeholder:\"\"},model:{value:e.editment.paydir,callback:function(t){e.$set(e.editment,\"paydir\",t)},expression:\"editment.paydir\"}},e._l(e.pay_type_label,function(t){return a(\"Option\",{key:t.typecode,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1),e._v(\" \"),a(\"FormItem\",{attrs:{prop:\"transcationtime\",label:\"缴费日期\"}},[a(\"DatePicker\",{staticStyle:{width:\"200px\"},attrs:{type:\"date\",placeholder:\"\"},model:{value:e.editment.transcationtime,callback:function(t){e.$set(e.editment,\"transcationtime\",t)},expression:\"editment.transcationtime\"}})],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\",loading:e.edit_loading},on:{click:function(t){e.handleSubmit(\"editment\")}}},[e._v(\"修改\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:function(t){e.edit_pay=!1}}},[e._v(\"取消\")])],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);g.options.__file=\"edit_payment.vue\";var w={data:function(){return{memo:\"\",openRebackModal:!1,backup_loading:!1,show:\"1\",py_loading:!1,payment:!1,balanceId:\"\",balanceRow:\"\",select_balance_row:\"\",formValidate:{companyName:\"\",customerName:\"\",totalamount:\"\",paynumber:\"\",unpaidamount:\"\",approvalpendingamount:\"\"},balanceItem:[],header:[{title:\"序号\",type:\"index\",align:\"center\",width:60},{title:\"补交金额\",key:\"transcationamount\"},{title:\"当前状态\",key:\"processtype\"},{title:\"驳回原因\",key:\"memo\"},{title:\"缴费渠道\",key:\"paydir\"},{title:\"缴费时间\",key:\"transcationtime\"},{title:\"财务确认时间\",key:\"confirmtime\"},{title:\"确认收款人\",key:\"userName\"},{title:\"创建人\",key:\"createrealname\"}]}},created:function(){this.init()},methods:{init:function(){var e=this;this.$bus.on(\"open_payment\",function(t){e.show=\"1\",e.balanceRow=t,e.balanceId=t.id,e.payment=!0,e.GetBalanceIdDate()}),this.$bus.on(\"update\",function(t){e.GetBalanceIdDate()})},GetBalanceIdDate:function(){var e=this,t=\"api/order/balance/detail?balanceId=\"+e.balanceId;this.$http.get(t).then(function(t){e.$backToLogin(t);var a=t.data.data;e.formValidate=a.balance[0],e.balanceItem=a.balanceItem,e.balanceItem=e.balanceItem.reverse();for(var n=0;n<e.balanceItem.length;n++)null!=e.balanceItem[n].transcationtime&&(e.balanceItem[n].transcationtime=e.balanceItem[n].transcationtime.slice(0,10)),null!=e.balanceItem[n].confirmtime&&(e.balanceItem[n].confirmtime=e.balanceItem[n].confirmtime.slice(0,10))})},save_balance_row:function(e){this.select_balance_row=e},close_payment:function(){this.payment=!1,this.$bus.emit(\"refresh\",!0)},edit_pay:function(){\"\"!=this.select_balance_row?this.$bus.emit(\"edit_pay\",this.select_balance_row):this.$Message.error(\"请选择一行进行修改\")},confirm:function(){var e=this;if(\"\"==this.select_balance_row)e.$Message.error(\"请选择一行进行确认\");else if(\"待审批\"==this.select_balance_row.processtype||\"驳回\"==this.select_balance_row.processtype){var t={itemId:e.select_balance_row.id};this.$http.post(\"api/order/balance/confirmReceipt\",t).then(function(t){4e4==t.data.msgCode?(e.$Message.success(\"审批成功\"),e.$bus.emit(\"refresh\",!0),e.GetBalanceIdDate()):e.$Message.error(\"审批失败，请重新审批\")}).catch(function(t){e.$Message.error(\"审批失败，请重新审批\")})}else e.$Message.error(\"此收款已审批，请选择另外一行\")},openreback:function(){\"\"==this.select_balance_row?this.$Message.error(\"请选择一行驳回！\"):this.openRebackModal=!0},reback:function(){var e=this;e.backup_loading=!0;var t={itemId:e.select_balance_row.id,processType:\"bh\",memo:e.memo};e.$Post(\"api/order/balance/updateProcesstypeByItemId\",t,function(t){e.backup_loading=!1,e.openRebackModal=!1,e.memo=\"\",e.GetBalanceIdDate()},function(t){e.backup_loading=!1})},add_pay:function(){this.$bus.emit(\"add_pay\",this.balanceId)}},components:{AddPayment:b,EditPayment:g.exports}},I=Object(o.a)(w,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"补交/审批\",width:950},model:{value:e.payment,callback:function(t){e.payment=t},expression:\"payment\"}},[a(\"Form\",{ref:\"formValidate\",attrs:{model:e.formValidate,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属公司:\",prop:\"companyName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.formValidate.companyName,callback:function(t){e.$set(e.formValidate,\"companyName\",t)},expression:\"formValidate.companyName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属客户:\",prop:\"customerName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.formValidate.customerName,callback:function(t){e.$set(e.formValidate,\"customerName\",t)},expression:\"formValidate.customerName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"余款总额:\",prop:\"totalamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.formValidate.totalamount,callback:function(t){e.$set(e.formValidate,\"totalamount\",t)},expression:\"formValidate.totalamount\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"已补金额:\",prop:\"paynumber\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.formValidate.paynumber,callback:function(t){e.$set(e.formValidate,\"paynumber\",t)},expression:\"formValidate.paynumber\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"未补金额:\",prop:\"unpaidamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.formValidate.unpaidamount,callback:function(t){e.$set(e.formValidate,\"unpaidamount\",t)},expression:\"formValidate.unpaidamount\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"待审批金额:\",prop:\"approvalpendingamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:e.formValidate.approvalpendingamount,callback:function(t){e.$set(e.formValidate,\"approvalpendingamount\",t)},expression:\"formValidate.approvalpendingamount\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"Collapse\",{model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[e._v(\"\\n                        补交明细\\n                        \"),a(\"div\",{attrs:{slot:\"content\"},slot:\"content\"},[a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.receipt\"],expression:\"['spareM.receipt']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:e.confirm}},[e._v(\"确认收款\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\"},on:{click:e.add_pay}},[e._v(\"补交费用\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\"},on:{click:e.edit_pay}},[e._v(\"修改\")]),e._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.edit\"],expression:\"['spareM.edit']\"}],attrs:{type:\"primary\",icon:\"edit\"},on:{click:e.openreback}},[e._v(\"驳回\")])],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:e.header,data:e.balanceItem,\"highlight-row\":\"\",loading:e.py_loading,size:\"small\"},on:{\"on-current-change\":e.save_balance_row}})],1)],1)])],1)],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"ghost\"},on:{click:e.close_payment}},[e._v(\"关闭\")])],1)],1),e._v(\" \"),a(\"Modal\",{attrs:{title:\"驳回\",width:400},model:{value:e.openRebackModal,callback:function(t){e.openRebackModal=t},expression:\"openRebackModal\"}},[a(\"Row\",[e._v(\"\\n            驳回原因：\\n        \")]),e._v(\" \"),a(\"Row\",[a(\"Input\",{attrs:{type:\"textarea\",placeholder:\"请输入驳回原因！（非必选项）\"},model:{value:e.memo,callback:function(t){e.memo=t},expression:\"memo\"}})],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\",loading:e.backup_loading},on:{click:e.reback}},[e._v(\"驳回\")])],1)],1),e._v(\" \"),a(\"AddPayment\"),e._v(\" \"),a(\"EditPayment\")],1)},[],!1,null,null,null);I.options.__file=\"payment.vue\";var k={data:function(){var e=this;return{search_model:\"\",np_loading:!1,isshow:!1,searchgroups:{companyName:\"\",ordercode:\"\",createbyname:\"\",approval:\"\"},total_NUM:new Number,page:1,pageSize:10,local_data:[],select_row:\"\",header:[{title:\"订单编号\",key:\"ordercode\",minWidth:150},{title:\"产品名称\",key:\"product\",minWidth:150,render:function(e,t){return\"\"==t.row.product||null==t.row.product?\"\":t.row.product.length>8?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.product.slice(0,8)+\"...\"),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.product)])]):e(\"span\",t.row.product)}},{title:\"公司名称\",minWidth:200,render:function(e,t){return\"\"==t.row.companyName||null==t.row.companyName?\"\":t.row.companyName.length>10?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.companyName.slice(0,10)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.companyName)])]):e(\"span\",t.row.companyName)}},{title:\"余款总额\",key:\"totalamount\",minWidth:120},{title:\"已补余款\",key:\"paynumber\",minWidth:100},{title:\"剩余余款\",key:\"unpaidamount\",minWidth:100},{title:\"待审批金额\",key:\"approvalpendingamount\",minWidth:100},{title:\"跟进人\",key:\"followbyname\",minWidth:100},{title:\"审批状态\",key:\"action\",width:100,render:function(t,a){var n=a.row.approvalpendingamount;if(a.index!=e.pageSize)return t(\"div\",{props:{color:n>0?\"black\":\"white\"}},n>0?\"待审批\":\"\")}}]}},methods:{downloadExcel:function(){var e={page:\"1\",pageSize:\"1000000\",isend:\"N\",companyName:this.searchgroups.companyName,ordercode:this.searchgroups.ordercode,createbyname:this.searchgroups.createbyname,approval:this.searchgroups.approval,export:\"Y\",exportField:encodeURI(JSON.stringify([{field:\"ordercode\",title:\"订单号码\"},{field:\"product\",title:\"产品名称\"},{field:\"companyName\",title:\"公司名称\"},{field:\"totalamount\",title:\"余款总额\"},{field:\"paynumber\",title:\"已补余款\"},{field:\"unpaidamount\",title:\"剩余余款\"},{field:\"approvalpendingamount\",title:\"待审批金额\"},{field:\"followbyname\",title:\"跟进人\"}]))},t=this.$MergeURL(\"api/order/balance/list\",e);window.open(t)},GetLocalData:function(){var e=this;e.np_loading=!0;var t={params:{isend:\"N\",page:e.page,pageSize:e.pageSize,companyName:e.searchgroups.companyName,ordercode:e.searchgroups.ordercode,createbyname:e.searchgroups.createbyname,approval:e.searchgroups.approval,sumField:\"unpaidamount,approvalpendingamount,totalamount\",sortField:\"updatedate\"}};for(var a in e.searchgroups)\"\"!=e.searchgroups[a]&&null!=e.searchgroups[a]||delete t.params[a];e.local_data=[],this.$http.get(\"api/order/balance/list\",t).then(function(t){e.$backToLogin(t),e.local_data=t.data.data.rows,e.total_NUM=t.data.data.total,e.np_loading=!1;var a=t.data.data.sum.unpaidamount,n=t.data.data.sum.approvalpendingamount,o=t.data.data.sum.totalamount;e.local_data.push({companyName:\"合计\",unpaidamount:a,approvalpendingamount:n,totalamount:o})})},PageChange:function(e){this.page=e,this.GetLocalData()},PageSizeChange:function(e){this.pageSize=e,this.GetLocalData()},rowClassName:function(e){if(\"合计\"!=e.companyName&&0!=e.approvalpendingamount&&this.select_row.id!=e.id)return\"demo-table-info-row\"},pay:function(){\"\"!=this.select_row?this.$bus.emit(\"open_payment\",this.select_row):this.$Message.warning(\"请选择一行\")},save_select_current:function(e){this.select_row=e},search:function(e){this.searchgroups.companyName=e.companyName,this.searchgroups.ordercode=e.ordercode,this.searchgroups.createbyname=e.createbyname,this.searchgroups.approval=e.approval,this.GetLocalData()},reset:function(){this.searchgroups.companyName=\"\",this.searchgroups.ordercode=\"\",this.searchgroups.createbyname=\"\",this.searchgroups.approval=\"\",this.page=1,this.GetLocalData()},exportToExecl:function(){\"\"!=_that.search_companyname&&\"\"!=_that.search_ordercode?\"api/order/balance/list?page=1&pageSize=\".concat(_that.pageSize,\"&isend=N&companyname=\").concat(_that.search_companyname,\"&ordercode=\").concat(_that.search_ordercode,\"&sumField=unpaidamount,approvalpendingamount\"):\"\"==_that.search_companyname&&\"\"!=_that.search_ordercode?\"api/order/balance/list?page=1&pageSize=\".concat(_that.pageSize,\"&isend=N&ordercode=\").concat(_that.search_ordercode,\"&sumField=unpaidamount,approvalpendingamount\"):\"\"!=_that.search_companyname&&\"\"==_that.search_ordercode?\"api/order/balance/list?page=1&pageSize=\".concat(_that.pageSize,\"&isend=N&companyname=\").concat(_that.search_companyname,\"&sumField=unpaidamount,approvalpendingamount\"):\"api/order/balance/list?page=\".concat(_that.page,\"&pageSize=\").concat(_that.pageSize,\"&isend=N&sumField=unpaidamount,approvalpendingamount\"),window.open(\"localhost%3a8089%2fapi%2forder%2fbalance%2flist%3fpage%3d1%26pageSize%3d9999%26isend%3dN%26sumField%3dunpaidamount%2capprovalpendingamount%26exportField%3d%5b%7b%22field%22%3a+%22companyName%22%2c%22title%22%3a+%22%e5%85%ac%e5%8f%b8%e5%90%8d%e7%a7%b0%22%7d%5d\")}},created:function(){var e=this;this.GetLocalData(),this.$bus.on(\"search\",function(t){e.search(t)}),this.$bus.on(\"reset\",function(t){e.reset()}),this.$bus.on(\"refresh\",function(t){e.GetLocalData()})},components:{Search:h,Payment:I.exports}},x=(a(334),Object(o.a)(k,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \"),a(\"Search\",{attrs:{slot:\"content\"},slot:\"content\"})],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"div\",[a(\"ButtonGroup\",{staticStyle:{float:\"left\"}},[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.approval\"],expression:\"['spareM.approval']\"}],attrs:{type:\"primary\",icon:\"ios-crop\"},on:{click:e.pay}},[e._v(\"补交/审批\")]),e._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.exportN\"],expression:\"['spareM.exportN']\"}],attrs:{type:\"primary\",icon:\"ios-color-filter-outline\"},on:{click:e.downloadExcel}},[e._v(\"导出Excel\")]),e._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.approval\"],expression:\"['spareM.approval']\"}],attrs:{type:\"primary\",icon:\"ios-color-filter-outline\"},on:{click:e.GetLocalData}},[e._v(\"刷新\")])],1)],1)]),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:e.header,data:e.local_data,\"highlight-row\":\"\",loading:e.np_loading,size:\"small\"},on:{\"on-current-change\":e.save_select_current}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{total:e.total_NUM,current:e.page,\"show-elevator\":\"\",\"show-sizer\":\"\",size:\"small\"},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.PageChange,\"on-page-size-change\":e.PageSizeChange}})],1)],1),e._v(\" \"),a(\"Payment\",{attrs:{isshow:e.isshow}})],1)},[],!1,null,null,null));x.options.__file=\"no_pay_list.vue\";var N={data:function(){return{}},components:{Hpay:m,Npay:x.exports}},$=Object(o.a)(N,function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",[t(\"Tabs\",{attrs:{value:\"name1\"}},[t(\"TabPane\",{attrs:{label:\"待补交\",name:\"name1\"}},[t(\"Npay\")],1),this._v(\" \"),t(\"TabPane\",{attrs:{label:\"已补交\",name:\"name2\"}},[t(\"Hpay\")],1)],1)],1)},[],!1,null,null,null);$.options.__file=\"spareManagement.vue\";t.default=$.exports}}]);"}