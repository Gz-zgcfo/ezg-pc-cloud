{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{435:function(e,t,a){\"use strict\";a.r(t);var l=a(9),i=a(382),s=a(25),r={name:\"fieldWarning_index\",components:{companyDetail:i.default},data:function(){var e=this;return{service_record_status:\"\",service_record_status_Map:new Map,fieldClockType:\"\",fieldClockType_Map:new Map,loading:!1,current_row:\"\",openFiedDetail:!1,fiedDetail:{},search_model:\"\",pageTotal:new Number,page:1,pageSize:10,searchModel:{companyname:\"\",name:\"\",tel:\"\",createdate:[],updatedate:[],realname:\"\",departname:\"\"},data:[],imgList:[],header:[{title:\"公司\",key:\"companyname\",width:300},{title:\"客户\",key:\"name\",width:120},{title:\"客户电话\",key:\"tel\",width:120},{title:\"部门\",key:\"departname\",width:120},{title:\"打卡类型\",key:\"fieldClockTypeName\",width:120},{title:\"打卡地址\",key:\"address1\",width:210,render:function(e,t){return\"\"==t.row.address1||null==t.row.address1?\"\":t.row.address1.length>13?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.address1.slice(0,13)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.address1)])]):e(\"span\",t.row.address1)}},{title:\"开始打卡时间\",key:\"clocktime\",width:160},{title:\"离开打卡时间\",key:\"endtime\",width:160},{title:\"外勤时长\",key:\"fieldlength\",width:120},{title:\"打卡人\",key:\"realname\",width:120},{title:\"外勤结果\",key:\"service_record_statusName\",width:120},{title:\"总结\",key:\"remark\",width:150},{title:\"外勤类型\",key:\"assiststatus\",width:150},{title:\"操作\",key:\"action\",fixed:\"right\",width:100,align:\"center\",render:function(t,a){return t(\"div\",[t(\"Button\",{props:{type:\"text\",size:\"small\"},on:{click:function(){e.$store.commit(\"open_gobal_customer_detail_modal\",{ID:a.row.customerid})}}},\"[客户详情]\")])}}]}},methods:{getData:function(){var e=this;this.loading=!0;var t={params:{page:e.page,pageSize:e.pageSize,companyname:e.searchModel.companyname,name:e.searchModel.name,tel:e.searchModel.tel,bcreatedate:Object(s.a)(e.searchModel.createdate[0]),ecreatedate:Object(s.a)(e.searchModel.createdate[1]),bupdatedate:Object(s.a)(e.searchModel.updatedate[0]),eupdatedate:Object(s.a)(e.searchModel.updatedate[1]),realname:e.searchModel.realname,departname:e.searchModel.departname,sortField:\"clocktime\"}};this.$Get(\"api/legwork/legworkList\",t,function(t){e.loading=!1,e.pageTotal=t.data.data.total,e.data=t.data.data.rows;for(var a=0;a<e.data.length;a++)e.data[a].fieldClockTypeName=e.fieldClockType_Map.get(e.data[a].fieldtype),e.data[a].service_record_statusName=e.service_record_status_Map.get(e.data[a].resulttype),\"\"==e.data[a].assiststatus||\"N\"==e.data[a].assiststatus?e.data[a].assiststatus=\"非协助外勤\":e.data[a].assiststatus=\"协助外勤\"},function(t){e.loading=!1})},getDetail:function(){var e=this,t={params:{legworkId:e.current_row.id}};this.$Get(\"api/legwork/checkLegwork\",t,function(t){e.fiedDetail=t.data.data[0],e.imgList=t.data.data[1].realpath},function(e){})},downloadExcel:function(){var e={page:\"1\",pageSize:\"1000000\",companyname:this.searchModel.companyname,name:this.searchModel.name,tel:this.searchModel.tel,bcreatedate:Object(s.a)(this.searchModel.createdate[0]),ecreatedate:Object(s.a)(this.searchModel.createdate[1]),bupdatedate:Object(s.a)(this.searchModel.updatedate[0]),eupdatedate:Object(s.a)(this.searchModel.updatedate[1]),realname:this.searchModel.realname,departname:this.searchModel.departname,export:\"Y\",sortField:\"clocktime\",exportField:encodeURI(JSON.stringify([{field:\"companyname\",title:\"公司名称\"},{field:\"name\",title:\"姓名\"},{field:\"departname\",title:\"部门\"},{field:\"fieldtype\",title:\"打卡类型\",format:\"fieldClockType\"},{field:\"address1\",title:\"打卡地址\"},{field:\"clocktime\",title:\"开始打卡时间\"},{field:\"endtime\",title:\"离开打卡时间\"},{field:\"fieldlength\",title:\"外勤时长\"},{field:\"realname\",title:\"打卡人\"},{field:\"remark\",title:\"总结\"},{field:\"service_record_status\",title:\"外勤结果\",format:\"field_total\"},{field:\"assiststatus\",title:\"外勤类型\"}]))},t=this.$MergeURL(\"api/legwork/legworkList\",e);window.open(t)},reset:function(){this.page=1,this.$refs.searchModel.resetFields(),this.getData()},search:function(){this.page=1,this.getData()},pageChange:function(e){this.page=e,this.getData()},pageSizeChange:function(e){this.pageSize=e,this.getData()},selectrow:function(e){this.current_row=e},openShow:function(){\"\"==this.current_row||null==this.current_row?this.$Message.warning(\"请选择一行进行查看！\"):(this.openFiedDetail=!0,this.getDetail())},getDataCenter:function(){var e=this;this.$GetDataCenter(\"fieldClockType,field_total\",function(t){e.fieldClockType=t.data.data.fieldClockType,e.service_record_status=t.data.data.field_total,e.fieldClockType_Map=e.$array2map(e.fieldClockType),e.service_record_status_Map=e.$array2map(e.service_record_status)})}},mounted:function(){},created:function(){this.getData(),this.getDataCenter()}},o=a(2),n=Object(o.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                筛选\\n                    \"),e._v(\" \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.search(t):null}},slot:\"content\"},[a(\"Form\",{ref:\"searchModel\",attrs:{model:e.searchModel,\"label-width\":100}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"companyname\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:e.searchModel.companyname,callback:function(t){e.$set(e.searchModel,\"companyname\",t)},expression:\"searchModel.companyname\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"name\",label:\"客户名称：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:e.searchModel.name,callback:function(t){e.$set(e.searchModel,\"name\",t)},expression:\"searchModel.name\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"tel\",label:\"客户电话：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:e.searchModel.tel,callback:function(t){e.$set(e.searchModel,\"tel\",t)},expression:\"searchModel.tel\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"departname\",label:\"服务部门：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:e.searchModel.departname,callback:function(t){e.$set(e.searchModel,\"departname\",t)},expression:\"searchModel.departname\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"createdate\",label:\"打卡时间：\"}},[a(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",type:\"daterange\",placement:\"bottom-start\",size:\"small\"},model:{value:e.searchModel.createdate,callback:function(t){e.$set(e.searchModel,\"createdate\",t)},expression:\"searchModel.createdate\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"updatedate\",label:\"离开时间：\"}},[a(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",type:\"daterange\",placement:\"bottom-start\",size:\"small\"},model:{value:e.searchModel.updatedate,callback:function(t){e.$set(e.searchModel,\"updatedate\",t)},expression:\"searchModel.updatedate\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"realname\",label:\"服务人员：\"}},[a(\"Input\",{attrs:{size:\"small\",type:\"text\",placeholder:\"\"},model:{value:e.searchModel.realname,callback:function(t){e.$set(e.searchModel,\"realname\",t)},expression:\"searchModel.realname\"}})],1)],1)],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:e.reset}},[e._v(\"重置\")])],1)],1)],1)],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.openShow}},[e._v(\"查看\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.downloadExcel}},[e._v(\"导出Excel\")])],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",loading:e.loading,columns:e.header,data:e.data},on:{\"on-current-change\":e.selectrow,\"on-row-dblclick\":e.openShow}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotal,current:e.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\",placement:\"top\"},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.pageChange,\"on-page-size-change\":e.pageSizeChange}})],1)],1),e._v(\" \"),a(\"Modal\",{attrs:{title:\"外勤详情\",width:\"700\"},on:{\"on-cancel\":function(t){e.openFiedDetail=!1}},model:{value:e.openFiedDetail,callback:function(t){e.openFiedDetail=t},expression:\"openFiedDetail\"}},[a(\"Row\",[a(\"Form\",{ref:\"fiedDetail\",attrs:{model:e.fiedDetail,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"companyname\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.companyname,callback:function(t){e.$set(e.fiedDetail,\"companyname\",t)},expression:\"fiedDetail.companyname\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"name\",label:\"客户名称：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.name,callback:function(t){e.$set(e.fiedDetail,\"name\",t)},expression:\"fiedDetail.name\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"tel\",label:\"客户电话：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.tel,callback:function(t){e.$set(e.fiedDetail,\"tel\",t)},expression:\"fiedDetail.tel\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"clocktime\",label:\"上门时间：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.clocktime,callback:function(t){e.$set(e.fiedDetail,\"clocktime\",t)},expression:\"fiedDetail.clocktime\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"endtime\",label:\"离开时间：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.endtime,callback:function(t){e.$set(e.fiedDetail,\"endtime\",t)},expression:\"fiedDetail.endtime\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"fieldlength\",label:\"外勤时长：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.fieldlength,callback:function(t){e.$set(e.fiedDetail,\"fieldlength\",t)},expression:\"fiedDetail.fieldlength\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"assiststatus\",label:\"外勤类型：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.assiststatus,callback:function(t){e.$set(e.fiedDetail,\"assiststatus\",t)},expression:\"fiedDetail.assiststatus\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"clockshows\",label:\"打卡说明：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.clockshows,callback:function(t){e.$set(e.fiedDetail,\"clockshows\",t)},expression:\"fiedDetail.clockshows\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"startAddress\",label:\"第一次打卡地址：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.startAddress,callback:function(t){e.$set(e.fiedDetail,\"startAddress\",t)},expression:\"fiedDetail.startAddress\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"endAddress\",label:\"第二次打卡地址：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.endAddress,callback:function(t){e.$set(e.fiedDetail,\"endAddress\",t)},expression:\"fiedDetail.endAddress\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"remark\",label:\"备注总结：\"}},[a(\"Input\",{attrs:{type:\"text\",disabled:\"\"},model:{value:e.fiedDetail.remark,callback:function(t){e.$set(e.fiedDetail,\"remark\",t)},expression:\"fiedDetail.remark\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"11\"}},[a(\"FormItem\",{staticStyle:{margin:\"5px\"},attrs:{prop:\"Providentfund\",label:\"附件：\",disabled:\"\"}},e._l(e.imgList,function(e,t){return a(\"Row\",{key:t},[a(\"a\",{attrs:{target:\"_blank\",href:\"/api/assets/\"+e.realpath}},[a(\"img\",{attrs:{src:\"/api/assets/\"+e.realpath,alt:\"\",width:\"100\",height:\"100\",onerror:\"this.src='/api/assets/upload/commonImg/error.jpg';this.onerror=null\"}})])])}),1)],1)],1)],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);n.options.__file=\"commonFiedManagement.vue\";var d={name:\"commonfieldmanagement_index\",components:{commonField:n.exports},data:function(){return{}},methods:{pageChange:function(e){this.page=e,this.getData()},pageSizeChange:function(e){this.pageSize=e,this.getData()},getData:function(){var e=this;this.loading=!0;var t={params:{warningId:e.id,page:e.page,pageSize:e.pageSize}};this.$Get(\"api/legwork/checkCompanyMsg\",t,function(t){e.open_detail=!0,e.loading=!1,e.data=t.data.data.rows,e.pageTotal=t.data.data.total},function(t){e.loading=!1})}},created:function(){var e=this;l.a.$on(\"Open_field_Working\",function(t){e.page=1,e.pageSize=10,e.id=t,e.getData()})}},c=Object(o.a)(d,function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",[t(\"common-field\")],1)},[],!1,null,null,null);c.options.__file=\"commonFieldIndex.vue\";t.default=c.exports}}]);"}