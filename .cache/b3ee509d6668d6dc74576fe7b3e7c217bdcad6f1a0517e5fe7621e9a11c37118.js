{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{857:function(t,e,a){\"use strict\";a.r(e);var n={name:\"customerLog_index\",data:function(){return{search_model:\"\",customerDynamicType:[],customerDynamicType_Map:new Map,formValidate:{realname:\"\",type:\"\",name:\"\",tel:\"\",companyname:\"\"},loading:!1,page:1,pageSize:10,columns:[{title:\"客户名称\",key:\"name\",minWidth:120},{title:\"公司名称\",key:\"companyname\",minWidth:180},{title:\"联系方式\",key:\"tel\",minWidth:120},{title:\"类型\",key:\"typename\",align:\"center\",minWidth:200},{title:\"动态\",key:\"content\",minWidth:360,render:function(t,e){return\"\"==e.row.content||null==e.row.content?\"\":25<e.row.content.length?t(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[t(\"span\",e.row.content.slice(0,25)+\"...\"),t(\"Icon\",{props:{type:\"arrow-down-b\"}}),t(\"div\",{slot:\"content\",style:{width:\"200px\",whiteSpace:\"normal\"}},[t(\"span\",e.row.content)])]):t(\"span\",e.row.content)}},{title:\"变更时间\",key:\"createdate\",minWidth:150},{title:\"操作人\",key:\"realname\",minWidth:150}],data:[],pageTotal:new Number}},methods:{Search:function(){this.page=1,this.get_data()},handleReset:function(){this.$refs.formValidate.resetFields(),this.get_data()},pageChange:function(t){this.page=t,this.get_data()},pageSizeChange:function(t){this.pageSize=t,this.get_data()},get_data:function(){var a=this;a.loading=!0;\"all\"==a.formValidate.type&&(a.formValidate.type=\"\");var t={params:{page:a.page,pageSize:a.pageSize,realname:a.formValidate.realname,type:a.formValidate.type,name:a.formValidate.name,tel:a.formValidate.tel,companyname:a.formValidate.companyname,sortField:\"createdate\"}};this.$Get(\"api/customer/dynamic/record/list\",t,function(t){a.loading=!1,a.data=t.data.data.rows,a.pageTotal=t.data.data.total;for(var e=0;e<a.data.length;e++)a.data[e].type&&(a.data[e].typename=a.find_customer_dynamic_type(a.data[e].type))})},find_customer_dynamic_type:function(t){for(var e=this,a=t.split(\"-\"),n=0;n<e.customerDynamicType.length;n++)if(e.customerDynamicType[n].typecode==a[0]&&1<a.length)for(var o=0;o<e.customerDynamicType[n].children.length;o++)if(e.customerDynamicType[n].children[o].typecode==a[1])return e.customerDynamicType[n].typename+\" - \"+e.customerDynamicType[n].children[o].typename},get_data_center:function(){var n=this;return new Promise(function(e,t){var a=n;n.$GetDataCenter(\"customer_dynamic_type\",function(t){a.customerDynamicType=t.data.data.customer_dynamic_type,e()})})}},created:function(){var t=this;this.get_data_center().then(function(){return t.get_data()})}},o=a(4),i=Object(o.a)(n,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"Card\",{staticStyle:{\"min-width\":\"800px\"}},[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \\n                        \"),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.Search(t):null}},slot:\"content\"},[a(\"Form\",{ref:\"formValidate\",staticStyle:{\"margin-top\":\"15px\"},attrs:{model:e.formValidate,\"label-width\":120}},[a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"客户名称：\",prop:\"name\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,\"name\",t)},expression:\"formValidate.name\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"电话：\",prop:\"tel\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:e.formValidate.tel,callback:function(t){e.$set(e.formValidate,\"tel\",t)},expression:\"formValidate.tel\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"公司名称：\",prop:\"companyname\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:e.formValidate.companyname,callback:function(t){e.$set(e.formValidate,\"companyname\",t)},expression:\"formValidate.companyname\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{height:\"56px\"},attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"类型：\",prop:\"type\"}},[a(\"Select\",{staticStyle:{width:\"100%\"},attrs:{transfer:\"\",size:\"small\"},on:{\"on-change\":e.Search},model:{value:e.formValidate.type,callback:function(t){e.$set(e.formValidate,\"type\",t)},expression:\"formValidate.type\"}},e._l(e.customerDynamicType,function(t){return a(\"Option\",{key:t.id,attrs:{value:t.typecode}},[e._v(\"\\n                                                \"+e._s(t.typename)+\"\\n                                            \")])}),1)],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"跟进人：\",prop:\"realname\"}},[a(\"Input\",{staticStyle:{width:\"100%\"},attrs:{size:\"small\"},model:{value:e.formValidate.realname,callback:function(t){e.$set(e.formValidate,\"realname\",t)},expression:\"formValidate.realname\"}})],1)],1)],1),e._v(\" \"),a(\"center\",[a(\"FormItem\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.Search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:e.handleReset}},[e._v(\"\\n                                        重置\\n                                    \")])],1)],1)],1)],1)],1)],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:e.columns,data:e.data,loading:e.loading}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotal,current:e.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.pageChange,\"on-page-size-change\":e.pageSizeChange}})],1)],1)},[],!1,null,null,null);i.options.__file=\"index.vue\";e.default=i.exports}}]);"}