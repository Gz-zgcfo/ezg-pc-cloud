{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{471:function(e,t,a){},472:function(e,t,a){},756:function(e,t,a){\"use strict\";var n=a(471);a.n(n).a},758:function(e,t,a){\"use strict\";var n=a(472);a.n(n).a},810:function(e,t,a){\"use strict\";a.r(t);var n=a(3),o=(new(a.n(n).a),{data:function(){return{formInline:{companyName:\"\",ordercode:\"\",createbyname:\"\"}}},methods:{search:function(){this.$bus.emit(\"search1\",this.formInline)},reset:function(){this.formInline.companyName=\"\",this.formInline.ordercode=\"\",this.formInline.createbyname=\"\",this.$bus.emit(\"reset1\",!0)}}}),r=a(4),i=Object(r.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{on:{keydown:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.search(e):null}}},[a(\"Form\",{ref:\"formInline\",attrs:{model:t.formInline,\"label-width\":80}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"companyName\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.companyName,callback:function(e){t.$set(t.formInline,\"companyName\",e)},expression:\"formInline.companyName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"orderId\",label:\"订单编号：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.ordercode,callback:function(e){t.$set(t.formInline,\"ordercode\",e)},expression:\"formInline.ordercode\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"createbyname\",label:\"销售人员：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.createbyname,callback:function(e){t.$set(t.formInline,\"createbyname\",e)},expression:\"formInline.createbyname\"}})],1)],1)],1),t._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:t.search}},[t._v(\"搜索\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:t.reset}},[t._v(\"重置\")])],1)],1)],1)},[],!1,null,null,null);i.options.__file=\"search.vue\";var l=i.exports,s={data:function(){return{show:\"1\",display:!1,balanceId:\"\",hadformValidate:{companyName:\"\",customerName:\"\",totalamount:\"\",paynumber:\"\",unpaidamount:\"\",approvalpendingamount:\"\"},balanceItem:[],header:[{title:\"序号\",type:\"index\",align:\"center\",width:60},{title:\"补交金额\",key:\"transcationamount\"},{title:\"当前状态\",key:\"processtype\"},{title:\"缴费渠道\",key:\"paydir\"},{title:\"缴费时间\",key:\"transcationtime\"},{title:\"财务确认时间\",key:\"confirmtime\"},{title:\"确认收款人\",key:\"userName\"}]}},methods:{init:function(){var t=this;this.$bus.on(\"select_had_pay\",function(e){t.show=\"1\",t.display=!0,t.balanceId=e,t.GetBalanceIdDate()})},GetBalanceIdDate:function(){var n=this,e=\"api/order/balance/detail?balanceId=\"+n.balanceId;this.$http.get(e).then(function(e){var t=e.data.data;n.hadformValidate=t.balance[0],n.balanceItem=t.balanceItem,n.balanceItem=n.balanceItem.reverse();for(var a=0;a<n.balanceItem.length;a++)null!=n.balanceItem[a].transcationtime&&(n.balanceItem[a].transcationtime=n.balanceItem[a].transcationtime.slice(0,10)),null!=n.balanceItem[a].confirmtime&&(n.balanceItem[a].confirmtime=n.balanceItem[a].confirmtime.slice(0,10))})},close_displayment:function(){this.display=!1}},created:function(){this.init()}},c=Object(r.a)(s,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"查看\",width:900},model:{value:t.display,callback:function(e){t.display=e},expression:\"display\"}},[a(\"Form\",{ref:\"hadformValidate\",attrs:{model:t.hadformValidate,\"label-width\":90}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属公司\",prop:\"companyName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.hadformValidate.companyName,callback:function(e){t.$set(t.hadformValidate,\"companyName\",e)},expression:\"hadformValidate.companyName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属客户\",prop:\"customerName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.hadformValidate.customerName,callback:function(e){t.$set(t.hadformValidate,\"customerName\",e)},expression:\"hadformValidate.customerName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"余款总额\",prop:\"totalamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.hadformValidate.totalamount,callback:function(e){t.$set(t.hadformValidate,\"totalamount\",e)},expression:\"hadformValidate.totalamount\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"已补金额\",prop:\"paynumber\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.hadformValidate.paynumber,callback:function(e){t.$set(t.hadformValidate,\"paynumber\",e)},expression:\"hadformValidate.paynumber\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"未补金额\",prop:\"unpaidamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.hadformValidate.unpaidamount,callback:function(e){t.$set(t.hadformValidate,\"unpaidamount\",e)},expression:\"hadformValidate.unpaidamount\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"待审批金额\",prop:\"approvalpendingamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.hadformValidate.approvalpendingamount,callback:function(e){t.$set(t.hadformValidate,\"approvalpendingamount\",e)},expression:\"hadformValidate.approvalpendingamount\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",[a(\"Collapse\",{model:{value:t.show,callback:function(e){t.show=e},expression:\"show\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[t._v(\"\\n                        补交明细\\n                        \"),a(\"div\",{attrs:{slot:\"content\"},slot:\"content\"},[a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:t.header,data:t.balanceItem}})],1)],1)])],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"ghost\"},on:{click:t.close_displayment}},[t._v(\"关闭\")])],1)],1)],1)},[],!1,null,null,null);c.options.__file=\"display.vue\";var p={data:function(){return{search_model2:\"\",np_loading:!1,searchgroups:{companyName:\"\",ordercode:\"\",createbyname:\"\",approval:\"\"},total_NUM:new Number,page:1,pageSize:10,had_pay_list:[],had_pay_current_row_id:\"\",header:[{title:\"订单编号\",key:\"ordercode\",minWidth:150},{title:\"产品名称\",key:\"product\",minWidth:150,render:function(e,t){return\"\"==t.row.product||null==t.row.product?\"\":8<t.row.product.length?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.product.slice(0,8)+\"...\"),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.product)])]):e(\"span\",t.row.product)}},{title:\"公司名称\",key:\"companyName\",minWidth:200,render:function(e,t){return\"\"==t.row.companyName||null==t.row.companyName?\"\":10<t.row.companyName.length?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.companyName.slice(0,10)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.companyName)])]):e(\"span\",t.row.companyName)}},{title:\"余款总额\",key:\"totalamount\",minWidth:120},{title:\"已补余款\",key:\"paynumber\",minWidth:100},{title:\"剩余余款\",key:\"unpaidamount\",minWidth:100},{title:\"待审批金额\",key:\"zip\",minWidth:100},{title:\"跟进人\",key:\"followbyname\",minWidth:100}]}},methods:{downloadExcel:function(){var e={page:\"1\",pageSize:\"1000000\",isend:\"Y\",companyName:this.searchgroups.companyName,ordercode:this.searchgroups.ordercode,createbyname:this.searchgroups.createbyname,approval:this.searchgroups.approval,export:\"Y\",exportField:encodeURI(JSON.stringify([{field:\"ordercode\",title:\"订单号码\"},{field:\"product\",title:\"产品名称\"},{field:\"companyname\",title:\"公司名称\"},{field:\"totalamount\",title:\"余款总额\"},{field:\"paynumber\",title:\"已补余款\"},{field:\"unpaidamount\",title:\"剩余余款\"},{field:\"approvalpendingamount\",title:\"待审批金额\"},{field:\"followbyname\",title:\"创建人\"}]))},t=this.$MergeURL(\"api/order/balance/list\",e);window.open(t)},GetTableData:function(){var n=this;n.np_loading=!0;var e={params:{isend:\"Y\",page:n.page,pageSize:n.pageSize,companyName:n.searchgroups.companyName,ordercode:n.searchgroups.ordercode,createbyname:n.searchgroups.createbyname,sumField:\"unpaidamount,approvalpendingamount,totalamount\",sortField:\"updatedate\"}};for(var t in n.searchgroups)\"\"!=n.searchgroups[t]&&null!=n.searchgroups[t]||delete e.params[t];n.local_data=[],this.$http.get(\"api/order/balance/list\",e).then(function(e){n.$backToLogin(e),n.had_pay_list=e.data.data.rows,n.total_NUM=e.data.data.total,n.np_loading=!1;var t=e.data.data.sum.approvalpendingamount,a=e.data.data.sum.unpaidamount;n.local_data.push({companyName:\"合计\",approvalpendingamount:t,unpaidamount:a})})},PageChange:function(e){this.page=e,this.GetTableData()},PageSizeChange:function(e){this.pageSize=e,this.GetTableData()},display:function(){\"\"!=this.had_pay_current_row_id?this.$bus.emit(\"select_had_pay\",this.had_pay_current_row_id):this.$Message.warning(\"请选择一行\")},save_current:function(e){this.had_pay_current_row_id=e.id},reset:function(){this.searchgroups.companyName=\"\",this.searchgroups.ordercode=\"\",this.searchgroups.createbyname=\"\",this.page=1,this.GetTableData()},search:function(e){this.searchgroups.companyName=e.companyName,this.searchgroups.ordercode=e.ordercode,this.searchgroups.createbyname=e.createbyname,this.GetTableData()}},created:function(){var t=this;this.GetTableData(),this.$bus.on(\"search1\",function(e){t.search(e)}),this.$bus.on(\"reset1\",function(e){t.reset()}),this.$bus.on(\"refresh\",function(e){t.GetTableData()})},components:{Search:l,Display:c.exports}},m=(a(756),Object(r.a)(p,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:t.search_model2,callback:function(e){t.search_model2=e},expression:\"search_model2\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),t._v(\"\\n                    筛选\\n                    \"),t._v(\" \"),a(\"Search\",{attrs:{slot:\"content\"},slot:\"content\"})],1)],1)],1),t._v(\" \"),a(\"Row\",[a(\"div\",[a(\"ButtonGroup\",{staticStyle:{float:\"left\"}},[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.detail\"],expression:\"['spareM.detail']\"}],attrs:{type:\"primary\",icon:\"ios-crop\"},on:{click:t.display}},[t._v(\"查看\")]),t._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.exportY\"],expression:\"['spareM.exportY']\"}],attrs:{type:\"primary\",icon:\"ios-color-filter-outline\"},on:{click:t.downloadExcel}},[t._v(\"导出Excel\")])],1)],1)]),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:t.header,data:t.had_pay_list,\"highlight-row\":\"\",size:\"small\"},on:{\"on-current-change\":t.save_current}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{total:t.total_NUM,\"show-elevator\":\"\",\"show-sizer\":\"\",size:\"small\"},on:{\"on-change\":t.PageChange,\"on-page-size-change\":t.PageSizeChange}})],1)],1),t._v(\" \"),a(\"Display\")],1)},[],!1,null,null,null));m.options.__file=\"had_pay_list.vue\";var d=m.exports,u={data:function(){return{formInline:{companyName:\"\",ordercode:\"\",createbyname:\"\",approval:\"\"}}},methods:{search:function(){this.$bus.emit(\"search\",this.formInline)},reset:function(){this.formInline.companyName=\"\",this.formInline.ordercode=\"\",this.formInline.createbyname=\"\",this.formInline.approval=\"\",this.$bus.emit(\"reset\",!0)}}},h=Object(r.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{on:{keydown:function(e){return\"button\"in e||!t._k(e.keyCode,\"enter\",13,e.key,\"Enter\")?t.search(e):null}}},[a(\"Form\",{ref:\"formInline\",attrs:{model:t.formInline,\"label-width\":80}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"companyName\",label:\"公司名称：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.companyName,callback:function(e){t.$set(t.formInline,\"companyName\",e)},expression:\"formInline.companyName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"orderId\",label:\"订单编号：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.ordercode,callback:function(e){t.$set(t.formInline,\"ordercode\",e)},expression:\"formInline.ordercode\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"createbyname\",label:\"销售人员：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.createbyname,callback:function(e){t.$set(t.formInline,\"createbyname\",e)},expression:\"formInline.createbyname\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"approval\",label:\"审批状况：\"}},[a(\"Select\",{attrs:{transfer:\"\",type:\"text\",placeholder:\"\",size:\"small\"},model:{value:t.formInline.approval,callback:function(e){t.$set(t.formInline,\"approval\",e)},expression:\"formInline.approval\"}},[a(\"Option\",{attrs:{value:\"Y\"}},[t._v(\"待审批\")]),t._v(\" \"),a(\"Option\",{attrs:{value:\"N\"}},[t._v(\"无审批\")])],1)],1)],1)],1),t._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:t.search}},[t._v(\"搜索\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:t.reset}},[t._v(\"重置\")])],1)],1)],1)},[],!1,null,null,null);h.options.__file=\"search.vue\";var y=h.exports;function f(e){var t=new Date(e),a=\"\"+(t.getMonth()+1),n=\"\"+t.getDate(),o=t.getFullYear();return a.length<2&&(a=\"0\"+a),n.length<2&&(n=\"0\"+n),[o,a,n].join(\"-\")}var _={data:function(){return{current_orderId:\"\",add_pay:!1,pay_type_label:[],payment:{transcationamount:\"\",transcationtime:\"\",paydir:\"\"},rulepayment:{transcationamount:[{required:!0,message:\"请输入付款金额\",trigger:\"blur\"}],paydir:[{required:!0,message:\"请选择付款方式\",trigger:\"change\"}],transcationtime:[{required:!0,type:\"date\",message:\"请输入日期\",trigger:\"change\"}]}}},created:function(){this.init()},methods:{init:function(){var t=this;this.GetLabelList(),this.$bus.on(\"add_pay\",function(e){t.add_pay=!0,t.current_orderId=e})},GetLabelList:function(){var t=this;this.$GetDataCenter(\"payDirs\",function(e){t.pay_type_label=e.data.data.payDirs})},handleSubmit:function(e){var a=this,n=this;this.$refs[e].validate(function(e){if(e){var t={balanceid:n.current_orderId,paydir:n.payment.paydir,transcationtime:f(n.payment.transcationtime),transcationamount:n.payment.transcationamount};a.$http.post(\"api/order/balance/item/create\",t).then(function(e){4e4==e.data.msgCode?(n.$Message.success(\"添加成功\"),n.add_pay=!1,n.$bus.emit(\"update\",!0)):n.$Message.error(\"添加失败，请重新添加\")})}})},handleReset:function(e){this.$refs[e].resetFields()}}},b=Object(r.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"添加收款记录\",width:\"340\"},on:{\"on-visible-change\":function(e){t.handleReset(\"payment\")}},model:{value:t.add_pay,callback:function(e){t.add_pay=e},expression:\"add_pay\"}},[a(\"Form\",{ref:\"payment\",attrs:{model:t.payment,rules:t.rulepayment,\"label-width\":80}},[a(\"FormItem\",{attrs:{label:\"缴费金额\",prop:\"transcationamount\"}},[a(\"Input\",{staticStyle:{width:\"200px\"},attrs:{placeholder:\"\"},model:{value:t.payment.transcationamount,callback:function(e){t.$set(t.payment,\"transcationamount\",e)},expression:\"payment.transcationamount\"}})],1),t._v(\" \"),a(\"FormItem\",{attrs:{label:\"缴费方式\",prop:\"paydir\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},attrs:{transfer:\"\",placeholder:\"\"},model:{value:t.payment.paydir,callback:function(e){t.$set(t.payment,\"paydir\",e)},expression:\"payment.paydir\"}},t._l(t.pay_type_label,function(e){return a(\"Option\",{key:e.id,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),a(\"FormItem\",{attrs:{prop:\"transcationtime\",label:\"缴费日期\"}},[a(\"DatePicker\",{staticStyle:{width:\"200px\"},attrs:{type:\"date\",placeholder:\"\"},model:{value:t.payment.transcationtime,callback:function(e){t.$set(t.payment,\"transcationtime\",e)},expression:\"payment.transcationtime\"}})],1),t._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:function(e){t.handleSubmit(\"payment\")}}},[t._v(\"新增\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:function(e){t.handleReset(\"payment\")}}},[t._v(\"重置\")])],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);b.options.__file=\"add_payment.vue\";var v=b.exports,g={data:function(){return{edit_loading:!1,current_orderRow:\"\",current_orderId:\"\",edit_pay:!1,pay_type_label:[],editment:{transcationamount:\"\",transcationtime:\"\",paydir:\"\"},ruleeditment:{paydir:[{required:!0,message:\"请选择付款方式\",trigger:\"change\"}],transcationtime:[{required:!0,type:\"date\",message:\"请输入日期\",trigger:\"change\"}]}}},created:function(){this.init()},methods:{init:function(){var t=this;this.GetLabelList(),this.$bus.on(\"edit_pay\",function(e){t.edit_pay=!0,t.current_orderId=e.id,t.current_orderRow=e,t.editment.transcationamount=e.transcationamount,t.editment.transcationtime=e.transcationtime,t.editment.paydir=e.paydircode})},GetLabelList:function(){var t=this;this.$GetDataCenter(\"payDirs\",function(e){t.pay_type_label=e.data.data.payDirs})},handleSubmit:function(e){var a=this;this.$refs[e].validate(function(e){if(e){a.edit_loading=!0;var t={id:a.current_orderId,transcationamount:a.editment.transcationamount,transcationtime:f(a.editment.transcationtime),itemmemo:\"\",memo:\"\",paydir:a.editment.paydir};a.$Post(\"api/order/balance/updateOaBalanceItem\",t,function(e){a.$Message.success(\"修改成功\"),a.edit_pay=!1,a.$bus.emit(\"update\",!0),a.edit_loading=!1},function(e){a.edit_loading=!1})}})}}},w=Object(r.a)(g,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"修改\",width:\"340\"},model:{value:t.edit_pay,callback:function(e){t.edit_pay=e},expression:\"edit_pay\"}},[a(\"Form\",{ref:\"editment\",attrs:{model:t.editment,rules:t.ruleeditment,\"label-width\":80}},[a(\"FormItem\",{attrs:{label:\"缴费金额\",prop:\"transcationamount\"}},[a(\"Input\",{staticStyle:{width:\"200px\"},attrs:{placeholder:\"\"},model:{value:t.editment.transcationamount,callback:function(e){t.$set(t.editment,\"transcationamount\",e)},expression:\"editment.transcationamount\"}})],1),t._v(\" \"),a(\"FormItem\",{attrs:{label:\"缴费方式\",prop:\"paydir\"}},[a(\"Select\",{staticStyle:{width:\"200px\"},attrs:{transfer:\"\",placeholder:\"\"},model:{value:t.editment.paydir,callback:function(e){t.$set(t.editment,\"paydir\",e)},expression:\"editment.paydir\"}},t._l(t.pay_type_label,function(e){return a(\"Option\",{key:e.typecode,attrs:{value:e.typecode}},[t._v(t._s(e.typename))])}),1)],1),t._v(\" \"),a(\"FormItem\",{attrs:{prop:\"transcationtime\",label:\"缴费日期\"}},[a(\"DatePicker\",{staticStyle:{width:\"200px\"},attrs:{type:\"date\",placeholder:\"\"},model:{value:t.editment.transcationtime,callback:function(e){t.$set(t.editment,\"transcationtime\",e)},expression:\"editment.transcationtime\"}})],1),t._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\",loading:t.edit_loading},on:{click:function(e){t.handleSubmit(\"editment\")}}},[t._v(\"修改\")]),t._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:function(e){t.edit_pay=!1}}},[t._v(\"取消\")])],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})],1)],1)},[],!1,null,null,null);w.options.__file=\"edit_payment.vue\";var I={data:function(){return{memo:\"\",openRebackModal:!1,backup_loading:!1,show:\"1\",py_loading:!1,payment:!1,balanceId:\"\",balanceRow:\"\",select_balance_row:\"\",formValidate:{companyName:\"\",customerName:\"\",totalamount:\"\",paynumber:\"\",unpaidamount:\"\",approvalpendingamount:\"\"},balanceItem:[],header:[{title:\"序号\",type:\"index\",align:\"center\",width:60},{title:\"补交金额\",key:\"transcationamount\"},{title:\"当前状态\",key:\"processtype\"},{title:\"驳回原因\",key:\"memo\"},{title:\"缴费渠道\",key:\"paydir\"},{title:\"缴费时间\",key:\"transcationtime\"},{title:\"财务确认时间\",key:\"confirmtime\"},{title:\"确认收款人\",key:\"userName\"},{title:\"创建人\",key:\"createrealname\"}]}},created:function(){this.init()},methods:{init:function(){var t=this;this.$bus.on(\"open_payment\",function(e){t.show=\"1\",t.balanceRow=e,t.balanceId=e.id,t.payment=!0,t.GetBalanceIdDate()}),this.$bus.on(\"update\",function(e){t.GetBalanceIdDate()})},GetBalanceIdDate:function(){var n=this,e=\"api/order/balance/detail?balanceId=\"+n.balanceId;this.$http.get(e).then(function(e){n.$backToLogin(e);var t=e.data.data;n.formValidate=t.balance[0],n.balanceItem=t.balanceItem,n.balanceItem=n.balanceItem.reverse();for(var a=0;a<n.balanceItem.length;a++)null!=n.balanceItem[a].transcationtime&&(n.balanceItem[a].transcationtime=n.balanceItem[a].transcationtime.slice(0,10)),null!=n.balanceItem[a].confirmtime&&(n.balanceItem[a].confirmtime=n.balanceItem[a].confirmtime.slice(0,10))})},save_balance_row:function(e){this.select_balance_row=e},close_payment:function(){this.payment=!1,this.$bus.emit(\"refresh\",!0)},edit_pay:function(){\"\"!=this.select_balance_row?this.$bus.emit(\"edit_pay\",this.select_balance_row):this.$Message.error(\"请选择一行进行修改\")},confirm:function(){var t=this;if(\"\"==this.select_balance_row)t.$Message.error(\"请选择一行进行确认\");else if(\"待审批\"==this.select_balance_row.processtype||\"驳回\"==this.select_balance_row.processtype){var e={itemId:t.select_balance_row.id};this.$http.post(\"api/order/balance/confirmReceipt\",e).then(function(e){4e4==e.data.msgCode?(t.$Message.success(\"审批成功\"),t.$bus.emit(\"refresh\",!0),t.GetBalanceIdDate()):t.$Message.error(\"审批失败，请重新审批\")}).catch(function(e){t.$Message.error(\"审批失败，请重新审批\")})}else t.$Message.error(\"此收款已审批，请选择另外一行\")},openreback:function(){\"\"==this.select_balance_row?this.$Message.error(\"请选择一行驳回！\"):this.openRebackModal=!0},reback:function(){var t=this;t.backup_loading=!0;var e={itemId:t.select_balance_row.id,processType:\"bh\",memo:t.memo};t.$Post(\"api/order/balance/updateProcesstypeByItemId\",e,function(e){t.backup_loading=!1,t.openRebackModal=!1,t.memo=\"\",t.GetBalanceIdDate()},function(e){t.backup_loading=!1})},add_pay:function(){this.$bus.emit(\"add_pay\",this.balanceId)}},components:{AddPayment:v,EditPayment:w.exports}},k=Object(r.a)(I,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Modal\",{attrs:{title:\"补交/审批\",width:950},model:{value:t.payment,callback:function(e){t.payment=e},expression:\"payment\"}},[a(\"Form\",{ref:\"formValidate\",attrs:{model:t.formValidate,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属公司:\",prop:\"companyName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.formValidate.companyName,callback:function(e){t.$set(t.formValidate,\"companyName\",e)},expression:\"formValidate.companyName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"归属客户:\",prop:\"customerName\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.formValidate.customerName,callback:function(e){t.$set(t.formValidate,\"customerName\",e)},expression:\"formValidate.customerName\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"余款总额:\",prop:\"totalamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.formValidate.totalamount,callback:function(e){t.$set(t.formValidate,\"totalamount\",e)},expression:\"formValidate.totalamount\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"已补金额:\",prop:\"paynumber\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.formValidate.paynumber,callback:function(e){t.$set(t.formValidate,\"paynumber\",e)},expression:\"formValidate.paynumber\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"未补金额:\",prop:\"unpaidamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.formValidate.unpaidamount,callback:function(e){t.$set(t.formValidate,\"unpaidamount\",e)},expression:\"formValidate.unpaidamount\"}})],1)],1),t._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{label:\"待审批金额:\",prop:\"approvalpendingamount\"}},[a(\"Input\",{attrs:{size:\"small\",disabled:\"\"},model:{value:t.formValidate.approvalpendingamount,callback:function(e){t.$set(t.formValidate,\"approvalpendingamount\",e)},expression:\"formValidate.approvalpendingamount\"}})],1)],1)],1),t._v(\" \"),a(\"Row\",[a(\"Collapse\",{model:{value:t.show,callback:function(e){t.show=e},expression:\"show\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[t._v(\"\\n                        补交明细\\n                        \"),a(\"div\",{attrs:{slot:\"content\"},slot:\"content\"},[a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.receipt\"],expression:\"['spareM.receipt']\"}],attrs:{type:\"primary\",icon:\"plus\"},on:{click:t.confirm}},[t._v(\"确认收款\")]),t._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\"},on:{click:t.add_pay}},[t._v(\"补交费用\")]),t._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\"},on:{click:t.edit_pay}},[t._v(\"修改\")]),t._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.edit\"],expression:\"['spareM.edit']\"}],attrs:{type:\"primary\",icon:\"edit\"},on:{click:t.openreback}},[t._v(\"驳回\")])],1)],1),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:t.header,data:t.balanceItem,\"highlight-row\":\"\",loading:t.py_loading,size:\"small\"},on:{\"on-current-change\":t.save_balance_row}})],1)],1)])],1)],1)],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"ghost\"},on:{click:t.close_payment}},[t._v(\"关闭\")])],1)],1),t._v(\" \"),a(\"Modal\",{attrs:{title:\"驳回\",width:400},model:{value:t.openRebackModal,callback:function(e){t.openRebackModal=e},expression:\"openRebackModal\"}},[a(\"Row\",[t._v(\"\\n            驳回原因：\\n        \")]),t._v(\" \"),a(\"Row\",[a(\"Input\",{attrs:{type:\"textarea\",placeholder:\"请输入驳回原因！（非必选项）\"},model:{value:t.memo,callback:function(e){t.memo=e},expression:\"memo\"}})],1),t._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\",icon:\"edit\",loading:t.backup_loading},on:{click:t.reback}},[t._v(\"驳回\")])],1)],1),t._v(\" \"),a(\"AddPayment\"),t._v(\" \"),a(\"EditPayment\")],1)},[],!1,null,null,null);k.options.__file=\"payment.vue\";var x={data:function(){var n=this;return{search_model:\"\",np_loading:!1,isshow:!1,searchgroups:{companyName:\"\",ordercode:\"\",createbyname:\"\",approval:\"\"},total_NUM:new Number,page:1,pageSize:10,local_data:[],select_row:\"\",header:[{title:\"订单编号\",key:\"ordercode\",minWidth:150},{title:\"产品名称\",key:\"product\",minWidth:150,render:function(e,t){return\"\"==t.row.product||null==t.row.product?\"\":8<t.row.product.length?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.product.slice(0,8)+\"...\"),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.product)])]):e(\"span\",t.row.product)}},{title:\"公司名称\",minWidth:200,render:function(e,t){return\"\"==t.row.companyName||null==t.row.companyName?\"\":10<t.row.companyName.length?e(\"Poptip\",{props:{trigger:\"hover\",placement:\"bottom\"}},[e(\"span\",t.row.companyName.slice(0,10)+\"...\"),e(\"Icon\",{props:{type:\"arrow-down-b\"}}),e(\"div\",{slot:\"content\"},[e(\"span\",t.row.companyName)])]):e(\"span\",t.row.companyName)}},{title:\"余款总额\",key:\"totalamount\",minWidth:120},{title:\"已补余款\",key:\"paynumber\",minWidth:100},{title:\"剩余余款\",key:\"unpaidamount\",minWidth:100},{title:\"待审批金额\",key:\"approvalpendingamount\",minWidth:100},{title:\"跟进人\",key:\"followbyname\",minWidth:100},{title:\"审批状态\",key:\"action\",width:100,render:function(e,t){var a=t.row.approvalpendingamount;if(t.index!=n.pageSize)return e(\"div\",{props:{color:0<a?\"black\":\"white\"}},0<a?\"待审批\":\"\")}}]}},methods:{downloadExcel:function(){var e={page:\"1\",pageSize:\"1000000\",isend:\"N\",companyName:this.searchgroups.companyName,ordercode:this.searchgroups.ordercode,createbyname:this.searchgroups.createbyname,approval:this.searchgroups.approval,export:\"Y\",exportField:encodeURI(JSON.stringify([{field:\"ordercode\",title:\"订单号码\"},{field:\"product\",title:\"产品名称\"},{field:\"companyname\",title:\"公司名称\"},{field:\"totalamount\",title:\"余款总额\"},{field:\"paynumber\",title:\"已补余款\"},{field:\"unpaidamount\",title:\"剩余余款\"},{field:\"approvalpendingamount\",title:\"待审批金额\"},{field:\"followbyname\",title:\"跟进人\"}]))},t=this.$MergeURL(\"api/order/balance/list\",e);window.open(t)},GetLocalData:function(){var o=this;o.np_loading=!0;var e={params:{isend:\"N\",page:o.page,pageSize:o.pageSize,companyName:o.searchgroups.companyName,ordercode:o.searchgroups.ordercode,createbyname:o.searchgroups.createbyname,approval:o.searchgroups.approval,sumField:\"unpaidamount,approvalpendingamount,totalamount\",sortField:\"updatedate\"}};for(var t in o.searchgroups)\"\"!=o.searchgroups[t]&&null!=o.searchgroups[t]||delete e.params[t];o.local_data=[],this.$http.get(\"api/order/balance/list\",e).then(function(e){o.$backToLogin(e),o.local_data=e.data.data.rows,o.total_NUM=e.data.data.total,o.np_loading=!1;var t=e.data.data.sum.unpaidamount,a=e.data.data.sum.approvalpendingamount,n=e.data.data.sum.totalamount;o.local_data.push({companyName:\"合计\",unpaidamount:t,approvalpendingamount:a,totalamount:n})})},PageChange:function(e){this.page=e,this.GetLocalData()},PageSizeChange:function(e){this.pageSize=e,this.GetLocalData()},rowClassName:function(e){if(\"合计\"!=e.companyName&&0!=e.approvalpendingamount&&this.select_row.id!=e.id)return\"demo-table-info-row\"},pay:function(){\"\"!=this.select_row?this.$bus.emit(\"open_payment\",this.select_row):this.$Message.warning(\"请选择一行\")},save_select_current:function(e){this.select_row=e},search:function(e){this.searchgroups.companyName=e.companyName,this.searchgroups.ordercode=e.ordercode,this.searchgroups.createbyname=e.createbyname,this.searchgroups.approval=e.approval,this.GetLocalData()},reset:function(){this.searchgroups.companyName=\"\",this.searchgroups.ordercode=\"\",this.searchgroups.createbyname=\"\",this.searchgroups.approval=\"\",this.page=1,this.GetLocalData()},exportToExecl:function(){\"\"!=_that.search_companyname&&\"\"!=_that.search_ordercode?(_that.pageSize,_that.search_companyname,_that.search_ordercode):\"\"==_that.search_companyname&&\"\"!=_that.search_ordercode?(_that.pageSize,_that.search_ordercode):\"\"!=_that.search_companyname&&\"\"==_that.search_ordercode?(_that.pageSize,_that.search_companyname):(_that.page,_that.pageSize),window.open(\"localhost%3a8089%2fapi%2forder%2fbalance%2flist%3fpage%3d1%26pageSize%3d9999%26isend%3dN%26sumField%3dunpaidamount%2capprovalpendingamount%26exportField%3d%5b%7b%22field%22%3a+%22companyName%22%2c%22title%22%3a+%22%e5%85%ac%e5%8f%b8%e5%90%8d%e7%a7%b0%22%7d%5d\")}},created:function(){var t=this;this.GetLocalData(),this.$bus.on(\"search\",function(e){t.search(e)}),this.$bus.on(\"reset\",function(e){t.reset()}),this.$bus.on(\"refresh\",function(e){t.GetLocalData()})},components:{Search:y,Payment:k.exports}},N=(a(758),Object(r.a)(x,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",[a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[a(\"Collapse\",{model:{value:t.search_model,callback:function(e){t.search_model=e},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),t._v(\"\\n                    筛选\\n                    \"),a(\"Search\",{attrs:{slot:\"content\"},slot:\"content\"})],1)],1)],1),t._v(\" \"),a(\"Row\",[a(\"div\",[a(\"ButtonGroup\",{staticStyle:{float:\"left\"}},[a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.approval\"],expression:\"['spareM.approval']\"}],attrs:{type:\"primary\",icon:\"ios-crop\"},on:{click:t.pay}},[t._v(\"补交/审批\")]),t._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.exportN\"],expression:\"['spareM.exportN']\"}],attrs:{type:\"primary\",icon:\"ios-color-filter-outline\"},on:{click:t.downloadExcel}},[t._v(\"导出Excel\")]),t._v(\" \"),a(\"Button\",{directives:[{name:\"permission\",rawName:\"v-permission\",value:[\"spareM.approval\"],expression:\"['spareM.approval']\"}],attrs:{type:\"primary\",icon:\"ios-color-filter-outline\"},on:{click:t.GetLocalData}},[t._v(\"刷新\")])],1)],1)]),t._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{attrs:{border:\"\",columns:t.header,data:t.local_data,\"highlight-row\":\"\",loading:t.np_loading,size:\"small\"},on:{\"on-current-change\":t.save_select_current}}),t._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{total:t.total_NUM,current:t.page,\"show-elevator\":\"\",\"show-sizer\":\"\",size:\"small\"},on:{\"update:current\":function(e){t.page=e},\"on-change\":t.PageChange,\"on-page-size-change\":t.PageSizeChange}})],1)],1),t._v(\" \"),a(\"Payment\",{attrs:{isshow:t.isshow}})],1)},[],!1,null,null,null));N.options.__file=\"no_pay_list.vue\";var $={data:function(){return{}},components:{Hpay:d,Npay:N.exports}},S=Object(r.a)($,function(){var e=this.$createElement,t=this._self._c||e;return t(\"div\",[t(\"Tabs\",{attrs:{value:\"name1\"}},[t(\"TabPane\",{attrs:{label:\"待补交\",name:\"name1\"}},[t(\"Npay\")],1),this._v(\" \"),t(\"TabPane\",{attrs:{label:\"已补交\",name:\"name2\"}},[t(\"Hpay\")],1)],1)],1)},[],!1,null,null,null);S.options.__file=\"spareManagement.vue\";t.default=S.exports}}]);"}