{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{457:function(a,e,t){\"use strict\";t.r(e);var r={data:function(){return{title:\"dealCycle\"==this.$route.query.type?\"客户成交周期详情\":\"二次成交比例详情\",header:[{title:\"姓名\",key:\"NAME\",minWidth:120},{title:\"归属公司\",key:\"companynames\",minWidth:210,render:function(a,e){if(\"\"==e.row.companynames||null==e.row.companynames)return\"\";var t=e.row.companynames.split(\",\");return t[0].length>13?a(\"Poptip\",{props:{trigger:\"hover\",title:\"归属公司\",placement:\"bottom\"}},[a(\"span\",t[0].slice(0,13)+\"...\"),a(\"Icon\",{props:{type:\"arrow-down-b\"}}),a(\"div\",{slot:\"content\"},[a(\"ul\",t.map(function(e){return[a(\"li\",{style:{padding:\"4px\"}},\"公司名：\"+e)]}))])]):a(\"Poptip\",{props:{trigger:\"hover\",title:\"归属公司\",placement:\"bottom\"}},[a(\"span\",t[0]),a(\"Icon\",{props:{type:\"arrow-down-b\"}}),a(\"div\",{slot:\"content\"},[a(\"ul\",t.map(function(e){return[a(\"li\",{style:{padding:\"4px\"}},\"公司名：\"+e)]}))])])}},{title:\"电话\",key:\"TEL\",minWidth:120},{title:\"客户状态\",key:\"customerType\",minWidth:140},{title:\"客户来源\",key:\"customersource\",minWidth:120},{title:\"客户等级\",key:\"importlevel\",minWidth:120},{title:\"区域\",key:\"AREA\",minWidth:80},{title:\"渠道名称\",key:\"channelTypeName\",minWidth:140},{title:\"跟进人\",key:\"followbyname\",minWidth:120},{title:\"创建时间\",key:\"CREATEDATE\",minWidth:120},{title:\"更新时间\",key:\"updatedate\",minWidth:120}],data:[],page:1,pageSize:10,total:0,tableLoading:!0,customerTypes:[],cluesources:[],customerrating:[],area:[],sf_yn:[],importance:[],cluesources_map:new Map,customerrating_map:new Map,area_map:new Map,sf_yn_map:new Map,importance_map:new Map,customerTypes_Casr:[],customerTypes_array:[]}},watch:{$route:function(a,e){this.get_data(a.query)}},methods:{get_data:function(a){this.tableLoading=!0,\"dealCycle\"==a.type?this.get_deal_cycle(a):this.get_second_deal(a)},get_deal_cycle:function(a){var e={params:{}};\"depart\"==a.idType?e.params.departId=a.id:e.params.userId=a.id,\"c1\"==a.dealType?e.params.c1=1:\"c2\"==a.dealType?e.params.c2=1:\"c3\"==a.dealType?e.params.c3=1:e.params.c4=1,this.get_all_data(\"api/crm/sale/index/customer/deal/cycle/list\",e)},get_second_deal:function(a){var e={params:{}};\"depart\"==a.idType?e.params.departId=a.id:e.params.userId=a.id,\"second\"==a.type&&(e.params.renew_order_count=1),this.get_all_data(\"api/crm/sale/index/customer/second/deal/list\",e)},get_all_data:function(a,e){var t={page:this.page,pageSize:this.pageSize,bcreatedate:\"\",ecreatedate:\"\"};Object.assign(e.params,t);var r=this;this.$Get(a,e,function(a){r.data=a.data.data.rows,r.total=a.data.data.total;for(var e=0;e<r.data.length;e++)r.data[e].customerType=r.findCustomerType(r.data[e].customerType),r.data[e].importlevel&&(r.data[e].importlevel=r.customerrating_map.get(r.data[e].importlevel.toString())),r.data[e].AREA=r.area_map.get(r.data[e].AREA),r.data[e].customersourceCode=r.data[e].customersource,r.data[e].customersource=r.cluesources_map.get(r.data[e].customersource),r.data[e].importance=r.importance_map.get(r.data[e].importance),r.data[e].isbound=r.sf_yn_map.get(r.data[e].isbound),r.data[e].CREATEDATE&&(r.data[e].CREATEDATE=r.data[e].CREATEDATE.slice(0,10)),r.data[e].updatedate&&(r.data[e].updatedate=r.data[e].updatedate.slice(0,10));r.tableLoading=!1})},findCustomerType:function(a){if(\"\"==a||null==a)return\"\";for(var e=a.split(\"-\"),t=0;t<this.customerTypes_array.length;t++)if(this.customerTypes_array[t].id==e[1]&&\"\"!=e[1])return this.customerTypes_array[t].ptypename+\" - \"+this.customerTypes_array[t].typename},page_change:function(a){this.page=a,this.get_data(this.$route.query)},page_size_change:function(a){this.pageSize=a,this.page=1,this.get_data(this.$route.query)},open_show:function(a){this.$store.commit(\"open_gobal_customer_detail_modal\",{ID:a.ID})},get_data_center:function(){var a=this;return new Promise(function(e,t){var r=a;a.$GetDataCenter(\"customerTypes,cluesources,customerrating,area,sf_yn,importance\",function(a){r.customerTypes=a.data.data.customerTypes,r.cluesources=a.data.data.cluesources,r.customerrating=a.data.data.customerrating,r.area=a.data.data.area,r.sf_yn=a.data.data.sf_yn,r.importance=a.data.data.importance,r.cluesources_map=r.$array2map(r.cluesources),r.customerrating_map=r.$array2map(r.customerrating),r.area_map=r.$array2map(r.area),r.sf_yn_map=r.$array2map(r.sf_yn),r.importance_map=r.$array2map(r.importance),r.customerTypes_Casr=r.$changeCars(r.customerTypes),r.customerTypes_array=r.$Data2Casr(r.customerTypes),e()})})}},created:function(){var a=this;this.get_data_center().then(function(){a.get_data(a.$route.query)})}},s=t(2),n=Object(s.a)(r,function(){var a=this,e=a.$createElement,t=a._self._c||e;return t(\"div\",[t(\"Card\",{attrs:{title:a.title}},[t(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[t(\"Table\",{attrs:{\"highlight-row\":\"\",size:\"small\",columns:a.header,data:a.data,loading:a.tableLoading},on:{\"on-row-dblclick\":a.open_show}}),a._v(\" \"),t(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:a.total,current:a.page,\"show-total\":\"\",\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function(e){a.page=e},\"on-change\":a.page_change,\"on-page-size-change\":a.page_size_change}})],1)],1)],1)},[],!1,null,null,null);n.options.__file=\"index.vue\";e.default=n.exports}}]);"}