{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{135:function(t,a,e){},136:function(t,a,e){},285:function(t,a,e){\"use strict\";var s=e(135);e.n(s).a},287:function(t,a,e){\"use strict\";var s=e(136);e.n(s).a},423:function(t,a,e){\"use strict\";e.r(a);var s=e(281),n=e(381),o=e(25),i=e(283),l=e.n(i),r=(e(284),{data:function(){return{newMission:{taskName:\"\",taskContent:\"\",planDate:new Date,specificDate:\"\",taskLevel:\"importance\",taskDesCode:\"\",taskKind:\"tkFollow\",taskStage:\"\",followResult:\"\",followUpType:\"\",companyId:\"\",executorId:[]},createLoading:!1,openAddMission:!1,companyLoading:!1,companyList:[],userList:[],allUserList:[],allUserList_map:new Map,taskLevel:[],taskDesCode:[],taskKind:[],taskStage:[],market_status:[],markert_follow_up_type:[],taskLevel_map:new Map,taskDesCode_map:new Map,taskKind_map:new Map,taskStage_map:new Map,market_status_map:new Map,markert_follow_up_type_map:new Map,userLoading:!1,user:\"\",useropen:!1}},methods:{create_task:function(){var t=this;t.createLoading=!0;for(var a=[],e=0;e<t.newMission.executorId.length;e++)a.push(t.allUserList_map.get(t.newMission.executorId[e].toString()));var s={taskName:t.newMission.taskName,companyId:t.newMission.companyId,executorId:t.newMission.executorId.join(\",\"),executorName:a.join(\",\"),taskContent:t.newMission.taskContent,taskLevel:t.newMission.taskLevel,planDate:Object(o.d)(t.newMission.planDate),taskKind:t.newMission.taskKind,taskStage:\"tesUnstarted\",taskLevelName:t.taskLevel_map.get(t.newMission.taskLevel),taskKindName:t.taskKind_map.get(t.newMission.taskKind),taskStageName:\"未开始\",creatorName:localStorage.getItem(\"realname\")};this.$Post(\"api/task/addTask\",s,function(a){t.createLoading=!1,t.openAddMission=!1,t.$bus.emit(\"UPDATE_TASK_LIST_DEMO\",!0),t.cancel_task()},function(a){t.createLoading=!1})},cancel_task:function(){this.$refs.newMission.resetFields()},get_company:function(t){var a=this;a.companyLoading=!0;var e={params:{page:1,pageSize:10,companyname:t}};this.$Get(\"api/customer/company/list\",e,function(t){a.companyLoading=!1,a.companyList=t.data.data.rows})},get_user:function(t){var a=this;a.userLoading=!0;var e={params:{page:1,pageSize:5,realname:t}};this.$Get(\"api/user/list\",e,function(t){a.userLoading=!1,a.userList=t.data.data.rows})},get_data_center:function(){var t=this;this.$GetDataCenter(\"taskLevel,taskDesCode,taskKind,taskStage,market_status,markert_follow_up_type\",function(a){t.taskLevel=a.data.data.taskLevel,t.taskDesCode=a.data.data.taskDesCode,t.taskKind=a.data.data.taskKind,t.taskStage=a.data.data.taskStage,t.market_status=a.data.data.market_status,t.markert_follow_up_type=a.data.data.markert_follow_up_type,t.taskLevel_map=t.$array2map(t.taskLevel),t.taskDesCode_map=t.$array2map(t.taskDesCode),t.taskKind_map=t.$array2map(t.taskKind),t.taskStage_map=t.$array2map(t.taskStage),t.market_status_map=t.$array2map(t.market_status),t.markert_follow_up_type_map=t.$array2map(t.markert_follow_up_type)})},get_all_user:function(){var t=this;this.$Get(\"api/user/list\",{params:{page:1,pageSize:1e3}},function(a){t.userList=a.data.data.rows,t.allUserList=a.data.data.rows;for(var e=0;e<t.allUserList.length;e++)t.allUserList_map.set(t.allUserList[e].id.toString(),t.allUserList[e].realname)})}},created:function(){var t=this;this.get_data_center(),this.get_all_user(),this.$bus.on(\"SCHEDULE_CREATE_TASK\",function(a){t.user=localStorage.getItem(\"id\"),t.newMission.executorId=[],t.newMission.executorId.push(parseInt(t.user)),t.openAddMission=!0,t.newMission.planDate=a})}}),p=e(2),d=Object(p.a)(r,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"Modal\",{attrs:{title:\"新增任务\",width:\"800\",\"mask-closable\":!1},model:{value:t.openAddMission,callback:function(a){t.openAddMission=a},expression:\"openAddMission\"}},[e(\"Form\",{ref:\"newMission\",staticStyle:{\"margin-left\":\"50px\",\"margin-right\":\"50px\"},attrs:{model:t.newMission,\"label-width\":80}},[e(\"FormItem\",{attrs:{label:\"任务名称\",prop:\"taskName\"}},[e(\"Input\",{model:{value:t.newMission.taskName,callback:function(a){t.$set(t.newMission,\"taskName\",a)},expression:\"newMission.taskName\"}})],1),t._v(\" \"),e(\"FormItem\",{attrs:{label:\"任务对象\",prop:\"companyId\"}},[e(\"Select\",{attrs:{placeholder:\"输入公司名称搜索\",filterable:\"\",remote:\"\",\"remote-method\":t.get_company,loading:t.companyLoading},model:{value:t.newMission.companyId,callback:function(a){t.$set(t.newMission,\"companyId\",a)},expression:\"newMission.companyId\"}},t._l(t.companyList,function(a){return e(\"Option\",{key:a.id,attrs:{value:a.id}},[t._v(t._s(a.companyname))])}),1)],1),t._v(\" \"),e(\"FormItem\",{attrs:{label:\"执行者\",prop:\"executorId\"}},[e(\"Select\",{attrs:{placeholder:\"执行者\",filterable:\"\",multiple:\"\",remote:\"\",\"remote-method\":t.get_user,loading:t.userLoading},model:{value:t.newMission.executorId,callback:function(a){t.$set(t.newMission,\"executorId\",a)},expression:\"newMission.executorId\"}},t._l(t.userList,function(a){return e(\"Option\",{key:a.id,attrs:{value:a.id,label:a.realname}},[e(\"span\",[t._v(t._s(a.realname))]),t._v(\" \"),e(\"span\",{staticStyle:{float:\"right\",color:\"#ccc\"}},[t._v(t._s(a.departname))])])}),1)],1),t._v(\" \"),e(\"FormItem\",{attrs:{label:\"任务详情\",prop:\"taskContent\"}},[e(\"Input\",{attrs:{type:\"textarea\",rows:3},model:{value:t.newMission.taskContent,callback:function(a){t.$set(t.newMission,\"taskContent\",a)},expression:\"newMission.taskContent\"}})],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:12}},[e(\"Col\",{attrs:{span:\"12\"}},[e(\"FormItem\",{attrs:{label:\"执行时间\",prop:\"planDate\"}},[e(\"DatePicker\",{staticStyle:{width:\"100%\"},attrs:{type:\"datetime\"},model:{value:t.newMission.planDate,callback:function(a){t.$set(t.newMission,\"planDate\",a)},expression:\"newMission.planDate\"}})],1)],1)],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:12}},[e(\"Col\",{attrs:{span:\"12\"}},[e(\"FormItem\",{attrs:{label:\"任务级别\",prop:\"taskLevel\"}},[e(\"Select\",{attrs:{type:\"text\",transfer:\"\"},model:{value:t.newMission.taskLevel,callback:function(a){t.$set(t.newMission,\"taskLevel\",a)},expression:\"newMission.taskLevel\"}},t._l(t.taskLevel,function(a,s){return e(\"Option\",{key:s,attrs:{value:a.typecode}},[t._v(t._s(a.typename))])}),1)],1)],1),t._v(\" \"),e(\"Col\",{attrs:{span:\"12\"}},[e(\"FormItem\",{attrs:{label:\"任务类型\",prop:\"taskKind\"}},[e(\"Select\",{model:{value:t.newMission.taskKind,callback:function(a){t.$set(t.newMission,\"taskKind\",a)},expression:\"newMission.taskKind\"}},t._l(t.taskKind,function(a,s){return e(\"Option\",{key:s,attrs:{value:a.typecode}},[t._v(t._s(a.typename))])}),1)],1)],1)],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:12}})],1),t._v(\" \"),e(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[e(\"Button\",{attrs:{type:\"primary\",loading:t.createLoading},on:{click:t.create_task}},[t._v(\"新增\")]),t._v(\" \"),e(\"Button\",{attrs:{type:\"ghost\"},on:{click:t.cancel_task}},[t._v(\"清空\")])],1)],1)},[],!1,null,null,null);d.options.__file=\"createTask.vue\";var c=d.exports,_={data:function(){return{openFollowUp:!1,addDetailContent:{content:\"\",followUpType:\"\"},companyInfo:{companyname:\"\",NAME:\"\"},followTypeText:[],followUp_loading:!1,addDetailContentRule:{followUpType:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],content:[{required:!0,message:\"必填项！\",trigger:\"change\",type:\"string\"}]}}},methods:{GetFollowUpType:function(){var t=this;t.followTypeText=[],this.$GetDataCenter(\"markert_follow_up_type\",function(a){for(var e=0;e<a.data.data.markert_follow_up_type.length;e++){var s={};21==a.data.data.markert_follow_up_type[e].typecode||22==a.data.data.markert_follow_up_type[e].typecode||(s.typecode=a.data.data.markert_follow_up_type[e].typecode,s.typename=a.data.data.markert_follow_up_type[e].typename,s.id=a.data.data.markert_follow_up_type[e].id,t.followTypeText.push(s))}})},cancel_workorder_followup:function(){this.$refs.addDetailContent.resetFields()},upload:function(){this.addDetailContent.content&&this.addDetailContent.followUpType?this.submit():this.$Message.fail(\"请补全信息！\")},submit:function(){var t=this;t.followUp_loading=!0;var a={content:t.addDetailContent.content,customerId:t.companyInfo.custId,companyId:t.companyInfo.company_id,followUpType:t.addDetailContent.followUpType};this.$Post(\"api/customer/addCustomerContentNote\",a,function(a){t.cancel_workorder_followup(),t.openFollowUp=!1,t.followUp_loading=!1,t.$bus.emit(\"FINISH_DEAL_WITH_SCHELCE\",!0)},function(a){t.followUp_loading=!1})}},created:function(){var t=this;this.GetFollowUpType(),t.$bus.off(\"OPEN_SCHEDULE_FOLLOWUP\",!0),t.$bus.on(\"OPEN_SCHEDULE_FOLLOWUP\",function(a){t.companyInfo=a,t.openFollowUp=!0})}},u=Object(p.a)(_,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"Modal\",{attrs:{title:\"新增跟进\",width:\"700\"},model:{value:t.openFollowUp,callback:function(a){t.openFollowUp=a},expression:\"openFollowUp\"}},[e(\"Form\",{ref:\"addDetailContent\",attrs:{model:t.addDetailContent,\"label-width\":120,rule:t.addDetailContentRule}},[e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{label:\"公司名称：\"}},[t._v(\"\\n                        \"+t._s(t.companyInfo.companyname)+\"\\n                    \")])],1)],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{label:\"归属客户：\"}},[t._v(\"\\n                        \"+t._s(t.companyInfo.NAME)+\"\\n                    \")])],1)],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"followUpType\",label:\"跟进类型：\"}},[e(\"Select\",{attrs:{transfer:\"\",size:\"small\"},model:{value:t.addDetailContent.followUpType,callback:function(a){t.$set(t.addDetailContent,\"followUpType\",a)},expression:\"addDetailContent.followUpType\"}},t._l(t.followTypeText,function(a){return e(\"Option\",{key:a.typecode,attrs:{value:a.typecode}},[t._v(t._s(a.typename))])}),1)],1)],1)],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:16}},[e(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[t._v(\"1\")]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"FormItem\",{staticStyle:{\"margin-bottom\":\"5px\"},attrs:{prop:\"content\",label:\"跟进内容：\"}},[e(\"Input\",{attrs:{type:\"textarea\"},model:{value:t.addDetailContent.content,callback:function(a){t.$set(t.addDetailContent,\"content\",a)},expression:\"addDetailContent.content\"}})],1)],1)],1)],1),t._v(\" \"),e(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[e(\"Button\",{attrs:{type:\"primary\",loading:t.followUp_loading},on:{click:t.upload}},[t._v(\"新增\")]),t._v(\" \"),e(\"Button\",{attrs:{type:\"ghost\"},on:{click:t.cancel_workorder_followup}},[t._v(\"重置\")])],1)],1)},[],!1,null,null,null);u.options.__file=\"createFollowUp.vue\";var m={components:{followUpList:u.exports},data:function(){return{id:\"\",discussLoading:!1,discuss:{rate:5,content:\"\"},loading:!1,openTaskDetail:!1,data:{taskData:[{task_name:\"\",id:\"\",expect_start_date:\"\",task_stage:\"\",plan_date:\"\",company_name:\"\",task_content:\"\",company_id:\"\"}],log:[],discuss:[]},taskStage:[],taskLevel:[],taskDesCode:[],task_memo:\"\",followUpContent:[{userName:\"\",createdate:\"\",followTypeName:\"\",serviceContent:\"\"}]}},computed:{openSubmit:function(){return!this.task_memo}},methods:{get_detail:function(t){var a=this,e={params:{taskId:t}};this.$Get(\"api/task/findTaskDetail\",e,function(t){a.data=t.data.data,t.data.data.taskData[0]?a.get_last_follow_up_content(t.data.data.taskData[0].company_id):a.data={taskData:[{task_name:\"\",id:\"\",expect_start_date:\"\",task_stage:\"\",plan_date:\"\",company_name:\"\",task_content:\"\",company_id:\"\"}],log:[],discuss:[]}})},delete_task:function(){var t=this,a={params:{taskId:t.data.taskData.id}};this.$Get(\"api/task/deleteTask\",a,function(a){t.openTaskDetail=!1})},get_data_center:function(){var t=this;this.$GetDataCenter(\"taskLevel,taskDesCode,taskKind,taskStage,market_status,markert_follow_up_type\",function(a){t.taskLevel=a.data.data.taskLevel,t.taskDesCode=a.data.data.taskDesCode,t.taskStage=a.data.data.taskStage})},before_update_task:function(){\"tkFollow\"==this.data.taskData[0].task_kind&&\"tesFinished\"==this.data.taskData[0].task_stage&&null!=this.data.taskData[0].companyname?this.$bus.emit(\"OPEN_SCHEDULE_FOLLOWUP\",{companyname:this.data.taskData[0].companyname,NAME:this.data.taskData[0].custName,company_id:this.data.taskData[0].company_id,custId:this.data.taskData[0].custId}):this.update_task()},update_task:function(){var t=this,a=new FormData;a.append(\"taskId\",t.id),a.append(\"taskStage\",t.data.taskData[0].task_stage),a.append(\"changeReason\",t.task_memo);t.data.taskData[0].id,t.data.taskData[0].task_stage;this.$Post(\"api/task/updateTaskStage\",a,function(a){t.update_content(),t.task_memo=\"\"},function(t){})},update_content:function(){var t=this,a={taskId:t.id,content:t.task_memo,creatorId:localStorage.getItem(\"id\"),creatorName:localStorage.getItem(\"realname\")};this.$Post(\"api/task/addTaskDiscuss\",a,function(a){t.loading=!1,t.get_detail(t.id)},function(a){t.loading=!1})},get_last_follow_up_content:function(t){var a=this,e={params:{companyId:t}};this.$Get(\"api/customer/findLastCustomerContentByCompanyId\",e,function(t){t.data.data&&(a.followUpContent=t.data.data)})},submit_discuss:function(){var t=this;t.discussLoading=!0;var a={taskId:t.id,content:t.discuss.content,evaluation:10*t.discuss.rate,creatorId:localStorage.getItem(\"id\"),creatorName:localStorage.getItem(\"realname\")};this.$Post(\"api/task/addTaskDiscuss\",a,function(a){t.discussLoading=!1,t.get_detail(t.id)},function(a){t.discussLoading=!1})}},created:function(){var t=this;this.$bus.off(\"OPEN_SEHEDULE_DETAIL\",!0),this.$bus.on(\"OPEN_SEHEDULE_DETAIL\",function(a){t.get_data_center(),t.id=a.id,t.get_detail(a.id),t.detail=a,t.openTaskDetail=!0}),this.$bus.off(\"FINISH_DEAL_WITH_SCHELCE\",!0),this.$bus.on(\"FINISH_DEAL_WITH_SCHELCE\",function(a){t.update_task()})}},k=(e(285),Object(p.a)(m,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"div\",[e(\"Modal\",{attrs:{title:\"任务详情\",width:\"450\",scrollable:!0,\"class-name\":\"vertical-center-modal\"},model:{value:t.openTaskDetail,callback:function(a){t.openTaskDetail=a},expression:\"openTaskDetail\"}},[e(\"div\",{staticStyle:{\"min-height\":\"90vh\",width:\"400px\"}},[e(\"Row\",[e(\"Col\",{attrs:{span:\"16\"}},[e(\"Input\",{staticStyle:{width:\"100%\"},attrs:{type:\"text\",readonly:\"\"},model:{value:t.data.taskData[0].task_name,callback:function(a){t.$set(t.data.taskData[0],\"task_name\",a)},expression:\"data.taskData[0].task_name\"}})],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"}},[e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"任务对象\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(t._s(t.data.taskData[0].companyname)+\"\\n                        \")])])],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"执行者\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(t._s(t.data.taskData[0].executor_name)+\"\\n                        \")])])],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"任务级别\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"Select\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",disabled:\"\"},model:{value:t.data.taskData[0].task_level,callback:function(a){t.$set(t.data.taskData[0],\"task_level\",a)},expression:\"data.taskData[0].task_level\"}},t._l(t.taskLevel,function(a){return e(\"Option\",{key:a.id,attrs:{value:a.typecode}},[t._v(t._s(a.typename))])}),1)],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"任务类型\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(t._s(t.data.taskData[0].task_kind_name))])])],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"开始时间\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"DatePicker\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"datetime\",readonly:\"\"},model:{value:t.data.taskData[0].expect_start_date,callback:function(a){t.$set(t.data.taskData[0],\"expect_start_date\",a)},expression:\"data.taskData[0].expect_start_date\"}})],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"提醒时间\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"DatePicker\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"datetime\",readonly:\"\"},model:{value:t.data.taskData[0].plan_date,callback:function(a){t.$set(t.data.taskData[0],\"plan_date\",a)},expression:\"data.taskData[0].plan_date\"}})],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"任务详情\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"Input\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"textarea\",row:5,readonly:\"\",autosize:\"\"},model:{value:t.data.taskData[0].task_content,callback:function(a){t.$set(t.data.taskData[0],\"task_content\",a)},expression:\"data.taskData[0].task_content\"}})],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"任务状态\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"Select\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\"},model:{value:t.data.taskData[0].task_stage,callback:function(a){t.$set(t.data.taskData[0],\"task_stage\",a)},expression:\"data.taskData[0].task_stage\"}},t._l(t.taskStage,function(a){return e(\"Option\",{key:a.id,attrs:{value:a.typecode}},[t._v(t._s(a.typename))])}),1)],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"4\"}},[e(\"span\",{staticStyle:{\"line-height\":\"24px\"}},[t._v(\"任务总结\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"20\"}},[e(\"Input\",{staticStyle:{width:\"180px\"},attrs:{size:\"small\",type:\"textarea\",row:5,placeholder:\"变更状态时，需要填写！（完成时填写总结，取消或终止时请输入原因！）\"},model:{value:t.task_memo,callback:function(a){t.task_memo=a},expression:\"task_memo\"}})],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"40px\"}},[e(\"Button\",{staticStyle:{\"margin-left\":\"40px\"},attrs:{type:\"primary\",disabled:t.openSubmit,loading:t.loading},on:{click:t.before_update_task}},[t._v(\"修改\")])],1)],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"20px\"}},[e(\"Tabs\",{attrs:{value:\"1\",size:\"small\"}},[e(\"TabPane\",{attrs:{label:\"日志\",name:\"1\"}},[e(\"Timeline\",t._l(t.data.log,function(a,s){return e(\"TimelineItem\",{key:s},[e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(a.log_content))]),t._v(\" \"),e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(a.log_date))])],1),t._v(\" \"),a.change_reason?e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",[t._v(\"备注：\"+t._s(a.change_reason))])],1):t._e()],1)}),1)],1),t._v(\" \"),e(\"TabPane\",{attrs:{label:\"讨论\",name:\"2\"}},[e(\"Row\",{staticStyle:{\"padding-bottom\":\"10px\",\"padding-top\":\"5px\"}},[e(\"Input\",{staticStyle:{width:\"90%\",\"padding-right\":\"20px\"},attrs:{size:\"small\",placeholder:\"请输入内容参与讨论！\"},model:{value:t.discuss.content,callback:function(a){t.$set(t.discuss,\"content\",a)},expression:\"discuss.content\"}},[e(\"Button\",{attrs:{slot:\"append\",loading:t.discussLoading,type:\"primary\",size:\"small\"},on:{click:t.submit_discuss},slot:\"append\"},[t._v(\"发送\")])],1),t._v(\" \"),e(\"Rate\",{attrs:{size:\"small\"},model:{value:t.discuss.rate,callback:function(a){t.$set(t.discuss,\"rate\",a)},expression:\"discuss.rate\"}})],1),t._v(\" \"),e(\"Timeline\",t._l(t.data.discuss,function(a,s){return e(\"TimelineItem\",{key:s},[e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(a.creator_name))]),t._v(\" \"),e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(a.creator_date))])],1),t._v(\" \"),e(\"Row\",{staticStyle:{\"margin-top\":\"5px\"},attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"24\"}},[t._v(t._s(a.content))]),t._v(\" \"),e(\"Col\",{attrs:{span:\"12\"}},[e(\"Rate\",{attrs:{disabled:\"\",value:a.evaluation/10,size:\"small\"}})],1)],1)],1)}),1)],1),t._v(\" \"),e(\"TabPane\",{attrs:{label:\"最近跟进\",name:\"3\"}},[e(\"div\",[e(\"Timeline\",[e(\"TimelineItem\",[e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(t.followUpContent.userName))]),t._v(\" \"),e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(t.followUpContent.createdate))])],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(t.followUpContent.followTypeName))]),t._v(\" \"),e(\"Col\",{attrs:{span:\"12\"}},[t._v(t._s(t.followUpContent.serviceContent))])],1)],1)],1)],1)])],1)],1)],1),t._v(\" \"),e(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"})]),t._v(\" \"),e(\"follow-up-list\")],1)},[],!1,null,null,null));k.options.__file=\"detailTask.vue\";var v=k.exports,g={name:\"schedule_index\",components:{FullCalendar:n.a,Datepicker:l.a,CreateTask:c,TaskDetail:v},data:function(){return{rightTop:\"\",rightLeft:\"\",right_click_show:!1,local_date:\"\",openRightHover:!1,top:\"\",left:\"\",click_show:!1,zh:s.a,date:new Date,config:{locale:\"zh-cn\"},events:[],events_temp:[],defaultView:\"month\",hover_local:\"\",oneData:[],rightClickDate:\"\"}},mounted:function(){},methods:{eventSelected:function(t,a,e){this.$bus.emit(\"OPEN_SEHEDULE_DETAIL\",t)},eventDrop:function(t){},eventResize:function(t){},eventCreated:function(t){},eventReceive:function(t){},eventrender:function(t){},dayClick:function(t,a,e){this.date=t._d;var s=Object(o.a)(t);this.get_onedate_data(s)},next:function(){this.$refs.calendar.fireMethod(\"getEventSources\")},change_date:function(t){var a=Object(o.a)(t);this.$refs.calendar.fireMethod(\"changeView\",this.$refs.calendar.fireMethod(\"getView\").type,a),this.get_onedate_data(a)},dayRightClick:function(t,a,e){this.right_click_show=!0,this.rightClickDate=t._d,this.rightTop=a.pageY,this.rightLeft=a.pageX},add_task:function(){this.$bus.emit(\"SCHEDULE_CREATE_TASK\",this.rightClickDate)},close_right_menu:function(){this.right_click_show=!1},mouse_out:function(){this.click_show=!1},mouse_over:function(t,a,e){this.click_show=!0,this.top=a.clientY,this.left=a.clientX,this.hover_local=t},get_date:function(){this.$refs.calendar.fireMethod(\"changeView\",\"agendaDay\",\"2017-06-01\")},get_data:function(){var t=this;this.$Get(\"api/task/list\",{params:{page:1,pageSize:1e3,day:\"\"}},function(a){t.events_temp=a.data.data.rows;for(var e=0;e<t.events_temp.length;e++)t.events_temp[e].start=t.events_temp[e].plan_date,t.events_temp[e].title=t.events_temp[e].task_name,\"tesExecuting\"==t.events_temp[e].task_stage&&(t.events_temp[e].color=\"blue\"),t.events_temp[e].plan_date.slice(0,10)==t.local_date&&(t.events_temp[e].color=\"orange\"),\"tesFinished\"==t.events_temp[e].task_stage&&(t.events_temp[e].color=\"#228B22\"),\"tdOverdue\"==t.events_temp[e].task_des_code&&(t.events_temp[e].color=\"red\"),\"tkClue\"==t.events_temp[e].task_kind&&\"tesFinished\"!=t.events_temp[e].task_stage&&(t.events_temp[e].color=\"#FF7F00\"),\"tkClue\"==t.events_temp[e].task_kind&&\"tesFinished\"==t.events_temp[e].task_stage&&(t.events_temp[e].color=\"#228B22\");t.events=t.events_temp},function(t){})},get_onedate_data:function(t){var a=this;this.local_date=t;var e={params:{page:1,pageSize:1e3,day:t,sortField:\"plan_date\"}};this.$Get(\"api/task/list\",e,function(t){a.oneData=t.data.data.rows},function(t){})}},created:function(){var t=this;t.get_data(),this.local_date=Object(o.a)(new Date),this.get_onedate_data(Object(o.a)(new Date)),t.$bus.on(\"UPDATE_TASK_LIST_DEMO\",function(a){t.get_data(),t.get_onedate_data(Object(o.a)(new Date))})}},f=(e(287),Object(p.a)(g,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"div\",{staticStyle:{\"min-width\":\"1300px\"},on:{click:t.close_right_menu}},[t.right_click_show?e(\"Button\",{staticStyle:{position:\"fixed\",\"z-index\":\"9000\"},style:{top:t.rightTop+\"px\",left:t.rightLeft+\"px\"},attrs:{type:\"primary\"},on:{click:t.add_task}},[t._v(\"新增日程\")]):t._e(),t._v(\" \"),e(\"Card\",{attrs:{title:\"日程表\"}},[t.click_show?e(\"Card\",{staticStyle:{width:\"400px\",position:\"fixed\",\"z-index\":\"9999\"},style:{top:t.top+\"px\",left:t.left+\"px\"}},[e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[t._v(\"任务对象：\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[t._v(t._s(t.hover_local.companyName))])])],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[t._v(\"任务详情：\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[t._v(t._s(t.hover_local.task_content))])])],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[t._v(\"执行人：\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[t._v(t._s(t.hover_local.executor_name))])])],1),t._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"6\"}},[e(\"span\",[t._v(\"创建人：\")])]),t._v(\" \"),e(\"Col\",{attrs:{span:\"18\"}},[e(\"span\",[t._v(t._s(t.hover_local.realname))])])],1)],1):t._e(),t._v(\" \"),e(\"Row\",{attrs:{gutter:20}},[e(\"Col\",{attrs:{span:\"18\"}},[e(\"full-calendar\",{ref:\"calendar\",attrs:{events:t.events,config:t.config,defaultView:t.defaultView,editable:!1},on:{\"event-selected\":t.eventSelected,\"day-click\":t.dayClick,\"day-right-click\":t.dayRightClick,\"event-mouseover\":t.mouse_over,\"event-mouseout\":t.mouse_out}})],1),t._v(\" \"),e(\"Col\",{attrs:{span:\"6\"}},[e(\"Row\",{staticStyle:{height:\"340px\"}},[e(\"datepicker\",{attrs:{inline:!0,language:t.zh},on:{selected:t.change_date},model:{value:t.date,callback:function(a){t.date=a},expression:\"date\"}})],1),t._v(\" \"),e(\"Row\",[e(\"span\",[t._v(\"执行中的任务--蓝色\"),e(\"br\")]),t._v(\" \"),e(\"span\",[t._v(\"当天需要完结的任务--黄色\"),e(\"br\")]),t._v(\" \"),e(\"span\",[t._v(\"完结任务--绿色\"),e(\"br\")]),t._v(\" \"),e(\"span\",[t._v(\"逾期任务--红色\"),e(\"br\")]),t._v(\" \"),e(\"span\",[t._v(\"线索未完成--橙色\"),e(\"br\")]),t._v(\" \"),e(\"span\",[t._v(\"线索完成--绿色\"),e(\"br\")])]),t._v(\" \"),e(\"Row\",[e(\"Row\",{staticStyle:{\"margin-bottom\":\"10px\"}},[e(\"h3\",[t._v(t._s(t.local_date))])]),t._v(\" \"),e(\"Row\",[e(\"Scroll\",{attrs:{height:\"520\"}},[e(\"Timeline\",t._l(t.oneData,function(a){return e(\"TimelineItem\",{key:a.id},[e(\"p\",{staticClass:\"time\"},[t._v(t._s(a.plan_date.slice(10)))]),t._v(\" \"),e(\"p\",{staticClass:\"content\"},[t._v(t._s(a.task_name))])])}),1)],1)],1)],1)],1)],1)],1),t._v(\" \"),e(\"create-task\"),t._v(\" \"),e(\"task-detail\")],1)},[],!1,null,null,null));f.options.__file=\"index.vue\";a.default=f.exports},95:function(t,a,e){t.exports=e(10)(22)}}]);"}