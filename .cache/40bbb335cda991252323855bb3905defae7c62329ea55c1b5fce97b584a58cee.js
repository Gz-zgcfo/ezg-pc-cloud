{"source":"(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{183:function(e,t,a){\"use strict\";a(9);var o={data:function(){return{upload_open:!1,upload:{fileMemo:\"\",resourceType:\"\",entityType:\"\",isvideo:\"N\"},sourceurl:\"\",filename:\"\",selectType:[],upload_rule:{fileMemo:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],resourceType:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}]},upload_loading:!1,file:[]}},computed:{isshow:function(){return\"N\"==this.upload.isvideo?1:0}},methods:{submit:function(){var e=this,t=this;this.$refs.upload.validate(function(a){a&&\"\"!=t.file?t.uploadok():e.$Message.error(\"请填写必选项！\")})},handleUpload:function(e){return this.file.push(e),!1},fileRemove:function(e){this.file.splice(this.file.indexOf(e),1)},cancel:function(){this.file=[],this.upload.fileMemo=\"\",this.upload.resourceType=\"\",this.upload.entityType=\"\",this.upload_open=!1,this.$refs.upload.resetFields()},uploadok:function(){var e=this;e.upload_loading=!0;var t=new FormData;t.append(\"resourceType\",e.upload.resourceType),t.append(\"fileMemo\",e.upload.fileMemo),t.append(\"entityType\",e.entityType),t.append(\"isvideo\",e.upload.isvideo),\"N\"==e.upload.isvideo?t.append(\"file\",e.file[0]):(t.append(\"sourceurl\",e.sourceurl),t.append(\"filename\",e.filename)),this.$http.post(\"api/zuul/system/resource/createSource\",t).then(function(t){\"40000\"==t.data.msgCode?(e.$Message.success(t.data.msg),e.cancel(),e.upload_loading=!1,e.$emit(\"update\",!0)):(e.$Message.error(t.data.msg),e.upload_loading=!1)}).catch(function(t){e.$Message.error(t),e.upload_loading=!1})}},created:function(){var e=this;e.$bus.off(\"upload_material_company\"),e.$bus.on(\"upload_material_company\",function(t){e.entityType=t[1],e.selectType=t[0],e.upload_open=!0})}},r=a(2),i=Object(r.a)(o,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"Modal\",{attrs:{title:\"上传资料\",width:\"600\",\"mask-closable\":!1},model:{value:e.upload_open,callback:function(t){e.upload_open=t},expression:\"upload_open\"}},[a(\"Form\",{ref:\"upload\",attrs:{model:e.upload,rules:e.upload_rule,\"label-width\":120}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{prop:\"resourceType\",label:\"资料类型：\"}},[a(\"Select\",{attrs:{transfer:\"\",placeholder:\"\",size:\"small\"},model:{value:e.upload.resourceType,callback:function(t){e.$set(e.upload,\"resourceType\",t)},expression:\"upload.resourceType\"}},e._l(e.selectType,function(t,o){return a(\"Option\",{key:o,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{prop:\"fileMemo\",label:\"资料说明：\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.upload.fileMemo,callback:function(t){e.$set(e.upload,\"fileMemo\",t)},expression:\"upload.fileMemo\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{prop:\"isvideo\",label:\"是否为视频资料：\"}},[a(\"RadioGroup\",{model:{value:e.upload.isvideo,callback:function(t){e.$set(e.upload,\"isvideo\",t)},expression:\"upload.isvideo\"}},[a(\"Radio\",{attrs:{label:\"N\"}},[e._v(\"否\")]),e._v(\" \"),a(\"Radio\",{attrs:{label:\"Y\"}},[e._v(\"是\")])],1)],1)],1)],1),e._v(\" \"),e.isshow?e._e():a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{label:\"资料名称：\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.filename,callback:function(t){e.filename=t},expression:\"filename\"}})],1)],1)],1),e._v(\" \"),e.isshow?e._e():a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{staticStyle:{visibility:\"hidden\"},attrs:{span:\"1\"}},[e._v(\"1\")]),e._v(\" \"),a(\"Col\",{attrs:{span:\"20\"}},[a(\"FormItem\",{attrs:{label:\"视频地址：\"}},[a(\"Input\",{attrs:{size:\"small\"},model:{value:e.sourceurl,callback:function(t){e.sourceurl=t},expression:\"sourceurl\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",[e.isshow?a(\"center\",[a(\"Upload\",{ref:\"upload\",attrs:{\"before-upload\":e.handleUpload,action:\"\"}},[a(\"Button\",{attrs:{type:\"ghost\",icon:\"ios-cloud-upload-outline\"}},[e._v(\"选择文件\")])],1),e._v(\" \"),e._l(e.file,function(t,o){return a(\"div\",{key:o},[e._v(e._s(t.name)+\"\\n                    \"),a(\"Button\",{attrs:{type:\"text\"},on:{click:function(a){e.fileRemove(t)}}},[e._v(\"移除\")])],1)})],2):e._e()],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\",loading:e.upload_loading},on:{click:e.uploadok}},[e._v(\"上传\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"8px\"},attrs:{type:\"ghost\"},on:{click:e.cancel}},[e._v(\"取消\")])],1)],1)},[],!1,null,null,null);i.options.__file=\"upload.vue\";t.a=i.exports},185:function(e,t,a){\"use strict\";var o=a(9),r={data:function(){return{selectType:[],row:{fileName:\"\",fileMemo:\"\",id:\"\",Type:\"\",sourceurl:\"\"},row_rule:{fileName:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],fileMemo:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}],Type:[{required:!0,message:\"必选项！\",trigger:\"change\",type:\"string\"}]},key:\"\",isEdit:!1}},methods:{submit_index:function(){var e=this,t=this;this.$refs.row.validate(function(a){a?t.submit():e.$Message.error(\"请填写必选项！\")})},submit:function(){var e=this,t={id:e.row.id.toString(),sourcetype:e.row.Type,filename:e.row.fileName,sourcememo:e.row.fileMemo,sourceurl:e.row.sourceurl,classify:e.key};this.$http.post(\"api/system/resource/updateSource\",t).then(function(t){\"40000\"==t.data.msgCode?(e.$Message.success(t.data.msg),e.isEdit=!1,e.$emit(\"update\",!0)):e.$Message.error(t.data.msg)})},close:function(){this.row.fileName=\"\",this.row.fileMemo=\"\",this.row.id=\"\",this.row.contractType=\"\",this.row.sourceurl=\"\",this.isEdit=!1}},created:function(){var e=this;o.a.$off(\"Open_material_house_edit\"),o.a.$on(\"Open_material_house_edit\",function(t){e.selectType=t[1],e.key=t[2],\"depart\"==t[2]&&(e.row.id=t[0].id,e.row.fileName=t[0].filename,e.row.fileMemo=t[0].sourcememo,e.row.Type=t[0].sourcetype,e.row.sourceurl=t[0].sourceurl),\"company\"==t[2]&&(e.row.id=t[0].id,e.row.fileName=t[0].filename,e.row.fileMemo=t[0].sourcememo,e.row.Type=t[0].sourcetype,e.row.sourceurl=t[0].sourceurl),e.isEdit=!0})}},i=a(2),s=Object(i.a)(r,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",[a(\"Modal\",{attrs:{title:\"编辑\",width:\"400\",\"mask-closable\":!1},model:{value:e.isEdit,callback:function(t){e.isEdit=t},expression:\"isEdit\"}},[a(\"Form\",{ref:\"row\",staticStyle:{margin:\"auto\"},attrs:{model:e.row,rules:e.row_rule,\"label-width\":140}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{attrs:{prop:\"Type\",label:\"文件类别：\"}},[a(\"Select\",{attrs:{transfer:\"\",placeholder:\"\",size:\"small\"},model:{value:e.row.Type,callback:function(t){e.$set(e.row,\"Type\",t)},expression:\"row.Type\"}},e._l(e.selectType,function(t,o){return a(\"Option\",{key:o,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{attrs:{prop:\"fileName\",label:\"文件名称：\"}},[a(\"Input\",{attrs:{type:\"text\",size:\"small\"},model:{value:e.row.fileName,callback:function(t){e.$set(e.row,\"fileName\",t)},expression:\"row.fileName\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{attrs:{prop:\"fileMemo\",label:\"文件说明：\"}},[a(\"Input\",{attrs:{type:\"text\",size:\"small\"},model:{value:e.row.fileMemo,callback:function(t){e.$set(e.row,\"fileMemo\",t)},expression:\"row.fileMemo\"}})],1)],1)],1),e._v(\" \"),a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"22\"}},[a(\"FormItem\",{attrs:{prop:\"sourceurl\",label:\"视频地址：\"}},[a(\"Input\",{attrs:{type:\"text\",size:\"small\"},model:{value:e.row.sourceurl,callback:function(t){e.$set(e.row,\"sourceurl\",t)},expression:\"row.sourceurl\"}})],1)],1)],1)],1),e._v(\" \"),a(\"div\",{attrs:{slot:\"footer\"},slot:\"footer\"},[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.submit_index}},[e._v(\"修改\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"ghost\"},on:{click:e.close}},[e._v(\"关闭\")])],1)],1)],1)},[],!1,null,null,null);s.options.__file=\"edit_file.vue\";t.a=s.exports},460:function(e,t,a){\"use strict\";a.r(t);var o=a(9),r=a(25),i=a(185),s=a(183),l={name:\"CompanyInformation_index\",components:{Edit:i.a,Upload:s.a},data:function(){var e=this;return{resourceType:[],resourceType_Map:new Map,company:{fileName:\"\",fileMemo:\"\",realname:\"\",resourceType:\"\",createdate:[]},local_rows:[],search_model:\"\",page:1,pageSize:10,pageTotal:new Number,loading:!1,header:[{type:\"index\",title:\"序号\",minWidth:60,align:\"center\"},{title:\"文件名称\",key:\"filename\",minWidth:280},{title:\"文件类型\",key:\"resourceTypeName\",minWidth:120},{title:\"文件说明\",key:\"sourcememo\",minWidth:120},{title:\"视频文件\",key:\"isvideo\",minWidth:120,render:function(e,t){return\"N\"==t.row.isvideo?e(\"div\",\"否\"):e(\"div\",\"是\")}},{title:\"创建人\",key:\"realname\",minWidth:120},{title:\"创建时间\",key:\"createdate\",minWidth:120},{title:\"操作\",key:\"action\",width:180,fixed:\"right\",align:\"center\",render:function(t,a){var o=a.row.filename.split(\".\");return e.$indexOfArray(o[o.length-1],[\"xlsx\",\"xls\",\"doc\",\"docx\",\"ppt\",\"pptx\",\"pdf\"])?t(\"div\",[t(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){var t=e.$router.resolve({name:\"previewFile\",params:{id:a.row.id}});window.open(t.href,\"_blank\")}}},\"预览\"),t(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){if(\"N\"==a.row.isvideo){var e=\"api/system/resource/download?id=\"+a.row.id;window.open(e)}else window.open(a.row.sourceurl)}}},\"下载\"),t(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\",display:\"管理员\"==localStorage.getItem(\"realname\")?\"inline\":\"none\"},on:{click:function(){e.delete_file(a.row)}}},\"删除\")]):t(\"div\",[t(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){e.$Message.error(\"该文件暂不支持预览！\")}}},\"预览\"),t(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\"},on:{click:function(){if(\"N\"==a.row.isvideo){var e=\"api/system/resource/download?id=\"+a.row.id;window.open(e)}else window.open(a.row.sourceurl)}}},\"下载\"),t(\"Button\",{props:{type:\"text\",size:\"small\"},style:{marginRight:\"5px\",display:\"管理员\"==localStorage.getItem(\"realname\")?\"inline\":\"none\"},on:{click:function(){e.delete_file(a.row)}}},\"删除\")])}}],data:[]}},methods:{search:function(){this.page=1,this.getData()},reset:function(){this.company.fileName=\"\",this.company.fileMemo=\"\",this.company.realname=\"\",this.company.resourceType=\"\",this.company.createdate=[],this.getData()},pageChange:function(e){this.page=e,this.getData()},upload:function(){this.$bus.emit(\"upload_material_company\",[this.resourceType,\"company\"])},edit:function(){\"\"!=this.local_rows?o.a.$emit(\"Open_material_house_edit\",[this.local_rows,this.resourceType,\"company\"]):this.$Message.warning(\"请选择一行进行编辑！\")},save_rows:function(e){this.local_rows=[],this.local_rows=e},getData:function(){this.local_rows=[];var e=this;e.loading=!0;var t={params:{page:e.page,pageSize:10,resourceType:e.company.resourceType,fileName:e.company.fileName,resourceMemo:e.company.fileMemo,realname:e.company.realname,bcreatedate:Object(r.a)(e.company.createdate[0]),ecreatedate:Object(r.a)(e.company.createdate[1]),sortField:\"createdate\",order:\"desc\",classify:\"company\"}};this.$Get(\"api/system/resource/showResourceInfo\",t,function(t){e.data=t.data.data.rows;for(var a=0;a<e.data.length;a++)\"\"==e.data[a].createdate||null==e.data[a].createdate?e.data[a].createdate=\"\":e.data[a].createdate=e.data[a].createdate.slice(0,10),e.data[a].sourcetype&&(e.data[a].resourceTypeName=e.resourceType_Map.get(e.data[a].sourcetype));e.pageTotal=t.data.data.total,e.loading=!1})},getDataCenter:function(){var e=this;return new Promise(function(t,a){e.$GetDataCenter(\"resourceType\",function(a){e.resourceType=a.data.data.resourceType,e.resourceType_Map=e.$array2map(e.resourceType),t()})})},delete_file:function(e){var t=this,a={id:e.id,deleteflag:\"1\"};this.$Post(\"api/system/resource/updateSource\",a,function(e){t.getData()},function(e){})}},created:function(){var e=this;this.getDataCenter().then(function(){e.getData()}).catch(function(e){})}},n=a(2),p=Object(n.a)(l,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"Card\",[a(\"Row\",{staticStyle:{\"margin-bottom\":\"20px\"}},[a(\"Collapse\",{model:{value:e.search_model,callback:function(t){e.search_model=t},expression:\"search_model\"}},[a(\"Panel\",{attrs:{name:\"1\"}},[a(\"Icon\",{staticStyle:{\"margin-left\":\"20px\",\"margin-right\":\"5px\"},attrs:{type:\"search\"}}),e._v(\"\\n                    筛选\\n                    \"),a(\"p\",{attrs:{slot:\"content\"},slot:\"content\"}),a(\"div\",{attrs:{slot:\"content\"},on:{keydown:function(t){return\"button\"in t||!e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?e.search(t):null}},slot:\"content\"},[a(\"Form\",{ref:\"company\",attrs:{model:e.company,\"label-width\":100}},[a(\"Row\",{attrs:{gutter:16}},[a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"fileName\",label:\"文件名称：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.company.fileName,callback:function(t){e.$set(e.company,\"fileName\",t)},expression:\"company.fileName\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"fileMemo\",label:\"文件说明：\"}},[a(\"Input\",{attrs:{type:\"text\",placeholder:\"\",size:\"small\"},model:{value:e.company.fileMemo,callback:function(t){e.$set(e.company,\"fileMemo\",t)},expression:\"company.fileMemo\"}})],1)],1),e._v(\" \"),a(\"Col\",{attrs:{span:\"8\"}},[a(\"FormItem\",{attrs:{prop:\"resourceType\",label:\"文件类型：\"}},[a(\"Select\",{attrs:{type:\"text\",transfer:\"\",placeholder:\"\",size:\"small\"},model:{value:e.company.resourceType,callback:function(t){e.$set(e.company,\"resourceType\",t)},expression:\"company.resourceType\"}},e._l(e.resourceType,function(t,o){return a(\"Option\",{key:o,attrs:{value:t.typecode}},[e._v(e._s(t.typename))])}),1)],1)],1)],1),e._v(\" \"),a(\"FormItem\",[a(\"Button\",{attrs:{type:\"primary\"},on:{click:e.search}},[e._v(\"搜索\")]),e._v(\" \"),a(\"Button\",{staticStyle:{\"margin-left\":\"20px\"},attrs:{type:\"ghost\"},on:{click:e.reset}},[e._v(\"重置\")])],1)],1)],1),e._v(\" \"),a(\"p\")],1)],1)],1),e._v(\" \"),a(\"Row\",[a(\"ButtonGroup\",[a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.upload}},[e._v(\"上传资料\")]),e._v(\" \"),a(\"Button\",{attrs:{type:\"primary\",icon:\"ios-color-wand-outline\"},on:{click:e.edit}},[e._v(\"编辑\")])],1)],1),e._v(\" \"),a(\"Row\",{staticStyle:{\"margin-top\":\"10px\"}},[a(\"Table\",{ref:\"selection\",attrs:{\"highlight-row\":\"\",size:\"small\",columns:e.header,loading:e.loading,data:e.data},on:{\"on-current-change\":e.save_rows}}),e._v(\" \"),a(\"Page\",{staticStyle:{\"margin-top\":\"10px\"},attrs:{size:\"small\",total:e.pageTotal,current:e.page,\"show-total\":\"\",\"show-elevator\":\"\",placement:\"top\"},on:{\"update:current\":function(t){e.page=t},\"on-change\":e.pageChange}})],1),e._v(\" \"),a(\"edit\",{on:{update:e.getData}}),e._v(\" \"),a(\"upload\",{on:{update:e.getData}})],1)},[],!1,null,null,null);p.options.__file=\"index.vue\";t.default=p.exports}}]);"}